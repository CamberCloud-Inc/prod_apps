{
  "name": "abotyper-blood-antigens",
  "title": "Nanopore Genotyping",
  "description": "Characterize the Human Blood Group and Red Cell Antigens using Oxford Nanopore third-generation sequencing data. Validated pipeline for ABO blood type determination from targeted sequencing of ABO exons 6 and 7. Samplesheet format: `sample,fastq_1,fastq_2`",
  "version": "1.0.0",
  "engineType": "NEXTFLOW",
  "command": "nextflow run nf-core/abotyper --input ${input} --outdir ${outdir} --genome ${genome} -c /etc/mpi/nextflow.camber.config -profile k8s -r ${revision}",
  "imageUrl": "https://raw.githubusercontent.com/nf-core/abotyper/master/docs/images/nf-core-abotyper_logo_light.png",
  "content": "<h1 class=\"heading-node\">Blood Group Typer: Nanopore-Based ABO Genotyping</h1><p class=\"text-node\"><strong>Clinical-Grade Blood Group Determination Using Third-Generation Sequencing</strong></p><p class=\"text-node\">The nf-core/abotyper pipeline characterizes Human Blood Group and Red Cell Antigens using Oxford Nanopore third-generation sequencing data. This validated pipeline analyzes ABO gene polymorphisms to deduce ABO blood type with high accuracy.</p><img src=\"https://raw.githubusercontent.com/nf-core/abotyper/master/docs/images/nf-core-abotyper_logo_light.png\" alt=\"nf-core/abotyper\" width=\"400\" height=\"200\"><h2 class=\"heading-node\">Clinical Applications</h2><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Transfusion Medicine:</strong> Accurate donor-recipient blood type matching</p></li><li><p class=\"text-node\"><strong>Pre-surgical Screening:</strong> Comprehensive blood group profiling</p></li><li><p class=\"text-node\"><strong>Neonatal Care:</strong> Blood type determination for newborns</p></li><li><p class=\"text-node\"><strong>Transplantation:</strong> Blood group compatibility assessment</p></li><li><p class=\"text-node\"><strong>Forensic Medicine:</strong> Blood group identification for forensic cases</p></li></ul><h2 class=\"heading-node\">Key Features</h2><h3 class=\"heading-node\">Validated Nanopore Platform</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Extensive Validation:</strong> Tested using Oxford Nanopore MinION data targeting ABO exons 6 and 7</p></li><li><p class=\"text-node\"><strong>Clinical Relevance:</strong> Focuses on ABO exons 6 and 7, which contain the clinically significant polymorphisms for blood group determination</p></li><li><p class=\"text-node\"><strong>Platform Compatibility:</strong> Optimized for Nanopore, but supports any platform with reads spanning ABO exons 6 and 7</p></li></ul><h3 class=\"heading-node\">Comprehensive Analysis Pipeline</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Quality Control:</strong> FastQC-based QC of raw sequencing reads</p></li><li><p class=\"text-node\"><strong>Precise Mapping:</strong> High-accuracy alignment to ABO reference sequences</p></li><li><p class=\"text-node\"><strong>Variant Characterization:</strong> Identification of ABO-related Single Nucleotide Variants (SNVs)</p></li><li><p class=\"text-node\"><strong>Phenotype Deduction:</strong> Statistical determination of ABO blood type from polymorphisms</p></li><li><p class=\"text-node\"><strong>Exon-Specific Analysis:</strong> Separate analysis pipelines for exon 6 and exon 7</p></li></ul><h2 class=\"heading-node\">Input Requirements</h2><h3 class=\"heading-node\">Samplesheet Format</h3><p class=\"text-node\">The pipeline requires a comma-separated samplesheet with the following structure:</p><pre class=\"block-node\"><code>sample,fastq_1,fastq_2\npatient_001,patient_001_R1.fastq.gz,patient_001_R2.fastq.gz\npatient_002,patient_002_R1.fastq.gz,patient_002_R2.fastq.gz\ncontrol_sample,control_R1.fastq.gz,control_R2.fastq.gz</code></pre><p class=\"text-node\"><strong>Column Details:</strong></p><ul class=\"list-node\"><li><p class=\"text-node\"><code class=\"inline\" spellcheck=\"false\">sample</code>: Unique sample identifier (patient ID, specimen number)</p></li><li><p class=\"text-node\"><code class=\"inline\" spellcheck=\"false\">fastq_1</code>: Path to read 1 FASTQ file (or single-end reads)</p></li><li><p class=\"text-node\"><code class=\"inline\" spellcheck=\"false\">fastq_2</code>: Path to read 2 FASTQ file (leave empty for single-end data)</p></li></ul><h3 class=\"heading-node\">Sequencing Requirements</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Target Region:</strong> ABO exons 6 and 7 (contains clinically relevant polymorphisms)</p></li><li><p class=\"text-node\"><strong>Recommended Platform:</strong> Oxford Nanopore MinION or similar</p></li><li><p class=\"text-node\"><strong>Alternative Platforms:</strong> Any sequencer producing reads spanning ABO exons 6 and 7</p></li><li><p class=\"text-node\"><strong>Data Format:</strong> FASTQ format (compressed .gz or uncompressed)</p></li><li><p class=\"text-node\"><strong>Read Length:</strong> Sufficient coverage of target exons</p></li></ul><h2 class=\"heading-node\">Reference Genome Selection</h2><p class=\"text-node\">Choose the appropriate human reference genome:</p><ul class=\"list-node\"><li><p class=\"text-node\"><strong>GRCh38 (hg38):</strong> Current human reference genome (recommended)</p></li><li><p class=\"text-node\"><strong>GRCh37 (hg19):</strong> Previous reference genome version</p></li></ul><h2 class=\"heading-node\">Comprehensive Output Files</h2><h3 class=\"heading-node\">Primary Results</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>ABO_result.txt:</strong> Final ABO blood type determination for each sample</p></li><li><p class=\"text-node\"><strong>ABO_result.xlsx:</strong> Excel format results with detailed statistics</p></li><li><p class=\"text-node\"><strong>ABO_results.log:</strong> Complete processing log with quality metrics</p></li><li><p class=\"text-node\"><strong>final_export.csv:</strong> Machine-readable summary of all results</p></li></ul><h3 class=\"heading-node\">Per-Sample Analysis (Exon-Specific)</h3><p class=\"text-node\">For each sample, the pipeline generates separate directories for exon 6 and exon 7:</p><ul class=\"list-node\"><li><p class=\"text-node\"><strong>ABOReadPolymorphisms.txt:</strong> Detected polymorphisms in reads</p></li><li><p class=\"text-node\"><strong>ABOPhenotype.txt:</strong> Deduced blood group phenotype</p></li><li><p class=\"text-node\"><strong>Alignment files (.bam, .bam.bai):</strong> Read alignments to ABO reference</p></li><li><p class=\"text-node\"><strong>Coverage statistics:</strong> Sequencing depth and quality metrics</p></li><li><p class=\"text-node\"><strong>Mpileup files:</strong> Variant calling intermediate files</p></li></ul><h3 class=\"heading-node\">Quality Control Reports</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>MultiQC Report:</strong> Comprehensive quality assessment</p></li><li><p class=\"text-node\"><strong>FastQC Reports:</strong> Raw read quality metrics</p></li><li><p class=\"text-node\"><strong>Mapping Statistics:</strong> Alignment quality and coverage</p></li></ul><h2 class=\"heading-node\">Clinical Validation</h2><p class=\"text-node\"><strong>Published Research:</strong> This pipeline is based on validated methodology published in:</p><blockquote class=\"block-node\"><p class=\"text-node\">Mobegi FM, Bruce S, et al. (2025) <em>Characterisation of the ABO Blood Group Phenotypes Using Third-Generation Sequencing.</em> Int. J. Mol. Sci. 26(12):5443. doi: 10.3390/ijms26125443</p></blockquote><h2 class=\"heading-node\">Technical Implementation</h2><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Pipeline Framework:</strong> Built with Nextflow for reproducible execution</p></li><li><p class=\"text-node\"><strong>Container Support:</strong> Fully containerized with Docker/Singularity</p></li><li><p class=\"text-node\"><strong>Resource Management:</strong> Optimized resource allocation for clinical workflows</p></li><li><p class=\"text-node\"><strong>Quality Assurance:</strong> Continuous integration testing via nf-core standards</p></li></ul><h2 class=\"heading-node\">Use Cases</h2><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Hospital Blood Banks:</strong> Rapid blood type screening</p></li><li><p class=\"text-node\"><strong>Research Laboratories:</strong> Population genetics studies of ABO polymorphisms</p></li><li><p class=\"text-node\"><strong>Clinical Diagnostics:</strong> Pre-transfusion testing workflows</p></li><li><p class=\"text-node\"><strong>Transplant Centers:</strong> Donor-recipient matching</p></li><li><p class=\"text-node\"><strong>Forensic Labs:</strong> Blood group identification in forensic samples</p></li></ul><p class=\"text-node\"><strong>Perfect for:</strong> Transfusion medicine, Clinical genetics, Forensic analysis, Transplantation medicine, Neonatal screening, Population genetics</p><p class=\"text-node\">Built with <a class=\"link\" href=\"https://www.nextflow.io/\" target=\"_blank\">Nextflow</a> \u2022 Powered by <a class=\"link\" href=\"https://nf-co.re/abotyper/\" target=\"_blank\">nf-core/abotyper</a> \u2022 Containerized execution \u2022 Clinically validated</p>",
  "spec": [
    {
      "type": "Stash File",
      "label": "Sample Sheet",
      "name": "input",
      "description": "CSV samplesheet with columns: sample, fastq_1, fastq_2. Contains paths to FASTQ files for each sample.",
      "defaultValue": "",
      "hidden": false,
      "required": true,
      "disabled": false,
      "restrictions": {
        "allow_files": true,
        "allow_folders": false,
        "allowed_file_types": [
          ".csv",
          ".tsv"
        ]
      }
    },
    {
      "type": "Stash File",
      "label": "Output Directory",
      "name": "outdir",
      "description": "Output directory for analysis results including blood type calls, QC reports, and per-sample analysis.",
      "defaultValue": "./abotyper-results",
      "hidden": false,
      "required": true,
      "disabled": false,
      "restrictions": {
        "allow_files": false,
        "allow_folders": true,
        "allowed_file_types": []
      }
    },
    {
      "type": "Select",
      "label": "Reference Genome",
      "name": "genome",
      "description": "Human reference genome for ABO gene alignment and variant calling.",
      "defaultValue": "GRCh38",
      "hidden": false,
      "required": true,
      "disabled": false,
      "options": [
        {
          "label": "GRCh38 (hg38) - Current human reference (recommended)",
          "value": "GRCh38"
        },
        {
          "label": "GRCh37 (hg19) - Previous human reference",
          "value": "GRCh37"
        }
      ]
    },
    {
      "type": "Input",
      "label": "Pipeline Version",
      "name": "revision",
      "description": "nf-core/abotyper pipeline version to use.",
      "defaultValue": "1.0.0",
      "hidden": false,
      "required": true,
      "disabled": false,
      "placeholder": "1.0.0"
    }
  ],
  "jobConfig": [
    {
      "type": "Select",
      "label": "System Size",
      "name": "system_size",
      "hidden": false,
      "description": "Select computational resources based on dataset size and number of samples.",
      "options": [
        {
          "label": "Medium (32 CPUs, 180GB RAM) - Small cohorts (1-10 samples)",
          "value": "medium",
          "mapValue": {
            "nodeSize": "MEDIUM",
            "numNodes": 1,
            "withGpu": false
          }
        },
        {
          "label": "Large (64 CPUs, 360GB RAM) - Standard cohorts (10-50 samples) [Recommended]",
          "value": "large",
          "mapValue": {
            "nodeSize": "LARGE",
            "numNodes": 1,
            "withGpu": false
          }
        },
        {
          "label": "XLarge (96 CPUs, 540GB RAM) - Large cohorts (50+ samples)",
          "value": "xlarge",
          "mapValue": {
            "nodeSize": "XLARGE",
            "numNodes": 1,
            "withGpu": false
          }
        }
      ],
      "defaultValue": "large"
    }
  ],
  "tags": [
    {
      "name": "genomics",
      "type": "subfield"
    },
    {
      "name": "clinical",
      "type": "subfield"
    },
    {
      "name": "blood-typing",
      "type": "task"
    },
    {
      "name": "nanopore",
      "type": "platform"
    },
    {
      "name": "diagnostics",
      "type": "task"
    }
  ]
}