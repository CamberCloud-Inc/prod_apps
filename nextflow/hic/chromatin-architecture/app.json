{
  "name": "hic-chromatin-architecture",
  "title": "Hi-C 3D Genome Architecture Analysis",
  "description": "Map 3D chromatin organization genome-wide using Hi-C. Identifies chromatin loops, TADs, compartments, and long-range DNA interactions to understand genome architecture. Samplesheet format: `sample,replicate,fastq_1,fastq_2`",
  "version": "1.0.0",
  "engineType": "NEXTFLOW",
  "command": "nextflow run nf-core/hic --input ${input} --outdir ${outdir} --genome ${genome} -r 2.1.0 ",
  "imageUrl": "https://raw.githubusercontent.com/nf-core/hic/master/docs/images/nf-core-hic_logo_light.png",
  "content": "<h2><strong>Hi-C 3D Genome Architecture</strong></h2><p><strong>Hi-C</strong> reveals the 3D organization of the genome by capturing all DNA-DNA contacts genome-wide. Understanding chromosome folding is critical for gene regulation, as enhancers loop to distant promoters through 3D space.</p><h3><strong>What is Hi-C?</strong></h3><blockquote><p><strong>The Technique</strong>:</p><ol><li><strong>Crosslink</strong>: Formaldehyde fixes DNA-protein-DNA interactions</li><li><strong>Digest</strong>: Restriction enzyme cuts chromatin</li><li><strong>Biotin Label</strong>: Add biotin to DNA ends</li><li><strong>Proximity Ligation</strong>: Ligate DNA ends that are physically close</li><li><strong>Pull-down</strong>: Capture biotin-labeled chimeric junctions</li><li><strong>Sequence</strong>: Paired-end sequencing (R1 and R2 from different loci)</li><li><strong>Map</strong>: Align reads to find contacting regions</li></ol></blockquote><h3><strong>3D Genome Features Detected</strong></h3><p><strong>Compartments (A/B)</strong>:</p><ul><li><strong>A compartments</strong>: Active chromatin (gene-rich, open)</li><li><strong>B compartments</strong>: Inactive chromatin (gene-poor, closed)</li><li><strong>Scale</strong>: Mb-scale domains</li><li><strong>Segregation</strong>: A/B compartments avoid each other in 3D space</li></ul><p><strong>TADs (Topologically Associating Domains)</strong>:</p><ul><li><strong>Definition</strong>: Genomic regions with high internal interaction frequency</li><li><strong>Size</strong>: 100kb-1Mb</li><li><strong>Boundaries</strong>: Often marked by CTCF and cohesin</li><li><strong>Function</strong>: Regulatory domains - enhancers preferentially contact promoters within same TAD</li></ul><p><strong>Chromatin Loops</strong>:</p><ul><li><strong>Enhancer-Promoter Loops</strong>: Long-range gene regulation</li><li><strong>CTCF-CTCF Loops</strong>: Structural loops at TAD boundaries</li><li><strong>Polycomb Loops</strong>: Repressive interactions</li><li><strong>Scale</strong>: 10kb-10Mb</li></ul><p><strong>Chromosome Territories</strong>:</p><ul><li><strong>Each chromosome</strong>: Occupies distinct nuclear space</li><li><strong>Trans contacts</strong>: Between chromosomes (rare)</li><li><strong>Cis contacts</strong>: Within chromosome (common)</li></ul><h3><strong>Why Study 3D Genome Organization?</strong></h3><ul><li><strong>Gene Regulation</strong>: Enhancers loop to promoters across 100kb-1Mb</li><li><strong>Disease Mechanisms</strong>: Structural variants disrupt TADs \u2192 aberrant enhancer-gene contacts</li><li><strong>Development</strong>: Dynamic chromatin reorganization during differentiation</li><li><strong>Evolution</strong>: Conserved vs divergent 3D structures</li><li><strong>Cancer</strong>: Oncogene hijacking via TAD disruption</li><li><strong>Therapeutic Targets</strong>: Modulate 3D contacts to alter gene expression</li></ul><h3><strong>Resolution Levels</strong></h3><table><tr><th>Feature</th><th>Resolution Needed</th><th>Sequencing Depth</th></tr><tr><td><strong>Compartments</strong></td><td>100kb-1Mb</td><td>10-50M reads</td></tr><tr><td><strong>TADs</strong></td><td>40-100kb</td><td>100-500M reads</td></tr><tr><td><strong>Loops</strong></td><td>5-10kb</td><td>1-5B reads</td></tr><tr><td><strong>Base-pair</strong></td><td>1kb</td><td>10-50B reads</td></tr></table><h3><strong>Pipeline Analysis</strong></h3><ol><li><strong>Quality Control</strong>: FastQC, check valid pairs</li><li><strong>Hi-C Alignment</strong>: HiC-Pro maps paired reads to genome</li><li><strong>Valid Pair Filtering</strong>: Remove dangling ends, self-circles, PCR duplicates</li><li><strong>Contact Matrix</strong>: Binned genome-wide interaction map</li><li><strong>Normalization</strong>: ICE/KR balancing to remove biases</li><li><strong>Compartment Calling</strong>: PCA on correlation matrix (A/B)</li><li><strong>TAD Calling</strong>: Identify domain boundaries</li><li><strong>Loop Calling</strong>: Detect significant focal interactions</li><li><strong>Visualization</strong>: Heatmaps, contact matrices, virtual 4C</li></ol><h3><strong>QC Metrics</strong></h3><ul><li><strong>Valid Pairs %</strong>: Should be >40% (% of read pairs representing genuine contacts)</li><li><strong>Cis/Trans Ratio</strong>: ~10:1 (within vs between chromosome contacts)</li><li><strong>Long-Range Contacts</strong>: Interactions >20kb apart (TADs, loops)</li><li><strong>Duplication Rate</strong>: <20% (PCR duplicates)</li></ul><h3><strong>Scientific Questions</strong></h3><ul><li><strong>Enhancer-Promoter Wiring</strong>: Which enhancers contact which genes?</li><li><strong>TAD Disruption</strong>: Do structural variants break TAD boundaries?</li><li><strong>Compartment Switching</strong>: Does chromatin move from A\u2192B during differentiation?</li><li><strong>Loop Dynamics</strong>: How do CTCF/cohesin loops change with stimulus?</li><li><strong>3D vs 1D</strong>: Can we predict gene expression from 3D contacts?</li><li><strong>Disease Mechanisms</strong>: Oncogene activation via enhancer hijacking</li></ul><h3><strong>Applications</strong></h3><p><strong>Cancer</strong>:</p><ul><li><strong>Enhancer Hijacking</strong>: TAD disruption brings oncogene near super-enhancer</li><li><strong>Example</strong>: T-ALL - TAD boundary deletion \u2192 TAL1 oncogene contacts MYB enhancer</li><li><strong>Fusion Genes</strong>: Chromosomal translocations create new 3D contacts</li></ul><p><strong>Development</strong>:</p><ul><li><strong>Lineage Specification</strong>: Dynamic TAD formation during differentiation</li><li><strong>Hox Clusters</strong>: 3D reorganization controls developmental timing</li></ul><p><strong>Disease Modeling</strong>:</p><ul><li><strong>Limb Malformations</strong>: Structural variants near developmental genes (SOX9, SHH)</li><li><strong>Brain Disorders</strong>: TAD disruption at neurodevelopmental loci</li></ul><p><strong>Evolutionary Biology</strong>:</p><ul><li><strong>Conserved TADs</strong>: Core regulatory domains across species</li><li><strong>Species Differences</strong>: 3D rewiring drives phenotypic divergence</li></ul><h3><strong>Key Discoveries from Hi-C</strong></h3><blockquote><p><strong>TADs are Regulatory Domains</strong>:</p><ul><li>Enhancers preferentially activate genes within same TAD</li><li>CTCF/cohesin define TAD boundaries (insulators)</li><li>TAD disruption \u2192 inappropriate enhancer-gene contacts</li></ul><p><strong>Oncogene Activation via Enhancer Hijacking</strong>:</p><ul><li>Deletions/inversions bring oncogenes near active enhancers</li><li>Example: IGH enhancer \u2192 MYC in Burkitt lymphoma</li></ul><p><strong>Polycomb Bodies</strong>:</p><ul><li>Multiple Polycomb-repressed loci cluster in 3D</li><li>H3K27me3-marked regions coalesce into repressive hubs</li></ul></blockquote><h3><strong>Example: FOXG1 Locus Rearrangement</strong></h3><blockquote><p><strong>Normal</strong>: FOXG1 gene in TAD-A (inactive)</p><p><strong>Mutation</strong>: Deletion removes TAD boundary</p><p><strong>Result</strong>: FOXG1 now contacts TAD-B enhancers \u2192 overexpression \u2192 neurodevelopmental disorder</p><p><strong>Mechanism</strong>: TAD boundary loss allows inappropriate enhancer-promoter contact</p></blockquote><h3><strong>Input Requirements</strong></h3><p>CSV samplesheet with columns:</p><ul><li><strong>sample</strong>: Sample name</li><li><strong>fastq_1</strong>: Path to R1 FASTQ</li><li><strong>fastq_2</strong>: Path to R2 FASTQ</li><li><strong>replicate</strong>: Biological replicate</li></ul><h3><strong>Key Outputs</strong></h3><ul><li><strong>Contact Matrices</strong>: Genome-wide interaction heatmaps (.hic, .cool formats)</li><li><strong>A/B Compartments</strong>: Active vs inactive chromatin domains</li><li><strong>TAD Calls</strong>: Topologically associating domains (BED)</li><li><strong>Chromatin Loops</strong>: Significant focal interactions (BEDPE)</li><li><strong>Normalized Matrices</strong>: ICE/KR balanced contact maps</li><li><strong>QC Report</strong>: Valid pairs, cis/trans ratio, coverage</li><li><strong>Virtual 4C</strong>: Interaction profile from specific locus</li><li><strong>Browser Tracks</strong>: Visualize contacts in IGV/UCSC</li></ul><blockquote><p><strong>Perfect for:</strong> 3D genome \u2022 Enhancer-promoter loops \u2022 TAD boundaries \u2022 Gene regulation \u2022 Cancer genomics \u2022 Development</p></blockquote>",
  "spec": [
    {
      "type": "Stash File",
      "label": "Sample Sheet",
      "name": "input",
      "description": "CSV with Hi-C samples",
      "required": true,
      "restrictions": {
        "allow_files": true,
        "allow_folders": false,
        "allowed_file_types": [
          ".csv"
        ]
      }
    },
    {
      "type": "Select",
      "label": "Reference Genome",
      "name": "genome",
      "description": "Reference genome",
      "defaultValue": "GRCh38",
      "required": true,
      "options": [
        {
          "label": "Human GRCh38",
          "value": "GRCh38"
        },
        {
          "label": "Mouse GRCm39",
          "value": "GRCm39"
        },
        {
          "label": "Human GRCh37",
          "value": "GRCh37"
        },
        {
          "label": "Mouse GRCm38",
          "value": "GRCm38"
        }
      ]
    },
    {
      "type": "Stash File",
      "label": "Output Directory",
      "name": "outdir",
      "description": "Output directory",
      "defaultValue": "./hic-results",
      "required": true,
      "restrictions": {
        "allow_files": false,
        "allow_folders": true
      }
    }
  ],
  "jobConfig": [
    {
      "type": "Select",
      "label": "Compute Resources",
      "name": "system_size",
      "hidden": false,
      "options": [
        {
          "label": "XLARGE (Recommended for Hi-C)",
          "value": "xlarge",
          "mapValue": {
            "nodeSize": "XLARGE",
            "numNodes": 1,
            "withGpu": false
          }
        }
      ],
      "defaultValue": "xlarge"
    }
  ],
  "tags": [
    {
      "name": "hi-c",
      "type": "field"
    },
    {
      "name": "3d-genome",
      "type": "task"
    },
    {
      "name": "chromatin-architecture",
      "type": "task"
    }
  ]
}