{
  "name": "phaseimpute-genotype-imputation",
  "title": "Genotype Imputation and Haplotype Phasing",
  "description": "Performs haplotype phasing and genotype imputation from low-pass sequencing or genotyping array data using reference panels. Ideal for cost-effective genome-wide association studies and population genomics by reconstructing missing genetic variants. Samplesheet format: `chunk,vcf,index`",
  "version": "1.0.0",
  "engineType": "NEXTFLOW",
  "command": "nextflow run nf-core/phaseimpute --input ${input} --outdir ${outdir} -r 1.0.0 ",
  "imageUrl": "https://raw.githubusercontent.com/nf-core/phaseimpute/master/docs/images/nf-core-phaseimpute_logo_light.png",
  "content": "<h2><strong>PhaseImpute - Haplotype Phasing and Genotype Imputation</strong></h2><p>Comprehensive pipeline for phasing haplotypes and imputing missing genotypes from low-pass sequencing data or genotyping arrays using population reference panels. Enables cost-effective genome-wide studies by statistically inferring unobserved genetic variants from observed markers.</p><h3><strong>What is Genotype Imputation?</strong></h3><blockquote><p><strong>Genotype imputation</strong> is a statistical method that predicts unobserved genetic variants by leveraging linkage disequilibrium patterns from densely genotyped reference populations. <strong>Haplotype phasing</strong> determines which alleles are located on the same chromosome copy, essential for understanding genetic inheritance and compound effects.</p></blockquote><h3><strong>Key Features</strong></h3><ul><li><strong>Multiple Imputation Tools</strong>: Supports GLIMPSE1, GLIMPSE2, STITCH, and QUILT algorithms</li><li><strong>Modular Workflow</strong>: Five independent steps (QC, simulation, panel prep, imputation, validation)</li><li><strong>Low-pass Sequencing</strong>: Optimized for cost-effective 0.1x - 4x genome coverage</li><li><strong>Reference Panel Support</strong>: Works with 1000 Genomes, TOPMed, HRC, UK Biobank panels</li><li><strong>Flexible Input</strong>: Accepts BAM/CRAM files, VCF, or genotyping array data</li><li><strong>Quality Control</strong>: Built-in validation and accuracy assessment</li></ul><h3><strong>Pipeline Workflow</strong></h3><ol><li><strong>QC and Preprocessing</strong>: Verify chromosome naming, validate input formats, check data quality</li><li><strong>Simulation (Optional)</strong>: Generate low-pass datasets from high-coverage data for benchmarking</li><li><strong>Reference Panel Preparation</strong>: Normalize, phase, and chunk reference panels for efficient imputation</li><li><strong>Haplotype Phasing</strong>: Determine parental haplotypes using read-based and population-based methods</li><li><strong>Genotype Imputation</strong>: Fill in missing variants using reference panel linkage patterns</li><li><strong>Post-imputation QC</strong>: Filter low-confidence variants, calculate imputation quality scores</li><li><strong>Validation</strong>: Compare imputed genotypes to truth sets, calculate concordance metrics</li></ol><h3><strong>Scientific Applications</strong></h3><ul><li><strong>Genome-wide Association Studies (GWAS)</strong>: Increase variant density for association testing</li><li><strong>Population Genomics</strong>: Analyze genetic diversity with cost-effective low-pass sequencing</li><li><strong>Fine-mapping</strong>: Improve causal variant localization in association peaks</li><li><strong>Rare Variant Analysis</strong>: Impute rare variants using large reference panels</li><li><strong>Polygenic Risk Scores</strong>: Calculate comprehensive genetic risk using imputed variants</li><li><strong>Evolutionary Studies</strong>: Analyze ancient DNA with low coverage sequencing</li><li><strong>Pharmacogenomics</strong>: Impute variants in drug metabolism genes</li></ul><h3><strong>Imputation Tools Comparison</strong></h3><ul><li><strong>GLIMPSE1/GLIMPSE2</strong>: Gold standard for low-pass sequencing (0.1x - 4x), extremely accurate</li><li><strong>STITCH</strong>: Reference-free imputation, ideal when no reference panel available</li><li><strong>QUILT</strong>: High-accuracy method combining sequencing reads with reference haplotypes</li></ul><h3><strong>Advantages of Low-pass + Imputation</strong></h3><ul><li><strong>Cost-Effective</strong>: 10-20x cheaper than high-coverage WGS</li><li><strong>High Accuracy</strong>: >95% concordance for common variants (MAF > 5%)</li><li><strong>Genome-wide Coverage</strong>: Impute millions of variants from sparse data</li><li><strong>Scalability</strong>: Enables large population studies (10,000+ samples)</li><li><strong>Better than Arrays</strong>: More uniform coverage and structural variant detection</li></ul><h3><strong>Input Requirements</strong></h3><ul><li><strong>Sequencing Data</strong>: BAM/CRAM files with 0.1x - 4x genome coverage</li><li><strong>Sample Sheet</strong>: CSV mapping samples to BAM/CRAM files and indices</li><li><strong>Reference Panel</strong>: VCF files with phased haplotypes (1000G, TOPMed, HRC)</li><li><strong>Reference Genome</strong>: FASTA file matching sample alignment</li><li><strong>Genetic Map</strong>: Recombination rates for phasing and imputation</li></ul><h3><strong>Main Outputs</strong></h3><ul><li><strong>Imputed VCF</strong>: Phased and imputed genotypes with quality scores</li><li><strong>Imputation Info Scores</strong>: Per-variant imputation quality metrics (R\u00b2 > 0.8 recommended)</li><li><strong>Phased Haplotypes</strong>: Maternal and paternal chromosome assignments</li><li><strong>Validation Metrics</strong>: Concordance rates, genotype correlation, allelic R\u00b2</li><li><strong>QC Reports</strong>: MultiQC summary with imputation statistics</li><li><strong>Filtered Variants</strong>: High-quality subset passing INFO score thresholds</li></ul><blockquote><p><strong>Perfect for:</strong> GWAS Studies \u2022 Population Genomics \u2022 Cost-effective Sequencing \u2022 Rare Variant Discovery \u2022 Polygenic Risk Scores \u2022 Fine-mapping \u2022 Large Cohort Studies \u2022 Ancient DNA Analysis</p></blockquote>",
  "spec": [
    {
      "type": "Stash File",
      "label": "Input",
      "name": "input",
      "required": true,
      "restrictions": {
        "allow_files": true,
        "allowed_file_types": [
          ".csv",
          ".tsv"
        ]
      }
    },
    {
      "type": "Stash File",
      "label": "Output",
      "name": "outdir",
      "defaultValue": "./phaseimpute-results",
      "required": true,
      "restrictions": {
        "allow_files": false,
        "allow_folders": true
      }
    }
  ],
  "jobConfig": [
    {
      "type": "Select",
      "label": "Resources",
      "name": "system_size",
      "options": [
        {
          "label": "LARGE",
          "value": "large",
          "mapValue": {
            "nodeSize": "LARGE",
            "numNodes": 1,
            "withGpu": false
          }
        }
      ],
      "defaultValue": "large"
    }
  ],
  "tags": [
    {
      "id": "fb1ee42a-629a-4d99-9e7f-1da3c5f7a691",
      "name": "biology",
      "type": "field"
    },
    {
      "id": "6e4e74a4-560e-4674-95c3-60fe895b8c91",
      "name": "genomics",
      "type": "subfield"
    },
    {
      "id": "831477f4-f572-4e27-af83-037661489800",
      "name": "analysis",
      "type": "task"
    }
  ]
}