{
  "name": "nanoseq-rna-sequencing",
  "title": "Nanoseq: Long-Read RNA Sequencing (Isoform Analysis)",
  "description": "Full-length transcript sequencing with Nanopore/PacBio. Discovers novel isoforms, fusion transcripts, and poly(A) tail lengths. Ideal for transcriptome annotation and RNA modifications. Samplesheet format: `sample,fastq,barcode`",
  "version": "1.0.0",
  "engineType": "NEXTFLOW",
  "command": "nextflow run nf-core/nanoseq --input ${input} --outdir ${outdir} --protocol ${protocol} -r 3.1.0 ",
  "imageUrl": "https://raw.githubusercontent.com/nf-core/nanoseq/master/docs/images/nf-core-nanoseq_logo_light.png",
  "content": "<h2><strong>Nanoseq: Long-Read RNA Sequencing</strong></h2><p><strong>Long-read RNA sequencing</strong> captures full-length transcripts (5' cap to poly(A) tail) in single reads, enabling comprehensive isoform discovery, fusion detection, and RNA modification analysis without assembly artifacts.</p><h3><strong>Why Long-Read RNA-seq?</strong></h3><ul><li><strong>Full-Length Transcripts</strong>: No assembly needed - see entire isoform in one read</li><li><strong>Isoform Discovery</strong>: Novel splice variants, alternative TSS/poly(A) sites</li><li><strong>Fusion Transcripts</strong>: Direct detection of gene fusions (cancer diagnostics)</li><li><strong>Poly(A) Tail Length</strong>: Regulatory information (Nanopore directRNA)</li><li><strong>RNA Modifications</strong>: Native m6A, pseudouridine detection (Nanopore)</li><li><strong>Allele-Specific Expression</strong>: Phase variants across entire transcript</li></ul><h3><strong>Short vs Long-Read RNA-seq</strong></h3><blockquote><p><strong>Short-read RNA-seq</strong> (Illumina 150bp):</p><ul><li>\u2705 High throughput, low cost</li><li>\u2705 Accurate quantification</li><li>\u274c Requires computational isoform reconstruction</li><li>\u274c Cannot resolve complex splicing</li><li>\u274c Ambiguous read assignment to isoforms</li></ul><p><strong>Long-read RNA-seq</strong> (10-30kb):</p><ul><li>\u2705 Full-length transcripts - no assembly</li><li>\u2705 Unambiguous isoform identification</li><li>\u2705 Novel isoform discovery</li><li>\u2705 Direct fusion detection</li><li>\u274c Lower throughput</li><li>\u274c Higher per-sample cost</li></ul></blockquote><h3><strong>Sequencing Protocols</strong></h3><p><strong>cDNA Sequencing</strong>:</p><ul><li>Reverse transcription + PCR amplification</li><li>Higher throughput (more molecules)</li><li>Works with both Nanopore and PacBio</li><li>Loses strand information (unless stranded protocols)</li><li>Loses RNA modifications</li><li>Recommended for: Isoform discovery, fusion detection</li></ul><p><strong>Direct RNA Sequencing</strong> (Nanopore only):</p><ul><li>Native RNA through pores (no reverse transcription)</li><li>Preserves RNA modifications (m6A, pseudouridine)</li><li>Maintains strand information</li><li>Poly(A) tail length measurement</li><li>Lower throughput than cDNA</li><li>Recommended for: RNA modifications, poly(A) analysis</li></ul><h3><strong>Pipeline Workflow</strong></h3><ol><li><strong>Basecalling</strong>: Convert raw signal to FASTQ (Guppy for Nanopore)</li><li><strong>Quality Control</strong>: NanoPlot for read length/quality assessment</li><li><strong>Adapter Trimming</strong>: Remove sequencing adapters</li><li><strong>Alignment</strong>: minimap2 splice-aware alignment to reference</li><li><strong>Transcript Quantification</strong>: Count reads per gene/transcript</li><li><strong>Isoform Identification</strong>: Classify known vs novel isoforms</li><li><strong>QC Report</strong>: MultiQC comprehensive summary</li></ol><h3><strong>Scientific Applications</strong></h3><p><strong>Isoform Discovery</strong>:</p><ul><li>Alternative splicing patterns</li><li>Novel exons, introns</li><li>Alternative transcription start sites (TSS)</li><li>Alternative polyadenylation (APA) sites</li><li>Tissue-specific isoforms</li></ul><p><strong>Fusion Transcript Detection</strong>:</p><ul><li><strong>Cancer diagnostics</strong>: BCR-ABL (CML), EML4-ALK (NSCLC), TMPRSS2-ERG (prostate)</li><li><strong>Immunotherapy targets</strong>: Neo-antigens from fusions</li><li><strong>Drug resistance mechanisms</strong>: Kinase domain fusions</li><li>Single-read fusion evidence (no computational inference)</li></ul><p><strong>RNA Modifications (Direct RNA only)</strong>:</p><ul><li><strong>m6A methylation</strong>: Most abundant mRNA modification (gene regulation)</li><li><strong>Pseudouridine</strong>: rRNA, tRNA, mRNA stability</li><li><strong>5-methylcytosine</strong>: RNA stability, localization</li><li><strong>Inosine</strong>: A-to-I editing</li></ul><p><strong>Allele-Specific Expression</strong>:</p><ul><li>Phase SNVs across full transcript</li><li>Determine parental origin of expression</li><li>Imprinting studies</li><li>Cis-regulatory variant effects</li></ul><h3><strong>Alternative Splicing Detection</strong></h3><p>Long reads directly identify:</p><ul><li><strong>Exon skipping</strong>: Most common AS event (~40%)</li><li><strong>Alternative 5'/3' splice sites</strong>: Minor shifts in splice boundaries</li><li><strong>Intron retention</strong>: Common in cancer, stress response</li><li><strong>Mutually exclusive exons</strong>: Binary choices (e.g., neurexin)</li><li><strong>Complex events</strong>: Multiple simultaneous changes</li></ul><h3><strong>Poly(A) Tail Analysis</strong></h3><blockquote><p><strong>Poly(A) tail length</strong> regulates:</p><ul><li><strong>mRNA stability</strong>: Longer tails = more stable</li><li><strong>Translation efficiency</strong>: Tail length affects ribosome recruitment</li><li><strong>mRNA localization</strong>: Differential localization by tail length</li><li><strong>Developmental timing</strong>: Tail lengthening/shortening during oocyte maturation</li></ul><p>Direct RNA sequencing captures tail length from raw signal (30-250 nt typical)</p></blockquote><h3><strong>Typical Isoform Complexity</strong></h3><table><tr><th>Gene</th><th>Known Isoforms</th><th>Exons</th><th>Example</th></tr><tr><td><strong>TP53</strong></td><td>12+</td><td>11</td><td>Tumor suppressor</td></tr><tr><td><strong>DSCAM</strong></td><td>38,016</td><td>24</td><td>Neural development (Drosophila)</td></tr><tr><td><strong>Titin</strong></td><td>100+</td><td>363</td><td>Muscle protein (longest human gene)</td></tr><tr><td><strong>BRCA1</strong></td><td>8+</td><td>24</td><td>DNA repair</td></tr></table><h3><strong>Sequencing Depth</strong></h3><table><tr><th>Goal</th><th>Reads per Sample</th><th>Coverage</th></tr><tr><td><strong>Isoform Discovery</strong></td><td>5-10M reads</td><td>~20-40X transcript coverage</td></tr><tr><td><strong>Quantification</strong></td><td>10-20M reads</td><td>Similar to short-read</td></tr><tr><td><strong>Rare Isoforms</strong></td><td>20-50M reads</td><td>Deep profiling</td></tr><tr><td><strong>Single-Cell Iso-Seq</strong></td><td>50-200K reads/cell</td><td>Lower per-cell depth</td></tr></table><h3><strong>Read Length Statistics</strong></h3><ul><li><strong>Human transcript length</strong>: Median ~2.5 kb, mean ~3.5 kb</li><li><strong>Nanopore cDNA</strong>: Typical 0.5-10 kb (full-length)</li><li><strong>PacBio Iso-Seq</strong>: 1-10 kb (HiFi CCS)</li><li><strong>Long genes</strong>: TTN (100 kb), DMD (79 kb) - may need ultra-long</li></ul><h3><strong>Quality Metrics</strong></h3><ul><li><strong>Full-Length Reads</strong>: % containing 5' cap + poly(A) tail (cDNA protocols)</li><li><strong>Mapping Rate</strong>: >75% for transcriptome alignment</li><li><strong>Isoform Coverage</strong>: Uniform coverage across transcript body</li><li><strong>Splice Site Accuracy</strong>: % canonical GT-AG splice sites (>95%)</li></ul><h3><strong>Fusion Transcript Examples</strong></h3><table><tr><th>Fusion</th><th>Cancer Type</th><th>Frequency</th><th>Therapy</th></tr><tr><td><strong>BCR-ABL1</strong></td><td>CML, ALL</td><td>~95% CML</td><td>Imatinib (Gleevec)</td></tr><tr><td><strong>EML4-ALK</strong></td><td>NSCLC</td><td>3-7%</td><td>Crizotinib, alectinib</td></tr><tr><td><strong>TMPRSS2-ERG</strong></td><td>Prostate</td><td>~50%</td><td>Prognostic marker</td></tr><tr><td><strong>PML-RARA</strong></td><td>APL</td><td>~95%</td><td>ATRA (all-trans retinoic acid)</td></tr></table><h3><strong>RNA Modification Functions</strong></h3><p><strong>m6A methylation</strong>:</p><ul><li>Most abundant mRNA modification (~0.5% of A's)</li><li>Regulates splicing, translation, decay</li><li>Altered in cancer, obesity, neurodegeneration</li><li>Readers: YTHDF1/2/3 proteins</li></ul><p><strong>Pseudouridine (\u03a8)</strong>:</p><ul><li>Most abundant RNA modification overall</li><li>Stabilizes RNA structure</li><li>mRNA: affects translation, immune recognition</li><li>Enriched in mRNA therapeutics (COVID vaccines)</li></ul><h3><strong>Experimental Design</strong></h3><p><strong>Discovery Mode</strong> (novel isoforms):</p><ul><li>Diverse tissues/conditions</li><li>Deep sequencing (20M+ reads)</li><li>Include developmental stages</li></ul><p><strong>Validation Mode</strong> (quantify known isoforms):</p><ul><li>Targeted conditions</li><li>Moderate depth (5-10M reads)</li><li>Complement short-read data</li></ul><p><strong>Modification Profiling</strong>:</p><ul><li>Use direct RNA protocol (Nanopore)</li><li>Compare wild-type vs modification enzyme KO</li><li>Higher coverage for rare modifications</li></ul><h3><strong>Input Requirements</strong></h3><p>CSV samplesheet with columns:</p><ul><li><strong>sample</strong>: Sample ID</li><li><strong>fastq</strong>: Path to FASTQ file(s)</li><li><strong>barcode</strong>: Barcode number (if multiplexed)</li></ul><h3><strong>Key Outputs</strong></h3><ul><li><strong>Aligned BAM</strong>: Splice-aware transcript alignments</li><li><strong>Gene/Transcript Counts</strong>: Quantification matrices</li><li><strong>Isoform Calls</strong>: GFF/GTF of detected isoforms</li><li><strong>Novel Isoforms</strong>: Previously unannotated transcripts</li><li><strong>Fusion Transcripts</strong>: Detected gene fusions</li><li><strong>Poly(A) Lengths</strong>: Tail length distributions (directRNA)</li><li><strong>QC Reports</strong>: NanoPlot, MultiQC summaries</li></ul><blockquote><p><strong>Perfect for:</strong> Isoform discovery \u2022 Fusion detection \u2022 RNA modifications \u2022 Alternative splicing \u2022 Transcriptome annotation \u2022 Full-length transcripts</p></blockquote>",
  "spec": [
    {
      "type": "Stash File",
      "label": "Sample Sheet",
      "name": "input",
      "description": "CSV with RNA sample information",
      "required": true,
      "restrictions": {
        "allow_files": true,
        "allow_folders": false,
        "allowed_file_types": [
          ".csv"
        ]
      }
    },
    {
      "type": "Select",
      "label": "RNA Sequencing Protocol",
      "name": "protocol",
      "description": "RNA sequencing protocol",
      "defaultValue": "cDNA",
      "required": true,
      "options": [
        {
          "label": "cDNA (Higher throughput, isoform discovery)",
          "value": "cDNA"
        },
        {
          "label": "directRNA (Native RNA, modifications, poly(A) tails)",
          "value": "directRNA"
        }
      ]
    },
    {
      "type": "Stash File",
      "label": "Output Directory",
      "name": "outdir",
      "description": "Output directory",
      "defaultValue": "./nanoseq-rna-results",
      "required": true,
      "restrictions": {
        "allow_files": false,
        "allow_folders": true
      }
    }
  ],
  "jobConfig": [
    {
      "type": "Select",
      "label": "Compute Resources",
      "name": "system_size",
      "hidden": false,
      "options": [
        {
          "label": "LARGE (Recommended)",
          "value": "large",
          "mapValue": {
            "nodeSize": "LARGE",
            "numNodes": 1,
            "withGpu": false
          }
        },
        {
          "label": "MEDIUM (For smaller datasets)",
          "value": "medium",
          "mapValue": {
            "nodeSize": "MEDIUM",
            "numNodes": 1,
            "withGpu": false
          }
        }
      ],
      "defaultValue": "large"
    }
  ],
  "tags": [
    {
      "id": "fb1ee42a-629a-4d99-9e7f-1da3c5f7a691",
      "name": "biology",
      "type": "field"
    },
    {
      "id": "6e4e74a4-560e-4674-95c3-60fe895b8c91",
      "name": "genomics",
      "type": "subfield"
    },
    {
      "id": "831477f4-f572-4e27-af83-037661489800",
      "name": "analysis",
      "type": "task"
    }
  ]
}