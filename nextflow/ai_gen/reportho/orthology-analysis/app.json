{
  "name": "reportho-orthology-analysis",
  "title": "Ortholog Comparison & Consensus Analysis",
  "description": "Comprehensive comparative analysis of ortholog predictions across multiple databases. Fetches orthologs from public resources, calculates agreement statistics, generates consensus ortholog lists, and provides optional sequence alignment, structure analysis, and phylogenetic reconstruction. Samplesheet format: `id,query`",
  "version": "1.0.1",
  "engineType": "NEXTFLOW",
  "command": "nextflow run nf-core/reportho --input ${input} --outdir ${outdir} -r 1.0.1",
  "imageUrl": "https://raw.githubusercontent.com/nf-core/reportho/master/docs/images/nf-core-reportho_logo_light.png",
  "content": "<h1 class=\"heading-node\">\ud83e\uddec Ortholog Comparison & Consensus Analysis</h1><p class=\"text-node\"><strong>Identify and Validate Orthologs Across Species with Confidence</strong></p><p class=\"text-node\">Ortholog detection is fundamental to comparative genomics, evolutionary studies, and functional annotation transfer. This pipeline compares ortholog predictions from multiple public databases, calculates agreement metrics, and generates high-confidence consensus ortholog lists for your query proteins.</p><img src=\"https://raw.githubusercontent.com/nf-core/reportho/master/docs/images/nf-core-reportho_logo_light.png\" alt=\"nf-core/reportho workflow\" width=\"600\" height=\"300\"><h2 class=\"heading-node\">\ud83c\udfaf What Are Orthologs?</h2><p class=\"text-node\">Orthologs are genes in different species that evolved from a common ancestral gene through speciation. They typically retain the same biological function across species, making them critical for:</p><ul class=\"list-node\"><li><p class=\"text-node\"><strong>\ud83e\uddec Functional Annotation Transfer:</strong> Predict gene function based on characterized orthologs</p></li><li><p class=\"text-node\"><strong>\ud83c\udf33 Evolutionary Analysis:</strong> Study gene evolution, selection pressure, and conservation</p></li><li><p class=\"text-node\"><strong>\ud83d\udd2c Model Organism Research:</strong> Translate findings from mouse/fly to human biology</p></li><li><p class=\"text-node\"><strong>\ud83d\udc8a Drug Target Discovery:</strong> Identify conserved therapeutic targets across species</p></li><li><p class=\"text-node\"><strong>\ud83e\uddea Comparative Genomics:</strong> Understand genome evolution and gene family expansion</p></li></ul><h2 class=\"heading-node\">\ud83d\udca1 Why Use Multiple Ortholog Databases?</h2><p class=\"text-node\">Different ortholog prediction algorithms use distinct methodologies (sequence similarity, phylogenetic analysis, synteny) and may produce conflicting results. This pipeline addresses this challenge by:</p><ul class=\"list-node\"><li><p class=\"text-node\"><strong>\ud83d\udcca Aggregating Multiple Sources:</strong> Fetches predictions from leading public databases</p></li><li><p class=\"text-node\"><strong>\ud83c\udfaf Calculating Agreement:</strong> Computes pairwise and global consensus metrics</p></li><li><p class=\"text-node\"><strong>\u2705 Generating Consensus:</strong> Creates high-confidence ortholog lists based on agreement threshold</p></li><li><p class=\"text-node\"><strong>\ud83d\udcc8 Visualizing Conflicts:</strong> Identifies discrepancies between prediction methods</p></li><li><p class=\"text-node\"><strong>\ud83d\udd0d Quality Assessment:</strong> Helps users evaluate prediction reliability</p></li></ul><h2 class=\"heading-node\">\ud83d\udd2c Pipeline Workflow</h2><h3 class=\"heading-node\">Step 1: Query Protein Identification</h3><ul class=\"list-node\"><li><p class=\"text-node\">Accepts UniProt IDs or FASTA sequences</p></li><li><p class=\"text-node\">For FASTA input: identifies closest annotated homolog in UniProt</p></li><li><p class=\"text-node\">Retrieves protein metadata and taxonomic information</p></li></ul><h3 class=\"heading-node\">Step 2: Ortholog Prediction Retrieval</h3><ul class=\"list-node\"><li><p class=\"text-node\">Queries multiple ortholog databases for each protein</p></li><li><p class=\"text-node\">Fetches ortholog lists from public resources</p></li><li><p class=\"text-node\">Identifies synonymous identifiers across databases</p></li></ul><h3 class=\"heading-node\">Step 3: Agreement Calculation</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Pairwise Agreement:</strong> Compares each database pair</p></li><li><p class=\"text-node\"><strong>Global Agreement:</strong> Overall consensus across all sources</p></li><li><p class=\"text-node\"><strong>Confidence Scoring:</strong> Ranks orthologs by prediction agreement</p></li></ul><h3 class=\"heading-node\">Step 4: Consensus Ortholog List</h3><ul class=\"list-node\"><li><p class=\"text-node\">Generates consensus list with user-defined confidence threshold</p></li><li><p class=\"text-node\">Filters orthologs based on agreement metrics</p></li><li><p class=\"text-node\">Provides both strict and permissive ortholog sets</p></li></ul><h3 class=\"heading-node\">Step 5: Optional Downstream Analyses</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>\ud83e\uddec Sequence Retrieval:</strong> Fetches protein sequences for consensus orthologs</p></li><li><p class=\"text-node\"><strong>\ud83c\udfd7\ufe0f Structure Retrieval:</strong> Downloads AlphaFold predicted structures</p></li><li><p class=\"text-node\"><strong>\ud83d\udd17 Multiple Sequence Alignment:</strong> Aligns orthologs using T-COFFEE or 3D-COFFEE</p></li><li><p class=\"text-node\"><strong>\ud83c\udf33 Phylogenetic Reconstruction:</strong> Builds phylogenetic trees (IQ-TREE or FastME)</p></li></ul><h3 class=\"heading-node\">Step 6: Report Generation</h3><ul class=\"list-node\"><li><p class=\"text-node\">Creates comprehensive HTML report with visualizations</p></li><li><p class=\"text-node\">Summarizes agreement statistics and ortholog counts</p></li><li><p class=\"text-node\">Provides downloadable ortholog lists in multiple formats</p></li></ul><h2 class=\"heading-node\">\ud83d\udccb Input Requirements</h2><h3 class=\"heading-node\">Samplesheet Format (CSV)</h3><p class=\"text-node\">Your input CSV must contain two columns:</p><pre class=\"block-node\"><code>id,query\nBicD2,Q8TD16\nHBB,P68871\nTP53,P04637</code></pre><p class=\"text-node\"><strong>Column Descriptions:</strong></p><ul class=\"list-node\"><li><p class=\"text-node\"><strong>id:</strong> User-defined identifier (no spaces, alphanumeric with underscores)</p></li><li><p class=\"text-node\"><strong>query:</strong> Either UniProt accession (e.g., Q8TD16) or path to FASTA file</p></li></ul><h3 class=\"heading-node\">Input Types</h3><p class=\"text-node\"><strong>Option 1: UniProt IDs (Recommended)</strong></p><pre class=\"block-node\"><code>id,query\nMyProtein1,Q8TD16\nMyProtein2,P68871</code></pre><ul class=\"list-node\"><li><p class=\"text-node\">Direct database lookup</p></li><li><p class=\"text-node\">Fastest processing</p></li><li><p class=\"text-node\">Most accurate metadata retrieval</p></li></ul><p class=\"text-node\"><strong>Option 2: FASTA Files</strong></p><pre class=\"block-node\"><code>id,query\nNovel_Protein,data/protein1.fasta\nOrphan_Gene,data/protein2.fasta</code></pre><ul class=\"list-node\"><li><p class=\"text-node\">For proteins without UniProt annotation</p></li><li><p class=\"text-node\">Pipeline identifies closest annotated homolog</p></li><li><p class=\"text-node\">Uses homolog's orthologs as proxy</p></li></ul><h2 class=\"heading-node\">\ud83d\udd27 Configuration Options</h2><h3 class=\"heading-node\">Standard Run (Default)</h3><ul class=\"list-node\"><li><p class=\"text-node\">Fetches orthologs from public databases</p></li><li><p class=\"text-node\">Calculates agreement and generates consensus</p></li><li><p class=\"text-node\">Creates HTML report</p></li><li><p class=\"text-node\">Requires internet connectivity</p></li></ul><h3 class=\"heading-node\">Offline Mode</h3><ul class=\"list-node\"><li><p class=\"text-node\">Use <code class=\"inline\" spellcheck=\"false\">--local_databases true</code> for local database access</p></li><li><p class=\"text-node\">Set <code class=\"inline\" spellcheck=\"false\">--use_all false</code> to skip online resources</p></li><li><p class=\"text-node\">Enable <code class=\"inline\" spellcheck=\"false\">--offline_run true</code> for complete offline analysis</p></li><li><p class=\"text-node\">Note: FASTA input not supported in fully offline mode</p></li></ul><h3 class=\"heading-node\">Downstream Analysis Options</h3><ul class=\"list-node\"><li><p class=\"text-node\"><code class=\"inline\" spellcheck=\"false\">--use_structures true</code>: Fetch AlphaFold structures</p></li><li><p class=\"text-node\"><code class=\"inline\" spellcheck=\"false\">--use_iqtree true</code>: Build maximum likelihood phylogeny</p></li><li><p class=\"text-node\"><code class=\"inline\" spellcheck=\"false\">--use_fastme true</code>: Build distance-based phylogeny</p></li><li><p class=\"text-node\"><code class=\"inline\" spellcheck=\"false\">--skip_merge</code>: Skip downstream analysis steps</p></li></ul><h2 class=\"heading-node\">\ud83d\udcca Output Files</h2><h3 class=\"heading-node\">Core Results</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>HTML Report:</strong> Interactive summary with agreement statistics and visualizations</p></li><li><p class=\"text-node\"><strong>Consensus Ortholog Lists:</strong> TSV/CSV files with high-confidence orthologs</p></li><li><p class=\"text-node\"><strong>Agreement Matrices:</strong> Pairwise and global agreement metrics</p></li><li><p class=\"text-node\"><strong>Database Comparisons:</strong> Detailed prediction comparisons</p></li></ul><h3 class=\"heading-node\">Optional Downstream Results</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Protein Sequences:</strong> FASTA files for consensus orthologs</p></li><li><p class=\"text-node\"><strong>AlphaFold Structures:</strong> PDB files from AlphaFold Database</p></li><li><p class=\"text-node\"><strong>Multiple Alignments:</strong> Aligned ortholog sequences (FASTA/ClustalW format)</p></li><li><p class=\"text-node\"><strong>Phylogenetic Trees:</strong> Newick format trees with bootstrap support</p></li><li><p class=\"text-node\"><strong>Tree Visualizations:</strong> PDF/SVG phylogeny plots</p></li></ul><h3 class=\"heading-node\">Quality Control</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>MultiQC Report:</strong> Pipeline execution summary</p></li><li><p class=\"text-node\"><strong>Database Coverage:</strong> Number of orthologs per database</p></li><li><p class=\"text-node\"><strong>Agreement Distributions:</strong> Histogram of prediction concordance</p></li></ul><h2 class=\"heading-node\">\ud83c\udfaf Use Cases & Applications</h2><h3 class=\"heading-node\">Functional Genomics</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Function Transfer:</strong> Annotate uncharacterized proteins using well-studied orthologs</p></li><li><p class=\"text-node\"><strong>Pathway Conservation:</strong> Identify conserved biological pathways across species</p></li><li><p class=\"text-node\"><strong>Gene Loss/Gain:</strong> Detect lineage-specific gene losses or duplications</p></li></ul><h3 class=\"heading-node\">Evolutionary Biology</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Molecular Evolution:</strong> Study sequence conservation and divergence rates</p></li><li><p class=\"text-node\"><strong>Selection Analysis:</strong> Identify genes under positive or purifying selection</p></li><li><p class=\"text-node\"><strong>Speciation Events:</strong> Date gene duplication and speciation events</p></li></ul><h3 class=\"heading-node\">Translational Research</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Model Organisms:</strong> Validate findings from mouse/fly in human orthologs</p></li><li><p class=\"text-node\"><strong>Drug Targets:</strong> Assess target conservation across species for drug development</p></li><li><p class=\"text-node\"><strong>Disease Genes:</strong> Identify disease gene orthologs for comparative studies</p></li></ul><h3 class=\"heading-node\">Comparative Genomics</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Genome Annotation:</strong> Transfer annotations to newly sequenced genomes</p></li><li><p class=\"text-node\"><strong>Synteny Analysis:</strong> Combine with synteny data for improved predictions</p></li><li><p class=\"text-node\"><strong>Gene Family Analysis:</strong> Study expansion/contraction of gene families</p></li></ul><h2 class=\"heading-node\">\ud83d\udd0d Understanding Results</h2><h3 class=\"heading-node\">Agreement Metrics</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>High Agreement (>80%):</strong> Strong consensus, high confidence orthologs</p></li><li><p class=\"text-node\"><strong>Moderate Agreement (50-80%):</strong> Reasonable consensus, validate with additional data</p></li><li><p class=\"text-node\"><strong>Low Agreement (<50%):</strong> Conflicting predictions, requires careful interpretation</p></li></ul><h3 class=\"heading-node\">Consensus Thresholds</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Strict Consensus:</strong> Orthologs predicted by majority of databases (high specificity)</p></li><li><p class=\"text-node\"><strong>Permissive Consensus:</strong> Orthologs predicted by at least 2 databases (high sensitivity)</p></li><li><p class=\"text-node\"><strong>Custom Threshold:</strong> User-defined agreement level based on research needs</p></li></ul><h3 class=\"heading-node\">Validation Strategies</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Phylogenetic Validation:</strong> Verify ortholog relationships in phylogenetic tree</p></li><li><p class=\"text-node\"><strong>Synteny Check:</strong> Confirm orthologs in syntenic genomic regions</p></li><li><p class=\"text-node\"><strong>Functional Validation:</strong> Test if orthologs have conserved function</p></li><li><p class=\"text-node\"><strong>Expression Patterns:</strong> Compare expression profiles across species</p></li></ul><h2 class=\"heading-node\">\u2699\ufe0f Technical Details</h2><ul class=\"list-node\"><li><p class=\"text-node\"><strong>\ud83d\udd27 Container Technology:</strong> Singularity/Docker for reproducibility</p></li><li><p class=\"text-node\"><strong>\ud83d\udcca Database Integration:</strong> Automated queries to public ortholog databases</p></li><li><p class=\"text-node\"><strong>\ud83e\uddee Alignment Tools:</strong> T-COFFEE (sequence) or 3D-COFFEE (structure-aware)</p></li><li><p class=\"text-node\"><strong>\ud83c\udf33 Phylogeny Tools:</strong> IQ-TREE (ML) or FastME (distance-based)</p></li><li><p class=\"text-node\"><strong>\ud83c\udfd7\ufe0f Structure Database:</strong> AlphaFold Database integration</p></li><li><p class=\"text-node\"><strong>\u2705 Quality Control:</strong> MultiQC aggregated reporting</p></li></ul><h2 class=\"heading-node\">\ud83c\udfaf Expected Runtime & Resources</h2><ul class=\"list-node\"><li><p class=\"text-node\"><strong>\u23f1\ufe0f Runtime:</strong> 30 minutes - 2 hours (depends on protein count and downstream analysis)</p></li><li><p class=\"text-node\"><strong>\ud83d\udcbe Storage:</strong> 1-10 GB per run (increases with structure/phylogeny analysis)</p></li><li><p class=\"text-node\"><strong>\ud83d\udda5\ufe0f Resources:</strong> LARGE node recommended for >10 proteins or phylogenetic analysis</p></li><li><p class=\"text-node\"><strong>\ud83c\udf10 Network:</strong> Requires internet for standard mode; offline mode available</p></li></ul><h2 class=\"heading-node\">\ud83d\udcda Scientific Context</h2><h3 class=\"heading-node\">Orthology vs Paralogy</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Orthologs:</strong> Separated by speciation event (typically same function)</p></li><li><p class=\"text-node\"><strong>Paralogs:</strong> Separated by duplication event (often divergent function)</p></li><li><p class=\"text-node\"><strong>In-paralogs:</strong> Duplications after speciation</p></li><li><p class=\"text-node\"><strong>Out-paralogs:</strong> Duplications before speciation</p></li></ul><h3 class=\"heading-node\">Why Database Predictions Differ</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Algorithm Differences:</strong> Sequence similarity vs phylogenetic inference</p></li><li><p class=\"text-node\"><strong>Species Coverage:</strong> Different databases cover different taxa</p></li><li><p class=\"text-node\"><strong>Update Frequency:</strong> Databases updated at different intervals</p></li><li><p class=\"text-node\"><strong>Definition Stringency:</strong> Strict vs relaxed orthology criteria</p></li><li><p class=\"text-node\"><strong>One-to-Many:</strong> Handling of duplications and gene losses</p></li></ul><h2 class=\"heading-node\">\ud83e\uddea Example Research Questions</h2><ul class=\"list-node\"><li><p class=\"text-node\">What is the human ortholog of this mouse gene?</p></li><li><p class=\"text-node\">Is my drug target conserved across mammals?</p></li><li><p class=\"text-node\">When did this gene family expand during evolution?</p></li><li><p class=\"text-node\">Can I use yeast as a model for studying this human protein?</p></li><li><p class=\"text-node\">Which species lack orthologs of my gene of interest?</p></li><li><p class=\"text-node\">Are ortholog predictions consistent across databases?</p></li></ul><p class=\"text-node\"><strong>Perfect for Research in:</strong> Comparative genomics \u2022 Evolutionary biology \u2022 Functional annotation \u2022 Model organism research \u2022 Drug target discovery \u2022 Genome annotation \u2022 Phylogenomics \u2022 Translational studies</p><p class=\"text-node\">Built with <a class=\"link\" href=\"https://www.nextflow.io/\" target=\"_blank\">Nextflow</a> \u2022 Powered by <a class=\"link\" href=\"https://nf-co.re/reportho/1.0.1/\" target=\"_blank\">nf-core/reportho v1.0.1</a> \u2022 Containerized execution \u2022 Multi-database validation</p>",
  "spec": [
    {
      "type": "Stash File",
      "label": "Sample Sheet",
      "name": "input",
      "description": "CSV file with two columns: 'id' (identifier) and 'query' (UniProt accession or FASTA file path). Example: id,query\\nBicD2,Q8TD16\\nHBB,P68871",
      "required": true,
      "restrictions": {
        "allow_files": true,
        "allow_folders": false,
        "allowed_file_types": [
          ".csv"
        ]
      }
    },
    {
      "type": "Stash File",
      "label": "Output Directory",
      "name": "outdir",
      "description": "Directory where ortholog comparison results, consensus lists, and optional downstream analyses will be saved",
      "defaultValue": "./reportho-results",
      "required": true,
      "restrictions": {
        "allow_files": false,
        "allow_folders": true
      }
    }
  ],
  "jobConfig": [
    {
      "type": "Select",
      "label": "System Size",
      "name": "system_size",
      "hidden": false,
      "description": "Select compute resources based on dataset size and analyses. MEDIUM for standard runs, LARGE for >10 proteins or phylogenetic analysis.",
      "options": [
        {
          "label": "MEDIUM (32 CPUs, 120GB RAM) - Standard ortholog analysis",
          "value": "medium",
          "mapValue": {
            "nodeSize": "MEDIUM",
            "numNodes": 1,
            "withGpu": false
          }
        },
        {
          "label": "LARGE (64 CPUs, 360GB RAM) - Large datasets or phylogeny",
          "value": "large",
          "mapValue": {
            "nodeSize": "LARGE",
            "numNodes": 1,
            "withGpu": false
          }
        }
      ],
      "defaultValue": "medium"
    }
  ],
  "tags": [
    {
      "id": "fb1ee42a-629a-4d99-9e7f-1da3c5f7a691",
      "name": "biology",
      "type": "field"
    },
    {
      "id": "6e4e74a4-560e-4674-95c3-60fe895b8c91",
      "name": "genomics",
      "type": "subfield"
    },
    {
      "id": "831477f4-f572-4e27-af83-037661489800",
      "name": "analysis",
      "type": "task"
    }
  ]
}