{
    "name": "cellpainting-phenotypic-profiling",
    "title": "High-Content Phenotypic Profiling",
    "description": "Comprehensive morphological profiling using Cell Painting microscopy assay with automated CellProfiler analysis. Extracts ~1,500 morphological features per cell from multiplexed fluorescent staining to detect subtle phenotypic differences in cellular organization, perfect for drug discovery, toxicology screening, and cellular phenotyping. Samplesheet format: `sample,image_channel1,image_channel2,image_channel3,image_channel4,image_channel5`",
    "content": "<h1 class=\"heading-node\">\ud83d\udd2c Cell Painting: High-Content Phenotypic Profiling</h1><p class=\"text-node\"><strong>Discover Cellular Phenotypes Through Morphological Features</strong></p><p class=\"text-node\">Cell Painting is a multiplexed image-based assay that uses six fluorescent stains to label eight distinct cellular compartments (DNA, RNA, nucleoli, actin, Golgi, plasma membrane, ER, and mitochondria). Automated image analysis extracts approximately 1,500 morphological features per cell - providing a rich phenotypic profile for detecting subtle changes in cellular structure and organization.</p><img src=\"https://raw.githubusercontent.com/nf-core/cellpainting/dev/docs/images/nf-core-cellpainting_logo_light.png\" alt=\"nf-core/cellpainting workflow\" width=\"600\" height=\"400\"><h2 class=\"heading-node\">\ud83c\udfaf What is Cell Painting?</h2><p class=\"text-node\">Cell Painting is the gold standard for morphological profiling and image-based screening:</p><ul class=\"list-node\"><li><p class=\"text-node\"><strong>\ud83c\udfa8 Six Fluorescent Dyes:</strong> Hoechst (DNA), concanavalin A/WGA (ER), SYTO 14 (nucleoli/RNA), phalloidin (actin), WGA (Golgi/plasma membrane), MitoTracker (mitochondria)</p></li><li><p class=\"text-node\"><strong>\ud83d\udcf8 Five-Channel Imaging:</strong> Captures comprehensive cellular structure across multiple wavelengths</p></li><li><p class=\"text-node\"><strong>\ud83d\udcca ~1,500 Features:</strong> Measures intensity, texture, shape, size, and spatial relationships</p></li><li><p class=\"text-node\"><strong>\ud83d\udd0d Single-Cell Resolution:</strong> Detects heterogeneity within cell populations</p></li></ul><h2 class=\"heading-node\">\ud83e\uddec Cellular Compartments Profiled</h2><p class=\"text-node\">Cell Painting simultaneously visualizes eight cellular components:</p><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Nucleus (DNA):</strong> Nuclear morphology, chromatin organization, cell cycle state</p></li><li><p class=\"text-node\"><strong>Nucleoli & RNA:</strong> Transcriptional activity, stress responses</p></li><li><p class=\"text-node\"><strong>Cytoskeleton (Actin):</strong> Cell shape, motility, cytoskeletal rearrangement</p></li><li><p class=\"text-node\"><strong>Endoplasmic Reticulum:</strong> Protein synthesis, ER stress responses</p></li><li><p class=\"text-node\"><strong>Golgi Apparatus:</strong> Protein trafficking, post-translational modification</p></li><li><p class=\"text-node\"><strong>Plasma Membrane:</strong> Cell boundaries, membrane organization</p></li><li><p class=\"text-node\"><strong>Mitochondria:</strong> Energy metabolism, mitochondrial morphology and distribution</p></li><li><p class=\"text-node\"><strong>Cytoplasm:</strong> Overall cellular organization and composition</p></li></ul><h2 class=\"heading-node\">\ud83d\udd2c Analysis Pipeline Workflow</h2><p class=\"text-node\">The pipeline uses CellProfiler for automated image processing:</p><h3 class=\"heading-node\">1. Illumination Correction</h3><ul class=\"list-node\"><li><p class=\"text-node\">Corrects spatial illumination heterogeneities from microscope optics</p></li><li><p class=\"text-node\">Removes background noise and shading artifacts</p></li><li><p class=\"text-node\">Ensures consistent intensity measurements across the field of view</p></li></ul><h3 class=\"heading-node\">2. Quality Control</h3><ul class=\"list-node\"><li><p class=\"text-node\">Identifies images failing quality criteria</p></li><li><p class=\"text-node\">Detects out-of-focus images, debris, or technical artifacts</p></li><li><p class=\"text-node\">Flags problematic wells or fields for review</p></li></ul><h3 class=\"heading-node\">3. Feature Extraction</h3><ul class=\"list-node\"><li><p class=\"text-node\">Segments nuclei, cells, and cytoplasm boundaries</p></li><li><p class=\"text-node\">Identifies cellular compartments in all channels</p></li><li><p class=\"text-node\">Extracts morphological measurements: size, shape, texture, intensity</p></li><li><p class=\"text-node\">Calculates spatial relationships between organelles</p></li><li><p class=\"text-node\">Generates ~1,500 features per cell</p></li></ul><h2 class=\"heading-node\">\ud83c\udfaf Applications & Use Cases</h2><p class=\"text-node\">Cell Painting excels at detecting phenotypic changes across diverse applications:</p><ul class=\"list-node\"><li><p class=\"text-node\"><strong>\ud83d\udc8a Drug Discovery:</strong> Identify compounds with similar mechanisms of action</p></li><li><p class=\"text-node\"><strong>\ud83d\udd2c Toxicology Screening:</strong> Detect cellular stress, cytotoxicity, and off-target effects</p></li><li><p class=\"text-node\"><strong>\ud83e\uddec Genetic Perturbations:</strong> Profile CRISPR knockout/knockdown phenotypes</p></li><li><p class=\"text-node\"><strong>\ud83e\udda0 Infection Biology:</strong> Study pathogen-induced cellular changes</p></li><li><p class=\"text-node\"><strong>\ud83e\uddeb Disease Modeling:</strong> Characterize patient-derived cells or disease models</p></li><li><p class=\"text-node\"><strong>\ud83d\udd0d Target Identification:</strong> Discover novel biological pathways and targets</p></li><li><p class=\"text-node\"><strong>\ud83d\udcca Mechanism of Action:</strong> Group compounds by morphological signatures</p></li></ul><h2 class=\"heading-node\">\ud83d\udccb Input Requirements</h2><h3 class=\"heading-node\">Sample Sheet Format</h3><p class=\"text-node\">Your CSV samplesheet defines the microscopy images for analysis:</p><pre class=\"block-node\"><code>sample,image_channel1,image_channel2,image_channel3,image_channel4,image_channel5\ncontrol_well_A01,A01_C1.tif,A01_C2.tif,A01_C3.tif,A01_C4.tif,A01_C5.tif\ntreated_well_A02,A02_C1.tif,A02_C2.tif,A02_C3.tif,A02_C4.tif,A02_C5.tif\ntreated_well_A03,A03_C1.tif,A03_C2.tif,A03_C3.tif,A03_C4.tif,A03_C5.tif</code></pre><p class=\"text-node\"><strong>Column Definitions:</strong></p><ul class=\"list-node\"><li><p class=\"text-node\"><strong>sample:</strong> Unique identifier (well ID, condition name, or compound ID)</p></li><li><p class=\"text-node\"><strong>image_channel1-5:</strong> Paths to registered microscopy images for each fluorescent channel</p></li></ul><h3 class=\"heading-node\">Image Specifications</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Format:</strong> TIFF, PNG, or standard microscopy formats</p></li><li><p class=\"text-node\"><strong>Bit Depth:</strong> 16-bit recommended for quantitative analysis</p></li><li><p class=\"text-node\"><strong>Exposure:</strong> Images using ~50% of dynamic range (e.g., max intensity ~32,000 for 16-bit)</p></li><li><p class=\"text-node\"><strong>Registration:</strong> All channels should be pre-registered (aligned)</p></li><li><p class=\"text-node\"><strong>Channels:</strong> Five fluorescent channels corresponding to Cell Painting stains</p></li></ul><h2 class=\"heading-node\">\u2699\ufe0f CellProfiler Pipelines</h2><p class=\"text-node\">The analysis uses three specialized CellProfiler pipelines:</p><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Illumination Correction Pipeline:</strong> Calculates correction functions for each channel</p></li><li><p class=\"text-node\"><strong>Analysis Pipeline:</strong> Standard production analysis with feature extraction</p></li><li><p class=\"text-node\"><strong>Assay Development Pipeline:</strong> Exploratory analysis for protocol optimization</p></li></ul><p class=\"text-node\">You can provide custom .cppipe files or use the default pipelines optimized for Cell Painting.</p><h2 class=\"heading-node\">\ud83d\udcca Output Results</h2><h3 class=\"heading-node\">Feature Data</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>\ud83d\udccb Per-Cell Features:</strong> CSV/HDF5 files with all morphological measurements</p></li><li><p class=\"text-node\"><strong>\ud83c\udfaf Aggregated Profiles:</strong> Well-level or condition-level summaries</p></li><li><p class=\"text-node\"><strong>\ud83d\udcca Normalized Data:</strong> Batch-corrected, normalized feature matrices</p></li></ul><h3 class=\"heading-node\">Quality Control</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>\ud83d\udcc8 MultiQC Report:</strong> Comprehensive quality metrics and sample comparisons</p></li><li><p class=\"text-node\"><strong>\ud83d\uddbc\ufe0f Overlay Images:</strong> Segmentation overlays showing detected cells and compartments</p></li><li><p class=\"text-node\"><strong>\ud83d\udcca QC Metrics:</strong> Cell counts, segmentation quality, image quality scores</p></li></ul><h3 class=\"heading-node\">Processed Images</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>\ud83d\udd26 Corrected Images:</strong> Illumination-corrected images for all channels</p></li><li><p class=\"text-node\"><strong>\ud83c\udfa8 Segmentation Masks:</strong> Binary masks for nuclei, cells, and cytoplasm</p></li><li><p class=\"text-node\"><strong>\ud83d\udccd Object Outlines:</strong> Visual validation of cell identification</p></li></ul><h3 class=\"heading-node\">Analysis-Ready Data</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>\ud83d\udcc8 Feature Vectors:</strong> Ready for machine learning and clustering</p></li><li><p class=\"text-node\"><strong>\ud83d\udd0d Phenotypic Profiles:</strong> Standardized morphological signatures</p></li><li><p class=\"text-node\"><strong>\ud83d\udcca Statistical Summaries:</strong> Metadata and experimental annotations</p></li></ul><h2 class=\"heading-node\">\ud83d\udd2c Morphological Features Measured</h2><p class=\"text-node\">The pipeline extracts diverse feature types:</p><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Area & Shape:</strong> Cell size, nuclear size, eccentricity, compactness, form factor</p></li><li><p class=\"text-node\"><strong>Intensity:</strong> Mean, median, std dev, min/max intensities per compartment</p></li><li><p class=\"text-node\"><strong>Texture:</strong> Haralick features, Gabor filters, granularity measurements</p></li><li><p class=\"text-node\"><strong>Correlation:</strong> Co-localization between channels and compartments</p></li><li><p class=\"text-node\"><strong>Radial Distribution:</strong> Spatial organization within cells</p></li><li><p class=\"text-node\"><strong>Neighbors:</strong> Cell density, nearest neighbor distances</p></li></ul><h2 class=\"heading-node\">\ud83d\udca1 Best Practices</h2><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Replicates:</strong> Include biological replicates (minimum 3) for statistical power</p></li><li><p class=\"text-node\"><strong>Controls:</strong> Always include DMSO/vehicle controls and positive controls</p></li><li><p class=\"text-node\"><strong>Cell Count:</strong> Aim for 500-1000 cells per condition for robust profiling</p></li><li><p class=\"text-node\"><strong>Batch Design:</strong> Randomize treatments across plates to minimize batch effects</p></li><li><p class=\"text-node\"><strong>Exposure Optimization:</strong> Ensure images use 40-60% of dynamic range</p></li><li><p class=\"text-node\"><strong>Quality Control:</strong> Review segmentation quality before downstream analysis</p></li></ul><h2 class=\"heading-node\">\ud83d\udcda Scientific Background</h2><p class=\"text-node\">Cell Painting was developed by Carpenter Lab (Broad Institute) and published in Nature Protocols (2016). The assay has become the gold standard for image-based profiling, with applications in the Cell Painting Gallery containing millions of images from pharmaceutical and academic laboratories worldwide.</p><p class=\"text-node\">The method leverages high-content imaging to create rich phenotypic profiles that can reveal subtle biological effects invisible to traditional assays. Machine learning on Cell Painting features enables compound clustering, mechanism of action prediction, and identification of novel biological activities.</p><p class=\"text-node\"><strong>Perfect for Research in:</strong> Drug discovery \u2022 Toxicology \u2022 Chemical biology \u2022 Functional genomics \u2022 Disease modeling \u2022 Target identification \u2022 Phenotypic screening \u2022 Precision medicine</p><p class=\"text-node\">Built with <a class=\"link\" href=\"https://www.nextflow.io/\" target=\"_blank\">Nextflow</a> \u2022 Powered by <a class=\"link\" href=\"https://nf-co.re/cellpainting/dev/\" target=\"_blank\">nf-core/cellpainting dev</a> \u2022 Uses <a class=\"link\" href=\"https://cellprofiler.org/\" target=\"_blank\">CellProfiler</a> \u2022 Containerized execution</p>",
    "imageUrl": "https://raw.githubusercontent.com/nf-core/cellpainting/dev/docs/images/nf-core-cellpainting_logo_light.png",
    "command": "export NXF_CACHE_DIR=/camber_work/temp/.nextflow; export NXF_LOG_FILE=/home/camber/jobs/${JOB_ID}/outputs/nextflow.log; CP_MODE_FLAG=$([ \"${cellprofiler_mode}\" != \"analysis\" ] && echo \"--cellprofiler_mode ${cellprofiler_mode}\" || echo \"\"); ILLUM_PIPE=$([ \"${cellprofiler_illumination_cppipe}\" != \"default\" ] && echo \"--cellprofiler_illumination_cppipe ${cellprofiler_illumination_cppipe}\" || echo \"\"); ANALYSIS_PIPE=$([ \"${cellprofiler_analysis_cppipe}\" != \"default\" ] && echo \"--cellprofiler_analysis_cppipe ${cellprofiler_analysis_cppipe}\" || echo \"\"); ASSAY_PIPE=$([ \"${cellprofiler_assaydevelopment_cppipe}\" != \"default\" ] && echo \"--cellprofiler_assaydevelopment_cppipe ${cellprofiler_assaydevelopment_cppipe}\" || echo \"\"); STOP_FLAG=$([ \"${stop_after}\" != \"complete\" ] && echo \"--stop_after ${stop_after}\" || echo \"\"); nextflow run nf-core/cellpainting -r dev --input ${input} --outdir ${outdir} $CP_MODE_FLAG $ILLUM_PIPE $ANALYSIS_PIPE $ASSAY_PIPE $STOP_FLAG --max_time 99.h -c /etc/mpi/nextflow.camber.config -ansi-log false -profile k8s",
    "engineType": "NEXTFLOW",
    "jobConfig": [
        {
            "type": "Select",
            "label": "System Size",
            "name": "system_size",
            "hidden": true,
            "description": "Choose computing resources based on dataset size and number of images to process.",
            "options": [
                {
                    "label": "Medium (32 CPUs, 180GB RAM) - Small screening experiments",
                    "value": "medium",
                    "mapValue": {
                        "nodeSize": "MEDIUM",
                        "numNodes": 1,
                        "withGpu": false
                    }
                },
                {
                    "label": "Large (64 CPUs, 360GB RAM) - Standard plate-based screens",
                    "value": "large",
                    "mapValue": {
                        "nodeSize": "LARGE",
                        "numNodes": 1,
                        "withGpu": false
                    }
                },
                {
                    "label": "XLarge (96 CPUs, 540GB RAM) - Large-scale high-content screens",
                    "value": "xlarge",
                    "mapValue": {
                        "nodeSize": "XLARGE",
                        "numNodes": 1,
                        "withGpu": false
                    }
                }
            ],
            "defaultValue": "large"
        }
    ],
    "spec": [
        {
            "type": "Stash File",
            "label": "Sample Sheet",
            "name": "input",
            "description": "CSV samplesheet with image paths for each channel. Required columns: sample, image_channel1, image_channel2, etc.",
            "defaultValue": "",
            "hidden": false,
            "required": true,
            "disabled": false,
            "restrictions": {
                "allow_files": true,
                "allow_folders": false,
                "allowed_file_types": [
                    "csv"
                ]
            }
        },
        {
            "type": "Stash File",
            "label": "Output Directory",
            "name": "outdir",
            "description": "Directory for analysis results including feature data, QC reports, and processed images.",
            "defaultValue": "./results",
            "hidden": false,
            "required": true,
            "disabled": false,
            "restrictions": {
                "allow_files": false,
                "allow_folders": true,
                "allowed_file_types": []
            }
        },
        {
            "type": "Select",
            "label": "CellProfiler Analysis Mode",
            "name": "cellprofiler_mode",
            "description": "Analysis mode: standard production analysis, assay development/optimization, or illumination correction only.",
            "defaultValue": "analysis",
            "hidden": false,
            "required": false,
            "disabled": false,
            "options": [
                {
                    "label": "Analysis (Standard production pipeline with feature extraction)",
                    "value": "analysis"
                },
                {
                    "label": "Assay Development (Protocol optimization and parameter tuning)",
                    "value": "assaydevelopment"
                },
                {
                    "label": "Illumination Correction Only",
                    "value": "illumination"
                }
            ]
        },
        {
            "type": "Stash File",
            "label": "Custom Illumination Correction Pipeline",
            "name": "cellprofiler_illumination_cppipe",
            "description": "Optional: Custom CellProfiler pipeline file (.cppipe) for illumination correction. Leave empty to use default.",
            "defaultValue": "default",
            "hidden": false,
            "required": false,
            "disabled": false,
            "restrictions": {
                "allow_files": true,
                "allow_folders": false,
                "allowed_file_types": [
                    "cppipe"
                ]
            }
        },
        {
            "type": "Stash File",
            "label": "Custom Analysis Pipeline",
            "name": "cellprofiler_analysis_cppipe",
            "description": "Optional: Custom CellProfiler pipeline file (.cppipe) for feature extraction. Leave empty to use default Cell Painting pipeline.",
            "defaultValue": "default",
            "hidden": false,
            "required": false,
            "disabled": false,
            "restrictions": {
                "allow_files": true,
                "allow_folders": false,
                "allowed_file_types": [
                    "cppipe"
                ]
            }
        },
        {
            "type": "Stash File",
            "label": "Custom Assay Development Pipeline",
            "name": "cellprofiler_assaydevelopment_cppipe",
            "description": "Optional: Custom CellProfiler pipeline file (.cppipe) for assay development. Leave empty to use default.",
            "defaultValue": "default",
            "hidden": false,
            "required": false,
            "disabled": false,
            "restrictions": {
                "allow_files": true,
                "allow_folders": false,
                "allowed_file_types": [
                    "cppipe"
                ]
            }
        },
        {
            "type": "Select",
            "label": "Stop Pipeline After Stage",
            "name": "stop_after",
            "description": "Optionally stop the pipeline after a specific stage for debugging or partial analysis.",
            "defaultValue": "complete",
            "hidden": false,
            "required": false,
            "disabled": false,
            "options": [
                {
                    "label": "Complete Full Pipeline",
                    "value": "complete"
                },
                {
                    "label": "Stop After Illumination Correction",
                    "value": "illumination"
                },
                {
                    "label": "Stop After Quality Control",
                    "value": "qc"
                },
                {
                    "label": "Stop After Feature Extraction",
                    "value": "features"
                }
            ]
        }
    ],
    "tags": [
        {
            "id": "fb1ee42a-629a-4d99-9e7f-1da3c5f7a691",
            "name": "biology",
            "type": "field"
        },
        {
            "id": "6e4e74a4-560e-4674-95c3-60fe895b8c91",
            "name": "genomics",
            "type": "subfield"
        },
        {
            "id": "831477f4-f572-4e27-af83-037661489800",
            "name": "analysis",
            "type": "task"
        }
    ]
}