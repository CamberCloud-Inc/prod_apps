{
  "name": "drop-rna-outliers",
  "title": "Detection of RNA Outliers Pipeline",
  "description": "Identify aberrant gene expression, splicing, and mono-allelic expression from RNA-seq data. Powerful tool for rare disease diagnostics, detecting pathogenic variants through multi-omics integration and outlier analysis. Samplesheet format: `RNA_ID,RNA_BAM_FILE,DNA_VCF_FILE,DNA_ID,DROP_GROUP,PAIRED_END`",
  "version": "1.4.0",
  "engineType": "NEXTFLOW",
  "command": "nextflow run nf-core/drop --input ${input} --outdir ${outdir} -r 1.4.0",
  "imageUrl": "https://raw.githubusercontent.com/nf-core/drop/master/docs/images/nf-core-drop_logo_light.png",
  "content": "<h1 class=\"heading-node\">DROP: Detection of RNA Outliers Pipeline</h1><p class=\"text-node\"><strong>Powerful Multi-Module RNA-seq Analysis for Rare Disease Diagnostics</strong></p><p class=\"text-node\">DROP (Detection of RNA Outliers Pipeline) is an integrative workflow that detects aberrant gene expression, aberrant splicing, and mono-allelic expression patterns from raw RNA sequencing data. Originally developed at the Gagneur Lab (Technical University of Munich), DROP is designed to help researchers and clinicians use RNA-seq data to identify disease-causing variants that are difficult to detect through DNA sequencing alone.</p><img src=\"https://raw.githubusercontent.com/nf-core/drop/master/docs/images/nf-core-drop_logo_light.png\" alt=\"DROP Pipeline Logo\" width=\"600\" height=\"300\"><h2 class=\"heading-node\">What is DROP?</h2><p class=\"text-node\">DROP analyzes RNA-seq data to find genes behaving abnormally in a patient compared to a cohort of control samples. This is particularly valuable for diagnosing rare diseases where genetic variants may cause:</p><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Aberrant Expression:</strong> Genes expressed at unusually high or low levels</p></li><li><p class=\"text-node\"><strong>Aberrant Splicing:</strong> Incorrect mRNA splicing leading to defective proteins</p></li><li><p class=\"text-node\"><strong>Mono-allelic Expression:</strong> Loss of expression from one parental chromosome</p></li></ul><h2 class=\"heading-node\">Four Independent Analysis Modules</h2><h3 class=\"heading-node\">1. Aberrant Expression (AE) - OUTRIDER Method</h3><p class=\"text-node\">Detects genes with abnormal expression levels using the OUTRIDER statistical framework:</p><ul class=\"list-node\"><li><p class=\"text-node\">Identifies genes expressed significantly higher or lower than expected</p></li><li><p class=\"text-node\">Accounts for confounding factors (batch effects, technical variation)</p></li><li><p class=\"text-node\">Provides P-values and Z-scores for each gene-sample combination</p></li><li><p class=\"text-node\">Ideal for detecting variants affecting gene expression regulation</p></li></ul><h3 class=\"heading-node\">2. Aberrant Splicing (AS) - FRASER Method</h3><p class=\"text-node\">Identifies abnormal splicing patterns using the FRASER statistical framework:</p><ul class=\"list-node\"><li><p class=\"text-node\">Detects aberrant exon-exon junctions and intron retention</p></li><li><p class=\"text-node\">Quantifies splicing efficiency metrics (PSI, theta values)</p></li><li><p class=\"text-node\">Finds splice site variants missed by DNA-only analysis</p></li><li><p class=\"text-node\">Critical for discovering cryptic splice sites and exon skipping events</p></li></ul><h3 class=\"heading-node\">3. Mono-allelic Expression (MAE)</h3><p class=\"text-node\">Detects genes expressed from only one parental allele:</p><ul class=\"list-node\"><li><p class=\"text-node\">Identifies allele-specific expression imbalances</p></li><li><p class=\"text-node\">Requires variant calls (VCF file) with heterozygous SNPs</p></li><li><p class=\"text-node\">Reveals imprinting defects or cis-regulatory mutations</p></li><li><p class=\"text-node\">Useful for detecting nonsense-mediated decay</p></li></ul><h3 class=\"heading-node\">4. RNA Variant Calling</h3><p class=\"text-node\">Calls variants directly from RNA-seq data:</p><ul class=\"list-node\"><li><p class=\"text-node\">Identifies SNVs and small indels in expressed regions</p></li><li><p class=\"text-node\">Complements DNA-based variant calling</p></li><li><p class=\"text-node\">Validates variant expression at RNA level</p></li><li><p class=\"text-node\">Useful when DNA data is unavailable</p></li></ul><h2 class=\"heading-node\">Clinical Applications in Rare Disease Diagnostics</h2><h3 class=\"heading-node\">Why RNA-seq for Rare Diseases?</h3><p class=\"text-node\">Traditional DNA sequencing (WES/WGS) identifies variants but often cannot determine their functional impact. DROP bridges this gap by revealing:</p><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Variants of Uncertain Significance (VUS):</strong> Determine if variants affect gene expression/splicing</p></li><li><p class=\"text-node\"><strong>Non-coding Variants:</strong> Detect regulatory variants affecting expression</p></li><li><p class=\"text-node\"><strong>Splice Site Variants:</strong> Validate predicted splicing defects</p></li><li><p class=\"text-node\"><strong>Compound Heterozygotes:</strong> Confirm both alleles are affected</p></li></ul><h3 class=\"heading-node\">Diagnostic Success Cases</h3><p class=\"text-node\">DROP has been successfully used to diagnose:</p><ul class=\"list-node\"><li><p class=\"text-node\">Neurodevelopmental disorders with splicing defects</p></li><li><p class=\"text-node\">Mitochondrial diseases with expression abnormalities</p></li><li><p class=\"text-node\">Muscular dystrophies with aberrant splicing</p></li><li><p class=\"text-node\">Metabolic disorders with regulatory defects</p></li></ul><h2 class=\"heading-node\">Input Requirements</h2><h3 class=\"heading-node\">Sample Annotation File</h3><p class=\"text-node\">CSV/TSV file defining your samples and analysis modules:</p><pre class=\"block-node\"><code>RNA_ID,RNA_BAM_FILE,DNA_VCF_FILE,DNA_ID,DROP_GROUP,PAIRED_END\nPatient1,/path/to/patient1.bam,/path/to/patient1.vcf.gz,Patient1,disease_cohort,TRUE\nControl1,/path/to/control1.bam,,,control_cohort,TRUE\nControl2,/path/to/control2.bam,,,control_cohort,TRUE</code></pre><p class=\"text-node\"><strong>Key Columns:</strong></p><ul class=\"list-node\"><li><p class=\"text-node\"><strong>RNA_ID:</strong> Unique sample identifier</p></li><li><p class=\"text-node\"><strong>RNA_BAM_FILE:</strong> Path to aligned RNA-seq BAM file (required)</p></li><li><p class=\"text-node\"><strong>DNA_VCF_FILE:</strong> Path to DNA variant calls (required for MAE module)</p></li><li><p class=\"text-node\"><strong>DROP_GROUP:</strong> Cohort assignment (patients vs controls)</p></li><li><p class=\"text-node\"><strong>PAIRED_END:</strong> TRUE for paired-end, FALSE for single-end</p></li></ul><h3 class=\"heading-node\">Required Input Files</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>RNA-seq BAM files:</strong> Aligned RNA-seq reads (STAR or HISAT2 recommended)</p></li><li><p class=\"text-node\"><strong>Reference genome:</strong> FASTA file (GRCh37/38 for human)</p></li><li><p class=\"text-node\"><strong>Gene annotation:</strong> GTF file (Ensembl or GENCODE)</p></li><li><p class=\"text-node\"><strong>VCF files:</strong> Required only for MAE module (heterozygous variants)</p></li></ul><h3 class=\"heading-node\">Cohort Design Recommendations</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Minimum samples:</strong> 20-30 controls for robust outlier detection</p></li><li><p class=\"text-node\"><strong>Sample matching:</strong> Controls should match tissue type and age range</p></li><li><p class=\"text-node\"><strong>Sequencing depth:</strong> 50-100M paired-end reads per sample</p></li><li><p class=\"text-node\"><strong>Read length:</strong> 100-150bp paired-end recommended</p></li><li><p class=\"text-node\"><strong>Tissue specificity:</strong> Use tissue-matched controls (fibroblasts, blood, muscle, etc.)</p></li></ul><h2 class=\"heading-node\">Comprehensive Output Files</h2><h3 class=\"heading-node\">Aberrant Expression Results</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>aberrant_expression_results.tsv:</strong> Genes with outlier expression</p><ul class=\"list-node\"><li><p class=\"text-node\">Gene symbols, sample IDs</p></li><li><p class=\"text-node\">Fold-change, Z-scores, P-values</p></li><li><p class=\"text-node\">Normalized expression values</p></li></ul></li><li><p class=\"text-node\"><strong>OUTRIDER_plots/:</strong> QC plots and sample clustering</p></li></ul><h3 class=\"heading-node\">Aberrant Splicing Results</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>aberrant_splicing_results.tsv:</strong> Junctions with aberrant splicing</p><ul class=\"list-node\"><li><p class=\"text-node\">Junction coordinates, gene names</p></li><li><p class=\"text-node\">PSI values, delta-PSI, Z-scores</p></li><li><p class=\"text-node\">Splice site annotations</p></li></ul></li><li><p class=\"text-node\"><strong>FRASER_plots/:</strong> Splicing visualizations and QC</p></li></ul><h3 class=\"heading-node\">Mono-allelic Expression Results</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>mae_results.tsv:</strong> Genes with allelic imbalance</p><ul class=\"list-node\"><li><p class=\"text-node\">Heterozygous SNPs with expression data</p></li><li><p class=\"text-node\">Allele ratios and P-values</p></li><li><p class=\"text-node\">Rare variant annotations</p></li></ul></li></ul><h3 class=\"heading-node\">RNA Variant Calls</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>rna_variants.vcf.gz:</strong> Variants called from RNA-seq</p></li><li><p class=\"text-node\"><strong>Filtered VCF:</strong> High-confidence variants only</p></li></ul><h3 class=\"heading-node\">Quality Control Reports</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>MultiQC report:</strong> Comprehensive QC metrics</p></li><li><p class=\"text-node\"><strong>Sample correlation plots:</strong> Identify batch effects</p></li><li><p class=\"text-node\"><strong>Coverage statistics:</strong> Per-sample and per-gene</p></li></ul><h2 class=\"heading-node\">Interpreting Results</h2><h3 class=\"heading-node\">Prioritizing Candidate Genes</h3><p class=\"text-node\"><strong>High-priority outliers typically have:</strong></p><ul class=\"list-node\"><li><p class=\"text-node\">P-value < 0.01 (highly significant)</p></li><li><p class=\"text-node\">Z-score > 3 or < -3 (strong outlier)</p></li><li><p class=\"text-node\">Gene is disease-relevant (OMIM, HPO phenotype match)</p></li><li><p class=\"text-node\">Patient has rare DNA variant in the same gene</p></li><li><p class=\"text-node\">Outlier not present in control samples</p></li></ul><h3 class=\"heading-node\">Integration with DNA Data</h3><p class=\"text-node\">The most powerful diagnostic approach combines:</p><ol class=\"list-node\"><li><p class=\"text-node\"><strong>DNA variants (WES/WGS):</strong> Identify candidate variants</p></li><li><p class=\"text-node\"><strong>DROP expression:</strong> Check if variant affects expression</p></li><li><p class=\"text-node\"><strong>DROP splicing:</strong> Validate predicted splicing effects</p></li><li><p class=\"text-node\"><strong>DROP MAE:</strong> Confirm allelic imbalance</p></li></ol><h3 class=\"heading-node\">Validation Steps</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>RT-PCR:</strong> Validate aberrant splicing events</p></li><li><p class=\"text-node\"><strong>qPCR:</strong> Confirm expression outliers</p></li><li><p class=\"text-node\"><strong>Sanger sequencing:</strong> Validate RNA variants</p></li><li><p class=\"text-node\"><strong>Functional studies:</strong> Test variant effects in model systems</p></li></ul><h2 class=\"heading-node\">Comparison with Other Tools</h2><table class=\"table-node\"><thead><tr><th>Feature</th><th>DROP</th><th>LeafCutter</th><th>rMATS</th></tr></thead><tbody><tr><td>Aberrant Expression</td><td>Yes (OUTRIDER)</td><td>No</td><td>No</td></tr><tr><td>Aberrant Splicing</td><td>Yes (FRASER)</td><td>Differential only</td><td>Differential only</td></tr><tr><td>Mono-allelic Expression</td><td>Yes</td><td>No</td><td>No</td></tr><tr><td>RNA Variant Calling</td><td>Yes</td><td>No</td><td>No</td></tr><tr><td>Outlier Detection</td><td>Individual-level</td><td>Group comparison</td><td>Group comparison</td></tr><tr><td>Clinical Diagnostics</td><td>Optimized</td><td>Research</td><td>Research</td></tr></tbody></table><h2 class=\"heading-node\">Technical Details</h2><h3 class=\"heading-node\">Statistical Methods</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>OUTRIDER:</strong> Autoencoder-based outlier detection for expression</p></li><li><p class=\"text-node\"><strong>FRASER:</strong> Denoising autoencoder for splicing outliers</p></li><li><p class=\"text-node\"><strong>Multiple testing correction:</strong> Benjamini-Hochberg FDR</p></li><li><p class=\"text-node\"><strong>Batch effect correction:</strong> Built into statistical models</p></li></ul><h3 class=\"heading-node\">Computational Requirements</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Runtime:</strong> 4-12 hours depending on cohort size (20-100 samples)</p></li><li><p class=\"text-node\"><strong>Memory:</strong> 32-64 GB RAM recommended</p></li><li><p class=\"text-node\"><strong>Storage:</strong> ~10-50 GB per sample for intermediate files</p></li><li><p class=\"text-node\"><strong>CPU:</strong> 16-32 cores for optimal parallelization</p></li></ul><h3 class=\"heading-node\">Supported References</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Human genomes:</strong> GRCh37/hg19, GRCh38/hg38</p></li><li><p class=\"text-node\"><strong>Annotations:</strong> Ensembl, GENCODE, RefSeq</p></li><li><p class=\"text-node\"><strong>Other organisms:</strong> Any with reference genome and GTF annotation</p></li></ul><h2 class=\"heading-node\">Best Practices</h2><h3 class=\"heading-node\">Experimental Design</h3><ol class=\"list-node\"><li><p class=\"text-node\"><strong>Build adequate control cohort:</strong> 30+ matched tissue samples</p></li><li><p class=\"text-node\"><strong>Consistent library prep:</strong> Same protocol for all samples</p></li><li><p class=\"text-node\"><strong>Adequate sequencing depth:</strong> 50-100M paired-end reads</p></li><li><p class=\"text-node\"><strong>Biological matching:</strong> Age, sex, tissue type</p></li></ol><h3 class=\"heading-node\">Quality Control</h3><ol class=\"list-node\"><li><p class=\"text-node\"><strong>Check RNA quality:</strong> RIN > 7 for fresh, RIN > 5 for FFPE</p></li><li><p class=\"text-node\"><strong>Monitor batch effects:</strong> Review sample correlation plots</p></li><li><p class=\"text-node\"><strong>Validate alignment:</strong> >70% mapping rate recommended</p></li><li><p class=\"text-node\"><strong>Review QC metrics:</strong> MultiQC reports before interpretation</p></li></ol><h3 class=\"heading-node\">Result Interpretation</h3><ol class=\"list-node\"><li><p class=\"text-node\"><strong>Start with high-confidence outliers:</strong> P < 0.01, |Z| > 3</p></li><li><p class=\"text-node\"><strong>Check phenotype relevance:</strong> Match to patient symptoms</p></li><li><p class=\"text-node\"><strong>Integrate DNA variants:</strong> Look for supporting genetic evidence</p></li><li><p class=\"text-node\"><strong>Validate findings:</strong> RT-PCR, qPCR, functional studies</p></li></ol><h2 class=\"heading-node\">Publications and Citations</h2><p class=\"text-node\">DROP has been published in Nature Protocols and used in numerous rare disease diagnostic studies:</p><ul class=\"list-node\"><li><p class=\"text-node\"><strong>DROP manuscript:</strong> Yepez et al., Nature Protocols (2021)</p></li><li><p class=\"text-node\"><strong>OUTRIDER:</strong> Brechtmann et al., AJHG (2018)</p></li><li><p class=\"text-node\"><strong>FRASER:</strong> Mertes et al., Nature Communications (2021)</p></li></ul><h2 class=\"heading-node\">Clinical Use Cases</h2><h3 class=\"heading-node\">Scenario 1: Undiagnosed Genetic Disease</h3><p class=\"text-node\">A patient with neurodevelopmental delay has WES showing a VUS in a splice region. DROP reveals:</p><ul class=\"list-node\"><li><p class=\"text-node\">Aberrant splicing with exon skipping (Z = -5.2, P = 1e-7)</p></li><li><p class=\"text-node\">Reduced gene expression (Z = -4.1, P = 4e-5)</p></li><li><p class=\"text-node\">Functional validation confirms pathogenicity</p></li><li><p class=\"text-node\">Result: Molecular diagnosis established</p></li></ul><h3 class=\"heading-node\">Scenario 2: Non-coding Regulatory Variant</h3><p class=\"text-node\">Patient has deep intronic variant of unknown significance. DROP shows:</p><ul class=\"list-node\"><li><p class=\"text-node\">Cryptic splice site activation</p></li><li><p class=\"text-node\">Pseudo-exon inclusion in transcript</p></li><li><p class=\"text-node\">Frameshift leading to premature stop codon</p></li><li><p class=\"text-node\">Result: Pathogenic mechanism elucidated</p></li></ul><h3 class=\"heading-node\">Scenario 3: Compound Heterozygous Variants</h3><p class=\"text-node\">Patient with two rare variants in trans. DROP confirms:</p><ul class=\"list-node\"><li><p class=\"text-node\">One allele shows nonsense-mediated decay</p></li><li><p class=\"text-node\">Other allele has reduced expression</p></li><li><p class=\"text-node\">Combined effect leads to severe deficiency</p></li><li><p class=\"text-node\">Result: Recessive disease mechanism validated</p></li></ul><blockquote class=\"block-node\"><p class=\"text-node\"><strong>Perfect for:</strong> Rare disease diagnostics • Clinical genomics • Variant interpretation • RNA-seq analysis • Splice defect detection • Expression profiling • Allelic imbalance • Functional genomics</p></blockquote><p class=\"text-node\">Built with <a class=\"link\" href=\"https://www.nextflow.io/\" target=\"_blank\">Nextflow</a> • Powered by DROP v1.4.0 • Developed by <a class=\"link\" href=\"https://gagneurlab.github.io/\" target=\"_blank\">Gagneur Lab</a> • Published in <a class=\"link\" href=\"https://www.nature.com/nprot/\" target=\"_blank\">Nature Protocols</a></p>",
  "spec": [
    {
      "type": "Stash File",
      "label": "Sample Annotation File",
      "name": "input",
      "description": "CSV or TSV file containing sample information, BAM file paths, and analysis configuration. Must include columns: RNA_ID, RNA_BAM_FILE, DROP_GROUP, PAIRED_END. Optional: DNA_VCF_FILE for MAE analysis.",
      "required": true,
      "restrictions": {
        "allow_files": true,
        "allow_folders": false,
        "allowed_file_types": [
          ".csv",
          ".tsv"
        ]
      }
    },
    {
      "type": "Stash File",
      "label": "Output Directory",
      "name": "outdir",
      "description": "Directory where DROP analysis results will be saved, including aberrant expression, splicing, MAE results, and QC reports",
      "defaultValue": "./drop-results",
      "required": true,
      "restrictions": {
        "allow_files": false,
        "allow_folders": true
      }
    }
  ],
  "jobConfig": [
    {
      "type": "Select",
      "label": "Compute Resources",
      "name": "system_size",
      "hidden": false,
      "description": "Select compute resources based on cohort size. MEDIUM for 20-50 samples, LARGE for 50+ samples or deep sequencing data.",
      "options": [
        {
          "label": "MEDIUM (32 CPUs, 120GB RAM) - Standard cohorts (20-50 samples)",
          "value": "medium",
          "mapValue": {
            "nodeSize": "MEDIUM",
            "numNodes": 1,
            "withGpu": false
          }
        },
        {
          "label": "LARGE (64 CPUs, 360GB RAM) - Large cohorts (50+ samples)",
          "value": "large",
          "mapValue": {
            "nodeSize": "LARGE",
            "numNodes": 1,
            "withGpu": false
          }
        }
      ],
      "defaultValue": "medium"
    }
  ],
  "tags": [
    {
      "id": "fb1ee42a-629a-4d99-9e7f-1da3c5f7a691",
      "name": "biology",
      "type": "field"
    },
    {
      "id": "6e4e74a4-560e-4674-95c3-60fe895b8c91",
      "name": "genomics",
      "type": "subfield"
    },
    {
      "id": "831477f4-f572-4e27-af83-037661489800",
      "name": "analysis",
      "type": "task"
    }
  ]
}
