{
  "name": "scnanoseq-long-read",
  "title": "Single-Cell Long-Read Sequencing (Nanopore)",
  "description": "Process Oxford Nanopore single-cell RNA-seq data. Full-length transcript quantification with isoform resolution using long reads from 10X+Nanopore. Samplesheet format: `sample,fastq,type`",
  "version": "1.0.0",
  "engineType": "NEXTFLOW",
  "command": "nextflow run nf-core/scnanoseq --input ${input} --outdir ${outdir} --genome_fasta ${genome_fasta} --transcript_fasta ${transcript_fasta} --gtf ${gtf} --quantifier ${quantifier} --barcode_format ${barcode_format} -r dev ",
  "imageUrl": "https://raw.githubusercontent.com/nf-core/scnanoseq/master/docs/images/nf-core-scnanoseq_logo_light.png",
  "content": "<h2><strong>Single-Cell Long-Read Transcriptomics</strong></h2><p>Combine 10X Genomics barcoding with Oxford Nanopore long-read sequencing for <strong>full-length transcript</strong> quantification at single-cell resolution. Resolve isoforms, detect fusions, and measure allele-specific expression.</p><h3><strong>Why Long-Read scRNA-seq?</strong></h3><blockquote><ul><li><strong>Full-Length Transcripts</strong>: Capture complete mRNA sequences</li><li><strong>Isoform Resolution</strong>: Distinguish splice variants per cell</li><li><strong>Allele-Specific Expression</strong>: Phase variants to haplotypes</li><li><strong>Gene Fusions</strong>: Detect fusion transcripts</li><li><strong>Novel Isoforms</strong>: Discover unannotated transcripts</li><li><strong>Poly-A Tail Length</strong>: Measure mRNA stability</li></ul></blockquote><h3><strong>Technology: 10X + Nanopore</strong></h3><p><strong>Workflow</strong>:</p><ol><li><strong>10X Barcoding</strong>: Gel bead emulsion captures cells with barcodes</li><li><strong>cDNA Synthesis</strong>: Full-length cDNA with cell barcodes + UMIs</li><li><strong>Nanopore Sequencing</strong>: 1-10kb reads (Q20+ chemistry)</li><li><strong>Demultiplexing</strong>: Assign reads to cells</li><li><strong>Quantification</strong>: Isoform-level counts per cell</li></ol><p><strong>Advantages over Short-Read</strong>:</p><blockquote><p>Short-read: Exon junction inference (ambiguous isoforms)</p><p>Long-read: Direct isoform observation (unambiguous)</p></blockquote><h3><strong>Scientific Applications</strong></h3><ul><li><strong>Isoform Switching</strong>: Cell type-specific splicing</li><li><strong>Cancer Transcriptomics</strong>: Fusion detection per cell</li><li><strong>Developmental Biology</strong>: Stage-specific isoforms</li><li><strong>Disease Mechanisms</strong>: Pathogenic splice variants</li><li><strong>Allelic Imbalance</strong>: X-inactivation, imprinting</li><li><strong>Regulatory Variants</strong>: Link SNPs to isoforms</li></ul><h3><strong>Pipeline Features</strong></h3><ul><li><strong>Barcode Extraction</strong>: 10X v2/v3 formats</li><li><strong>Read Alignment</strong>: Minimap2 for long reads</li><li><strong>Isoform Quantification</strong>: IsoQuant, Oarfish</li><li><strong>Cell Filtering</strong>: Remove empty droplets</li><li><strong>QC Metrics</strong>: Read length, barcode quality, saturation</li><li><strong>Isoform Discovery</strong>: Novel transcript detection</li></ul><h3><strong>Quantification Tools</strong></h3><ul><li><strong>IsoQuant</strong>: Reference-based isoform quantification</li><li><strong>Oarfish</strong>: Transcript-level abundance estimation</li><li><strong>Both</strong>: Run both tools for comparison</li></ul><h3><strong>Input Requirements</strong></h3><p>CSV samplesheet with columns:</p><ul><li><strong>sample</strong>: Sample name</li><li><strong>fastq</strong>: Path to Nanopore FASTQ (gzipped)</li><li><strong>cell_count</strong>: Expected cell number (e.g., 5000)</li></ul><p>Plus reference files:</p><ul><li><strong>genome_fasta</strong>: Reference genome</li><li><strong>transcript_fasta</strong>: Transcriptome sequences</li><li><strong>gtf</strong>: Gene annotations</li><li><strong>barcode_format</strong>: 10X_3v3, 10X_5v2, etc.</li></ul><h3><strong>Key Outputs</strong></h3><ul><li><strong>Isoform Counts</strong>: UMI counts per isoform per cell</li><li><strong>Gene Counts</strong>: Collapsed to gene level</li><li><strong>Novel Isoforms</strong>: Unannotated transcripts</li><li><strong>Fusion Transcripts</strong>: Inter-gene fusions</li><li><strong>Allelic Expression</strong>: Phased to haplotypes</li><li><strong>QC Report</strong>: HTML with metrics</li></ul><blockquote><p><strong>Perfect for:</strong> Isoform analysis \u2022 Splice variant discovery \u2022 Fusion detection \u2022 Allele-specific expression \u2022 Novel transcript discovery</p></blockquote>",
  "spec": [
    {
      "type": "Stash File",
      "label": "Sample Sheet",
      "name": "input",
      "description": "CSV with Nanopore FASTQ files",
      "required": true,
      "restrictions": {
        "allow_files": true,
        "allow_folders": false,
        "allowed_file_types": [
          ".csv"
        ]
      }
    },
    {
      "type": "Stash File",
      "label": "Genome FASTA",
      "name": "genome_fasta",
      "description": "Reference genome FASTA file",
      "required": true,
      "restrictions": {
        "allow_files": true,
        "allow_folders": false,
        "allowed_file_types": [
          ".fa",
          ".fasta",
          ".fa.gz",
          ".fasta.gz"
        ]
      }
    },
    {
      "type": "Stash File",
      "label": "Transcript FASTA",
      "name": "transcript_fasta",
      "description": "Transcriptome FASTA file",
      "required": true,
      "restrictions": {
        "allow_files": true,
        "allow_folders": false,
        "allowed_file_types": [
          ".fa",
          ".fasta",
          ".fa.gz",
          ".fasta.gz"
        ]
      }
    },
    {
      "type": "Stash File",
      "label": "GTF Annotation",
      "name": "gtf",
      "description": "Gene annotation GTF file",
      "required": true,
      "restrictions": {
        "allow_files": true,
        "allow_folders": false,
        "allowed_file_types": [
          ".gtf",
          ".gtf.gz"
        ]
      }
    },
    {
      "type": "Select",
      "label": "Quantifier",
      "name": "quantifier",
      "description": "Isoform quantification tool",
      "defaultValue": "isoquant,oarfish",
      "required": true,
      "options": [
        {
          "label": "IsoQuant + Oarfish (Both)",
          "value": "isoquant,oarfish"
        },
        {
          "label": "IsoQuant only",
          "value": "isoquant"
        },
        {
          "label": "Oarfish only",
          "value": "oarfish"
        }
      ]
    },
    {
      "type": "Select",
      "label": "Barcode Format",
      "name": "barcode_format",
      "description": "10X barcode chemistry",
      "defaultValue": "10X_3v3",
      "required": true,
      "options": [
        {
          "label": "10X Chromium v3",
          "value": "10X_3v3"
        },
        {
          "label": "10X Chromium v2",
          "value": "10X_3v2"
        },
        {
          "label": "10X 5' v2",
          "value": "10X_5v2"
        }
      ]
    },
    {
      "type": "Stash File",
      "label": "Output Directory",
      "name": "outdir",
      "description": "Output directory",
      "defaultValue": "./scnanoseq-results",
      "required": true,
      "restrictions": {
        "allow_files": false,
        "allow_folders": true
      }
    }
  ],
  "jobConfig": [
    {
      "type": "Select",
      "label": "Compute Resources",
      "name": "system_size",
      "hidden": false,
      "options": [
        {
          "label": "XLARGE (Recommended for long reads)",
          "value": "xlarge",
          "mapValue": {
            "nodeSize": "XLARGE",
            "numNodes": 1,
            "withGpu": false
          }
        }
      ],
      "defaultValue": "xlarge"
    }
  ],
  "tags": [
    {
      "id": "fb1ee42a-629a-4d99-9e7f-1da3c5f7a691",
      "name": "biology",
      "type": "field"
    },
    {
      "id": "6e4e74a4-560e-4674-95c3-60fe895b8c91",
      "name": "genomics",
      "type": "subfield"
    },
    {
      "id": "831477f4-f572-4e27-af83-037661489800",
      "name": "analysis",
      "type": "task"
    }
  ]
}