{
  "name": "genomeassembler-long-read-assembly",
  "title": "Long-Read Genome Assembly",
  "description": "Complete genome assembly pipeline for haploid and diploid inbred genomes from long reads (ONT/PacBio HiFi). Features assembly with Flye/Hifiasm, polishing using Medaka/Pilon, scaffolding via LINKS/Longstitch/RagTag, and comprehensive QC with BUSCO/QUAST/Merqury. Samplesheet format: `sample,ontreads,hifireads,ref_fasta,shortread_F,shortread_R`",
  "version": "1.0.0",
  "engineType": "NEXTFLOW",
  "command": "nextflow run nf-core/genomeassembler --input ${input} --outdir ${outdir} -r dev ",
  "imageUrl": "https://raw.githubusercontent.com/nf-core/genomeassembler/master/docs/images/nf-core-genomeassembler_logo_light.png",
  "content": "<h2><strong>Genome Assembler: Long-Read Assembly Pipeline</strong></h2><p>A comprehensive pipeline for assembling, polishing, and scaffolding haploid or diploid inbred genomes from Oxford Nanopore Technologies (ONT) or PacBio HiFi long-read sequencing data. Produces high-quality, contiguous genome assemblies with extensive quality assessment.</p><h3><strong>What is Genome Assembly?</strong></h3><blockquote><p><strong>Genome assembly</strong> reconstructs the complete DNA sequence of an organism by piecing together millions of short DNA fragments (reads). Long-read technologies like ONT and PacBio HiFi produce reads up to 100 kb, enabling more contiguous assemblies that span repetitive regions and resolve complex genomic structures.</p></blockquote><h3><strong>Key Features</strong></h3><ul><li><strong>Dual Assembler Support</strong>: Flye (ONT-optimized) and Hifiasm (PacBio HiFi-optimized)</li><li><strong>Multiple Polishing Methods</strong>: Medaka for ONT, Pilon for short-read polishing</li><li><strong>Flexible Scaffolding</strong>: LINKS, Longstitch, or reference-guided RagTag</li><li><strong>Comprehensive QC</strong>: BUSCO completeness, QUAST metrics, Merqury accuracy</li><li><strong>Hybrid Assembly</strong>: Optionally integrate short reads for polishing</li><li><strong>Reference-Guided Improvement</strong>: Use related genome for scaffolding with RagTag</li></ul><h3><strong>Pipeline Workflow</strong></h3><ol><li><strong>Read Quality Control</strong>: Assess long-read quality, length distributions, coverage</li><li><strong>Genome Assembly</strong>: Assemble contigs using Flye (ONT) or Hifiasm (HiFi)</li><li><strong>Assembly Polishing</strong>: Correct base-level errors with Medaka or Pilon</li><li><strong>Scaffolding</strong>: Join contigs into larger scaffolds using LINKS/Longstitch/RagTag</li><li><strong>Quality Assessment</strong>: Evaluate with BUSCO, QUAST, and Merqury</li><li><strong>Contamination Screening</strong>: Detect and filter contaminant sequences</li><li><strong>Final Assembly</strong>: Generate polished, scaffolded genome</li></ol><h3><strong>Assembly Technologies</strong></h3><h4><strong>Oxford Nanopore (ONT)</strong></h4><ul><li><strong>Read Length</strong>: 10-100 kb, ultra-long reads >100 kb possible</li><li><strong>Error Profile</strong>: Higher error rate (5-10%), mostly indels</li><li><strong>Assembler</strong>: Flye recommended</li><li><strong>Polishing</strong>: Medaka for error correction</li><li><strong>Advantages</strong>: Long reads, real-time sequencing, portable</li><li><strong>Best for</strong>: Complex genomes, structural variants, methylation</li></ul><h4><strong>PacBio HiFi</strong></h4><ul><li><strong>Read Length</strong>: 10-25 kb circular consensus sequences</li><li><strong>Error Profile</strong>: Very low error rate (<1%), high accuracy</li><li><strong>Assembler</strong>: Hifiasm recommended</li><li><strong>Polishing</strong>: Often not required, optional with Pilon</li><li><strong>Advantages</strong>: High accuracy, cleaner assemblies</li><li><strong>Best for</strong>: Reference-quality genomes, small variants</li></ul><h3><strong>Assembly Algorithms</strong></h3><h4><strong>Flye (ONT-Optimized)</strong></h4><ul><li><strong>Algorithm</strong>: Repeat graph assembly with error correction</li><li><strong>Strengths</strong>: Handles high error rates, resolves repeats effectively</li><li><strong>Parameters</strong>: Optimized for ONT raw or Guppy-basecalled reads</li><li><strong>Output</strong>: Contiguous assemblies from noisy long reads</li></ul><h4><strong>Hifiasm (HiFi-Optimized)</strong></h4><ul><li><strong>Algorithm</strong>: String graph with haplotype-aware assembly</li><li><strong>Strengths</strong>: Leverages HiFi accuracy, ultra-fast</li><li><strong>Parameters</strong>: Tuned for PacBio HiFi data</li><li><strong>Output</strong>: Near-perfect base accuracy, phasing-capable</li></ul><h3><strong>Polishing Strategies</strong></h3><h4><strong>Medaka (ONT Polishing)</strong></h4><ul><li>Neural network-based consensus from ONT reads</li><li>Corrects systematic ONT errors</li><li>Multiple rounds improve accuracy (Q30-Q40)</li><li>Essential for ONT assemblies</li></ul><h4><strong>Pilon (Short-Read Polishing)</strong></h4><ul><li>Uses high-accuracy Illumina short reads</li><li>Corrects small indels and base errors</li><li>Hybrid polishing strategy</li><li>Achieves Q50+ accuracy</li></ul><h3><strong>Scaffolding Methods</strong></h3><h4><strong>LINKS</strong></h4><ul><li>Long-range linking using long-read information</li><li>Joins contigs based on read overlap evidence</li><li>Best for improving contiguity without reference</li></ul><h4><strong>Longstitch</strong></h4><ul><li>Modular scaffolding and gap-filling</li><li>Uses long reads to span between contigs</li><li>Attempts to fill sequence gaps</li></ul><h4><strong>RagTag (Reference-Guided)</strong></h4><ul><li>Aligns contigs to related reference genome</li><li>Orders and orients based on synteny</li><li>Produces chromosome-scale scaffolds</li><li>Requires closely related reference genome</li></ul><h3><strong>Scientific Applications</strong></h3><ul><li><strong>De Novo Genome Projects</strong>: First-time genome assemblies for any organism</li><li><strong>Reference Genomes</strong>: High-quality references for model and non-model species</li><li><strong>Comparative Genomics</strong>: Compare genome structure across species</li><li><strong>Structural Variation</strong>: Identify large insertions, deletions, rearrangements</li><li><strong>Plant Genomics</strong>: Large, repeat-rich genomes benefit from long reads</li><li><strong>Microbial Genomics</strong>: Complete bacterial and fungal genomes</li><li><strong>Conservation Genomics</strong>: Assemble genomes of endangered species</li></ul><h3><strong>Input Requirements</strong></h3><p>Provide a CSV samplesheet with the following columns:</p><p><code>sample,ontreads,hifireads,ref_fasta,shortread_F,shortread_R</code></p><p>Example: <code>species1,ont_reads.fastq.gz,,,illumina_R1.fq.gz,illumina_R2.fq.gz</code></p><h4><strong>Column Descriptions</strong></h4><ul><li><strong>sample</strong>: Unique sample identifier</li><li><strong>ontreads</strong>: Oxford Nanopore long reads (FASTQ)</li><li><strong>hifireads</strong>: PacBio HiFi reads (FASTQ)</li><li><strong>ref_fasta</strong>: Reference genome for RagTag scaffolding (optional)</li><li><strong>shortread_F/R</strong>: Illumina paired-end reads for Pilon polishing (optional)</li></ul><h4><strong>Coverage Requirements</strong></h4><ul><li><strong>Minimum</strong>: 30X long-read coverage for draft assembly</li><li><strong>Recommended</strong>: 50-60X coverage for high-quality assembly</li><li><strong>Optimal</strong>: 80-100X for best contiguity and accuracy</li><li><strong>Short reads (polishing)</strong>: 50-100X Illumina coverage</li></ul><h3><strong>Main Outputs</strong></h3><ul><li><strong>Assembled Genome</strong>: FASTA file with contigs or scaffolds</li><li><strong>Assembly Graphs</strong>: GFA format showing contig connections</li><li><strong>BUSCO Results</strong>: Gene completeness percentage (aim for >90%)</li><li><strong>QUAST Report</strong>: N50, L50, total length, number of contigs</li><li><strong>Merqury QC</strong>: K-mer based quality value (QV) and completeness</li><li><strong>Coverage Plots</strong>: Depth distribution and evenness</li><li><strong>MultiQC Report</strong>: Comprehensive quality control summary</li></ul><h3><strong>Assembly Quality Metrics</strong></h3><h4><strong>Contiguity Metrics</strong></h4><ul><li><strong>N50</strong>: Half of genome in contigs this size or larger (higher is better)</li><li><strong>L50</strong>: Number of contigs needed to reach N50 (lower is better)</li><li><strong>Largest Contig</strong>: Maximum contig length</li><li><strong>Total Length</strong>: Should match expected genome size</li></ul><h4><strong>Completeness Metrics</strong></h4><ul><li><strong>BUSCO</strong>: Percentage of conserved genes found (aim for >95%)</li><li><strong>Merqury QV</strong>: Base-level accuracy (Q40 = 99.99% accuracy)</li><li><strong>K-mer Completeness</strong>: Percentage of expected k-mers present</li></ul><h4><strong>Assembly Goals</strong></h4><ul><li><strong>Draft Assembly</strong>: N50 >100 kb, BUSCO >90%</li><li><strong>High-Quality</strong>: N50 >1 Mb, BUSCO >95%, few contigs</li><li><strong>Reference-Quality</strong>: Chromosome-scale scaffolds, BUSCO >98%, QV >40</li></ul><h3><strong>Supported Genome Types</strong></h3><h4><strong>Fully Supported</strong></h4><ul><li>Haploid genomes (bacteria, fungi, haploid plants)</li><li>Diploid inbred organisms (low heterozygosity <1%)</li><li>Homozygous diploids</li></ul><h4><strong>Not Supported</strong></h4><ul><li>Highly heterozygous diploids (>2% heterozygosity)</li><li>Polyploid genomes (triploid, tetraploid, etc.)</li><li>Metagenomes (use dedicated metagenomic assemblers)</li><li>Note: Use Hifiasm phasing mode separately for heterozygous diploids</li></ul><h3><strong>Performance Expectations</strong></h3><ul><li><strong>Microbial genome (5 Mb):</strong> 1-2 hours</li><li><strong>Insect genome (100-500 Mb):</strong> 4-12 hours</li><li><strong>Fish genome (500 Mb - 1 Gb):</strong> 12-24 hours</li><li><strong>Plant genome (1-3 Gb):</strong> 1-3 days</li><li><strong>Mammalian genome (2-3 Gb):</strong> 2-4 days</li><li><em>Time varies with coverage, genome complexity, and scaffolding options</em></li></ul><h3><strong>Best Practices</strong></h3><ul><li><strong>Use Adequate Coverage</strong>: 50-100X long-read coverage for best results</li><li><strong>Check Read N50</strong>: Longer reads produce better assemblies</li><li><strong>Include Short Reads</strong>: Hybrid polishing improves accuracy significantly</li><li><strong>Use Reference for Scaffolding</strong>: RagTag dramatically improves contiguity if reference available</li><li><strong>Validate with BUSCO</strong>: Should see >90% complete single-copy orthologs</li><li><strong>Inspect Assembly Graph</strong>: Look for circularized contigs and repeats</li></ul><blockquote><p><strong>Perfect for:</strong> De Novo Genome Assembly \u2022 Reference Genome Construction \u2022 Plant Genomics \u2022 Structural Variation \u2022 Comparative Genomics \u2022 Non-Model Organisms</p></blockquote>",
  "spec": [
    {
      "type": "Stash File",
      "label": "Sample Sheet",
      "name": "input",
      "description": "CSV with columns: sample, ontreads (ONT FASTQ), hifireads (HiFi FASTQ), ref_fasta (reference for scaffolding, optional), shortread_F/R (Illumina for polishing, optional).",
      "required": true,
      "restrictions": {
        "allow_files": true,
        "allow_folders": false,
        "allowed_file_types": [
          ".csv"
        ]
      }
    },
    {
      "type": "Stash File",
      "label": "Output Directory",
      "name": "outdir",
      "description": "Directory for assembled genomes, scaffolds, QC reports (BUSCO, QUAST, Merqury), and quality visualizations.",
      "defaultValue": "./genomeassembler-results",
      "required": true,
      "restrictions": {
        "allow_files": false,
        "allow_folders": true
      }
    }
  ],
  "jobConfig": [
    {
      "type": "Select",
      "label": "Compute Resources",
      "name": "system_size",
      "hidden": false,
      "description": "Select resources based on genome size. LARGE for most genomes (100 Mb - 2 Gb). XLARGE for large or complex genomes (>2 Gb).",
      "options": [
        {
          "label": "MEDIUM (32 CPUs, 120GB RAM) - Microbial/small genomes (<100 Mb)",
          "value": "medium",
          "mapValue": {
            "nodeSize": "MEDIUM",
            "numNodes": 1,
            "withGpu": false
          }
        },
        {
          "label": "LARGE (64 CPUs, 360GB RAM) - Recommended for most genomes",
          "value": "large",
          "mapValue": {
            "nodeSize": "LARGE",
            "numNodes": 1,
            "withGpu": false
          }
        },
        {
          "label": "XLARGE (96 CPUs, 540GB RAM) - Large/complex genomes (>2 Gb)",
          "value": "xlarge",
          "mapValue": {
            "nodeSize": "XLARGE",
            "numNodes": 1,
            "withGpu": false
          }
        }
      ],
      "defaultValue": "large"
    }
  ],
  "tags": [
    {
      "id": "fb1ee42a-629a-4d99-9e7f-1da3c5f7a691",
      "name": "biology",
      "type": "field"
    },
    {
      "id": "6e4e74a4-560e-4674-95c3-60fe895b8c91",
      "name": "genomics",
      "type": "subfield"
    },
    {
      "id": "831477f4-f572-4e27-af83-037661489800",
      "name": "analysis",
      "type": "task"
    }
  ]
}