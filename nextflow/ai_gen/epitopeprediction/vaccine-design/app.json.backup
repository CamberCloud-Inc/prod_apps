{
  "name": "epitopeprediction-vaccine-design",
  "title": "Vaccine Design & Epitope Prediction",
  "description": "AI-powered epitope prediction pipeline for vaccine design and immunotherapy development. Predicts MHC-binding peptides from proteins, variants, or peptide sequences using state-of-the-art computational tools for precision immunology. Samplesheet format: `sample,alleles,mhc_class,filename`",
  "content": "<h1 class=\"heading-node\">💉 Vaccine Design & Epitope Prediction</h1><p class=\"text-node\"><strong>Accelerate Vaccine Development with AI-Powered Epitope Discovery</strong></p><p class=\"text-node\">The nf-core/epitopeprediction pipeline is a comprehensive bioinformatics workflow for identifying T-cell epitopes that bind to Major Histocompatibility Complex (MHC) molecules. This pipeline is essential for rational vaccine design, cancer immunotherapy development, and understanding immune responses to pathogens and tumor neoantigens.</p><img src=\"https://raw.githubusercontent.com/nf-core/epitopeprediction/master/docs/images/nf-core-epitopeprediction_logo_light.png\" alt=\"nf-core/epitopeprediction workflow\" width=\"600\" height=\"300\"><h2 class=\"heading-node\">🎯 What Are Epitopes and Why Do They Matter?</h2><p class=\"text-node\">Epitopes are short peptide sequences (typically 8-15 amino acids) that bind to MHC molecules and trigger T-cell immune responses. Understanding which peptides can become epitopes is crucial for:</p><ul class=\"list-node\"><li><p class=\"text-node\"><strong>💉 Vaccine Development:</strong> Identify peptides that elicit protective immunity against infectious diseases</p></li><li><p class=\"text-node\"><strong>🎗️ Cancer Immunotherapy:</strong> Discover tumor-specific neoantigens for personalized cancer vaccines</p></li><li><p class=\"text-node\"><strong>🧬 Autoimmune Disease Research:</strong> Understand self-reactive epitopes driving autoimmunity</p></li><li><p class=\"text-node\"><strong>🦠 Pathogen Surveillance:</strong> Predict immune escape variants in evolving viruses</p></li><li><p class=\"text-node\"><strong>🔬 Immunogenicity Assessment:</strong> Evaluate potential immune responses to therapeutic proteins</p></li></ul><h2 class=\"heading-node\">🧬 MHC Molecules: The Gatekeepers of Immunity</h2><h3 class=\"heading-node\">MHC Class I vs Class II</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>🔴 MHC Class I (HLA-A, HLA-B, HLA-C):</strong></p><ul class=\"list-node\"><li><p class=\"text-node\">Present peptides from intracellular proteins</p></li><li><p class=\"text-node\">Activate CD8+ cytotoxic T cells</p></li><li><p class=\"text-node\">Typical epitopes: 8-11 amino acids</p></li><li><p class=\"text-node\">Important for: Viral infections, cancer, intracellular pathogens</p></li></ul></li><li><p class=\"text-node\"><strong>🔵 MHC Class II (HLA-DR, HLA-DP, HLA-DQ):</strong></p><ul class=\"list-node\"><li><p class=\"text-node\">Present peptides from extracellular proteins</p></li><li><p class=\"text-node\">Activate CD4+ helper T cells</p></li><li><p class=\"text-node\">Typical epitopes: 12-25 amino acids</p></li><li><p class=\"text-node\">Important for: Extracellular bacteria, vaccines, antibody responses</p></li></ul></li></ul><h2 class=\"heading-node\">🤖 State-of-the-Art Prediction Tools</h2><p class=\"text-node\">This pipeline integrates multiple machine learning and AI-powered prediction algorithms for maximum accuracy:</p><h3 class=\"heading-node\">MHC Class I Predictors</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>🏆 NetMHCpan 4.1:</strong> Neural network trained on >850,000 MHC-peptide binding measurements</p><ul class=\"list-node\"><li><p class=\"text-node\">Pan-specific: Predicts binding for any HLA allele</p></li><li><p class=\"text-node\">Highest accuracy across all HLA types</p></li><li><p class=\"text-node\">Industry gold standard for epitope prediction</p></li></ul></li><li><p class=\"text-node\"><strong>🧠 MHCflurry:</strong> Deep learning model with open-source accessibility</p><ul class=\"list-node\"><li><p class=\"text-node\">Fast predictions with competitive accuracy</p></li><li><p class=\"text-node\">Trained on mass spectrometry data</p></li><li><p class=\"text-node\">Excellent for high-throughput screening</p></li></ul></li><li><p class=\"text-node\"><strong>🔬 MHCnuggets:</strong> Transfer learning approach with broad HLA coverage</p><ul class=\"list-node\"><li><p class=\"text-node\">Good for rare HLA alleles</p></li><li><p class=\"text-node\">Both Class I and Class II support</p></li></ul></li><li><p class=\"text-node\"><strong>📊 Syfpeithi:</strong> Position-specific scoring matrices from known epitopes</p><ul class=\"list-node\"><li><p class=\"text-node\">Well-established motif-based approach</p></li><li><p class=\"text-node\">Useful for validation and comparison</p></li></ul></li></ul><h3 class=\"heading-node\">MHC Class II Predictors</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>🌟 NetMHCIIpan 4.1:</strong> Pan-specific neural network for HLA-DR, DP, DQ prediction</p></li><li><p class=\"text-node\"><strong>🧪 MHCnuggets-II:</strong> Deep learning for Class II epitope discovery</p></li></ul><h2 class=\"heading-node\">🎯 Key Applications and Use Cases</h2><h3 class=\"heading-node\">💉 Infectious Disease Vaccines</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>🦠 Viral Vaccines:</strong> COVID-19, influenza, HIV, RSV, dengue, Zika</p><ul class=\"list-node\"><li><p class=\"text-node\">Identify conserved epitopes across viral strains</p></li><li><p class=\"text-node\">Design multi-epitope vaccines for broad protection</p></li><li><p class=\"text-node\">Predict immune escape variants</p></li></ul></li><li><p class=\"text-node\"><strong>🦠 Bacterial Vaccines:</strong> Tuberculosis, pneumococcus, meningococcus</p><ul class=\"list-node\"><li><p class=\"text-node\">Identify protein-based vaccine candidates</p></li><li><p class=\"text-node\">Optimize for population coverage across HLA diversity</p></li></ul></li><li><p class=\"text-node\"><strong>🦟 Parasitic Vaccines:</strong> Malaria, leishmaniasis, trypanosomiasis</p><ul class=\"list-node\"><li><p class=\"text-node\">Screen large proteomes for immunogenic peptides</p></li><li><p class=\"text-node\">Design stage-specific vaccines</p></li></ul></li></ul><h3 class=\"heading-node\">🎗️ Cancer Immunotherapy</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>🧬 Personalized Neoantigen Vaccines:</strong></p><ul class=\"list-node\"><li><p class=\"text-node\">Analyze patient tumor mutations</p></li><li><p class=\"text-node\">Predict which mutations create immunogenic neoantigens</p></li><li><p class=\"text-node\">Design patient-specific therapeutic vaccines</p></li><li><p class=\"text-node\">Prioritize mutations with highest MHC binding affinity</p></li></ul></li><li><p class=\"text-node\"><strong>🎯 Tumor-Associated Antigen (TAA) Discovery:</strong></p><ul class=\"list-node\"><li><p class=\"text-node\">Identify epitopes from cancer-testis antigens</p></li><li><p class=\"text-node\">Screen overexpressed tumor proteins</p></li><li><p class=\"text-node\">Design off-the-shelf cancer vaccines</p></li></ul></li><li><p class=\"text-node\"><strong>🧫 CAR-T and TCR-T Cell Therapy:</strong></p><ul class=\"list-node\"><li><p class=\"text-node\">Identify optimal target epitopes for T cell receptors</p></li><li><p class=\"text-node\">Predict on-target/off-tumor toxicity</p></li></ul></li></ul><h3 class=\"heading-node\">🔬 Translational Research Applications</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>💊 Biotherapeutic Immunogenicity:</strong> Predict unwanted immune responses to protein drugs</p></li><li><p class=\"text-node\"><strong>🧪 Allergen Characterization:</strong> Map allergenic epitopes for desensitization therapy</p></li><li><p class=\"text-node\"><strong>🦠 Immune Monitoring:</strong> Track T-cell responses in clinical trials</p></li><li><p class=\"text-node\"><strong>🧬 HLA-Disease Associations:</strong> Study epitopes in autoimmune diseases</p></li></ul><h2 class=\"heading-node\">📋 Input Data Types</h2><p class=\"text-node\">The pipeline accepts three types of input for maximum flexibility:</p><h3 class=\"heading-node\">1. 🧬 Protein Sequences</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Use case:</strong> Screen entire proteomes or protein databases</p></li><li><p class=\"text-node\"><strong>Format:</strong> FASTA files with protein sequences</p></li><li><p class=\"text-node\"><strong>Example:</strong> Viral proteome, bacterial antigens, tumor-associated proteins</p></li><li><p class=\"text-node\"><strong>Pipeline action:</strong> Generates all possible peptides and predicts MHC binding</p></li></ul><h3 class=\"heading-node\">2. 🧪 Variant Files (VCF)</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Use case:</strong> Neoantigen prediction from tumor mutations</p></li><li><p class=\"text-node\"><strong>Format:</strong> VCF files from variant calling pipelines</p></li><li><p class=\"text-node\"><strong>Example:</strong> Somatic mutations, germline variants, SNPs</p></li><li><p class=\"text-node\"><strong>Pipeline action:</strong> Translates variants into mutated peptides, compares to wildtype</p></li></ul><h3 class=\"heading-node\">3. 🔬 Peptide Lists</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Use case:</strong> Test specific candidate epitopes</p></li><li><p class=\"text-node\"><strong>Format:</strong> Text files with peptide sequences</p></li><li><p class=\"text-node\"><strong>Example:</strong> Known epitopes, synthesized peptides, immunopeptidomics results</p></li><li><p class=\"text-node\"><strong>Pipeline action:</strong> Direct binding prediction without peptide generation</p></li></ul><h2 class=\"heading-node\">📄 Sample Sheet Format</h2><p class=\"text-node\">Your CSV samplesheet defines samples and their HLA types:</p><pre class=\"block-node\"><code>sample,alleles,mhc_class,filename\nPatient001,HLA-A*02:01;HLA-A*24:02;HLA-B*07:02;HLA-B*44:03,I,patient001_proteins.fasta\nPatient002,HLA-A*01:01;HLA-A*03:01;HLA-B*08:01;HLA-B*35:01,I,patient002_variants.vcf\nVaccine_Design,HLA-DRB1*01:01;HLA-DRB1*15:01,II,antigen_sequences.fasta</code></pre><p class=\"text-node\"><strong>Column Descriptions:</strong></p><ul class=\"list-node\"><li><p class=\"text-node\"><strong>sample:</strong> Unique sample identifier</p></li><li><p class=\"text-node\"><strong>alleles:</strong> Semicolon-separated HLA alleles in standard nomenclature (e.g., HLA-A*02:01)</p></li><li><p class=\"text-node\"><strong>mhc_class:</strong> Either \"I\" for MHC Class I or \"II\" for MHC Class II</p></li><li><p class=\"text-node\"><strong>filename:</strong> Path to input file (FASTA, VCF, or peptide list)</p></li></ul><h3 class=\"heading-node\">🧬 HLA Typing</h3><p class=\"text-node\">Accurate HLA typing is critical for epitope prediction:</p><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Patient samples:</strong> Use clinical HLA typing (4-digit resolution minimum)</p></li><li><p class=\"text-node\"><strong>Population vaccines:</strong> Select most common alleles for target population</p><ul class=\"list-node\"><li><p class=\"text-node\">Caucasian: HLA-A*02:01, A*01:01, A*03:01, B*07:02, B*08:01</p></li><li><p class=\"text-node\">Asian: HLA-A*24:02, A*02:01, A*11:01, B*40:01, B*46:01</p></li><li><p class=\"text-node\">African: HLA-A*02:01, A*30:01, A*23:01, B*58:01, B*53:01</p></li></ul></li><li><p class=\"text-node\"><strong>NGS-based HLA typing:</strong> Use tools like OptiType, HLA-HD, or seq2HLA</p></li></ul><h2 class=\"heading-node\">📊 Comprehensive Output Files</h2><h3 class=\"heading-node\">Prediction Results</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>📄 TSV files:</strong> Tab-separated prediction tables with:</p><ul class=\"list-node\"><li><p class=\"text-node\">Peptide sequence</p></li><li><p class=\"text-node\">HLA allele</p></li><li><p class=\"text-node\">Binding affinity (IC50 nM)</p></li><li><p class=\"text-node\">Percentile rank</p></li><li><p class=\"text-node\">Strong/weak binder classification</p></li><li><p class=\"text-node\">Source protein and position</p></li></ul></li><li><p class=\"text-node\"><strong>📊 HTML reports:</strong> Interactive visualizations of top-ranked epitopes</p></li><li><p class=\"text-node\"><strong>🎯 JSON output:</strong> Machine-readable results for downstream analysis</p></li></ul><h3 class=\"heading-node\">Prioritized Epitope Lists</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>🏆 Strong binders:</strong> Peptides with IC50 < 50 nM (highest priority)</p></li><li><p class=\"text-node\"><strong>⭐ Weak binders:</strong> Peptides with IC50 < 500 nM (secondary targets)</p></li><li><p class=\"text-node\"><strong>📈 Ranked by affinity:</strong> Sorted by predicted binding strength</p></li><li><p class=\"text-node\"><strong>🎯 Consensus predictions:</strong> Epitopes predicted by multiple tools</p></li></ul><h3 class=\"heading-node\">Annotation and Metadata</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>🧬 Protein annotations:</strong> Gene names, protein IDs, functional domains</p></li><li><p class=\"text-node\"><strong>🔬 Variant context:</strong> Mutation type, amino acid change, allele frequency</p></li><li><p class=\"text-node\"><strong>📚 Known epitope database matches:</strong> Cross-reference with IEDB</p></li><li><p class=\"text-node\"><strong>🌍 Population coverage:</strong> HLA allele frequencies in different populations</p></li></ul><h3 class=\"heading-node\">Quality Control</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>✅ Input validation:</strong> Verification of HLA alleles and input format</p></li><li><p class=\"text-node\"><strong>📊 Prediction statistics:</strong> Number of peptides tested, strong binders found</p></li><li><p class=\"text-node\"><strong>🎯 Tool comparison:</strong> Agreement between different prediction algorithms</p></li><li><p class=\"text-node\"><strong>📈 MultiQC report:</strong> Comprehensive pipeline execution summary</p></li></ul><h2 class=\"heading-node\">🔬 Interpreting Results and Next Steps</h2><h3 class=\"heading-node\">High-Priority Epitope Candidates</h3><ul class=\"list-node\"><li><p class=\"text-node\">✅ IC50 < 50 nM (strong binder across multiple tools)</p></li><li><p class=\"text-node\">✅ Predicted by consensus of 2+ algorithms</p></li><li><p class=\"text-node\">✅ Binds to multiple HLA alleles (broad coverage)</p></li><li><p class=\"text-node\">✅ From conserved protein regions (for pathogen vaccines)</p></li><li><p class=\"text-node\">✅ From high-expression genes (for cancer vaccines)</p></li></ul><h3 class=\"heading-node\">Experimental Validation Methods</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>🧪 MHC-peptide binding assays:</strong> In vitro confirmation of predicted binding</p></li><li><p class=\"text-node\"><strong>🔬 T-cell activation assays:</strong> Test if peptides activate T-cells (IFN-γ ELISPOT)</p></li><li><p class=\"text-node\"><strong>🧬 Tetramer staining:</strong> Detect antigen-specific T-cells</p></li><li><p class=\"text-node\"><strong>🦠 Immunization studies:</strong> Test vaccine efficacy in animal models</p></li><li><p class=\"text-node\"><strong>👥 Clinical immunogenicity:</strong> Measure T-cell responses in vaccinated individuals</p></li></ul><h3 class=\"heading-node\">Vaccine Design Strategies</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>💉 Multi-epitope vaccines:</strong> Combine 10-30 top epitopes for broad immunity</p></li><li><p class=\"text-node\"><strong>🧬 DNA/RNA vaccines:</strong> Encode epitopes in genetic constructs</p></li><li><p class=\"text-node\"><strong>🔬 Peptide vaccines:</strong> Synthesize and formulate epitope peptides</p></li><li><p class=\"text-node\"><strong>🦠 Viral vector vaccines:</strong> Express epitopes using viral delivery</p></li><li><p class=\"text-node\"><strong>🧪 Dendritic cell vaccines:</strong> Load DCs with epitope peptides</p></li></ul><h2 class=\"heading-node\">🌍 Population Coverage Optimization</h2><p class=\"text-node\">For public health vaccines, maximize population coverage by:</p><ul class=\"list-node\"><li><p class=\"text-node\">📊 <strong>HLA diversity:</strong> Select epitopes binding to common HLA alleles</p></li><li><p class=\"text-node\">🌎 <strong>Geographic considerations:</strong> Account for HLA allele frequency differences</p></li><li><p class=\"text-node\">🎯 <strong>Coverage analysis:</strong> Aim for >90% population coverage with epitope cocktail</p></li><li><p class=\"text-node\">🧬 <strong>Class I + Class II:</strong> Include both CD8+ and CD4+ epitopes for complete immunity</p></li></ul><h2 class=\"heading-node\">⚙️ Pipeline Technical Details</h2><ul class=\"list-node\"><li><p class=\"text-node\"><strong>🐍 Prediction engines:</strong> NetMHCpan 4.1, NetMHCIIpan 4.1, MHCflurry, MHCnuggets, Syfpeithi</p></li><li><p class=\"text-node\"><strong>🔧 Peptide generation:</strong> Sliding window approach (8-11mer for Class I, 15-25mer for Class II)</p></li><li><p class=\"text-node\"><strong>🧬 Variant processing:</strong> VCF parsing and protein translation</p></li><li><p class=\"text-node\"><strong>📊 Annotation:</strong> UniProt, Ensembl, IEDB cross-referencing</p></li><li><p class=\"text-node\"><strong>✅ Quality control:</strong> Input validation, HLA allele checking, format verification</p></li><li><p class=\"text-node\"><strong>🐳 Containerization:</strong> Docker/Singularity for reproducibility</p></li></ul><h2 class=\"heading-node\">🎯 Expected Runtime and Resources</h2><ul class=\"list-node\"><li><p class=\"text-node\"><strong>⏱️ Small dataset (1-10 proteins):</strong> 15-30 minutes</p></li><li><p class=\"text-node\"><strong>⏱️ Medium dataset (100-1000 proteins):</strong> 1-3 hours</p></li><li><p class=\"text-node\"><strong>⏱️ Large dataset (full proteome):</strong> 3-8 hours</p></li><li><p class=\"text-node\"><strong>💾 Storage:</strong> 1-10 GB per analysis depending on input size</p></li><li><p class=\"text-node\"><strong>🖥️ Resources:</strong> Scales automatically with data size</p></li></ul><h2 class=\"heading-node\">📚 Scientific Background and References</h2><p class=\"text-node\">Epitope prediction has been revolutionized by AI and machine learning:</p><ul class=\"list-node\"><li><p class=\"text-node\">🏆 <strong>2025 breakthrough:</strong> >650,000 HLA-peptide interactions dataset achieved unprecedented accuracy</p></li><li><p class=\"text-node\">🧠 <strong>Deep learning:</strong> Neural networks trained on mass spectrometry immunopeptidomics</p></li><li><p class=\"text-node\">🎯 <strong>Pan-specific prediction:</strong> Accurate predictions for any HLA allele, including rare variants</p></li><li><p class=\"text-node\">🔬 <strong>Clinical validation:</strong> Used in FDA-approved cancer vaccine trials</p></li></ul><p class=\"text-node\"><strong>Perfect for Research in:</strong> Vaccine development • Cancer immunotherapy • Precision medicine • Infectious disease • Immunology • Computational biology • Translational research • Drug discovery • Neoantigen prediction • HLA immunogenomics</p><p class=\"text-node\">Built with <a class=\"link\" href=\"https://www.nextflow.io/\" target=\"_blank\">Nextflow</a> • Powered by <a class=\"link\" href=\"https://nf-co.re/epitopeprediction\" target=\"_blank\">nf-core/epitopeprediction v3.0.0</a> • Containerized execution • Reproducible science</p>",
  "imageUrl": "https://raw.githubusercontent.com/nf-core/epitopeprediction/master/docs/images/nf-core-epitopeprediction_logo_light.png",
  "command": "export NXF_CACHE_DIR=/camber_work/temp/.nextflow; export NXF_LOG_FILE=/home/camber/jobs/${JOB_ID}/outputs/nextflow.log; nextflow run nf-core/epitopeprediction -r 3.0.0 --input ${input} --outdir ${outdir} --max_memory 128.GB --max_cpus 32 -c /etc/mpi/nextflow.camber.config -ansi-log false -profile k8s",
  "engineType": "NEXTFLOW",
  "jobConfig": [
    {
      "type": "Select",
      "label": "System Size",
      "name": "system_size",
      "hidden": true,
      "description": "Select compute resources based on dataset size. Start with XSMALL for testing.",
      "options": [
        {
          "label": "XSMALL (4 CPUs, 15GB RAM) - Testing/Small peptide lists",
          "value": "xsmall",
          "mapValue": {
            "nodeSize": "XSMALL",
            "numNodes": 1,
            "withGpu": false
          }
        },
        {
          "label": "SMALL (8 CPUs, 30GB RAM) - Single protein/few variants",
          "value": "small",
          "mapValue": {
            "nodeSize": "SMALL",
            "numNodes": 1,
            "withGpu": false
          }
        },
        {
          "label": "MEDIUM (32 CPUs, 120GB RAM) - Multiple proteins/moderate VCF",
          "value": "medium",
          "mapValue": {
            "nodeSize": "MEDIUM",
            "numNodes": 1,
            "withGpu": false
          }
        },
        {
          "label": "LARGE (64 CPUs, 360GB RAM) - Full proteome/large VCF files",
          "value": "large",
          "mapValue": {
            "nodeSize": "LARGE",
            "numNodes": 1,
            "withGpu": false
          }
        }
      ],
      "defaultValue": "xsmall"
    }
  ],
  "spec": [
    {
      "type": "Stash File",
      "label": "Sample Sheet",
      "name": "input",
      "description": "CSV file with columns: sample, alleles, mhc_class, filename. Each row represents a sample with HLA alleles and input file (FASTA proteins, VCF variants, or peptide list). Alleles must be semicolon-separated (e.g., HLA-A*02:01;HLA-B*07:02).",
      "defaultValue": "https://raw.githubusercontent.com/nf-core/test-datasets/epitopeprediction/testdata/sample_sheet.csv",
      "required": true,
      "restrictions": {
        "allow_files": true,
        "allow_folders": false,
        "allowed_file_types": [
          ".csv"
        ]
      }
    },
    {
      "type": "Stash File",
      "label": "Output Directory",
      "name": "outdir",
      "description": "Directory where epitope prediction results, rankings, and reports will be saved. Results include binding predictions, prioritized epitope lists, and quality control reports.",
      "defaultValue": "./epitopeprediction-results",
      "required": true,
      "restrictions": {
        "allow_files": false,
        "allow_folders": true,
        "allowed_file_types": []
      }
    }
  ],
  "tags": [
    {
      "id": "fb1ee42a-629a-4d99-9e7f-1da3c5f7a691",
      "name": "biology",
      "type": "field"
    },
    {
      "id": "6e4e74a4-560e-4674-95c3-60fe895b8c91",
      "name": "genomics",
      "type": "subfield"
    },
    {
      "id": "831477f4-f572-4e27-af83-037661489800",
      "name": "analysis",
      "type": "task"
    }
  ]
}
