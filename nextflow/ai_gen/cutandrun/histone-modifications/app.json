{
    "name": "cutandrun-histone-modifications",
    "title": "CUT&RUN: Histone Modification Mapping",
    "description": "Map histone modifications with CUT&RUN for ultra-clean epigenetic profiling with dramatically lower background than ChIP-seq. Optimized for epigenetics researchers studying chromatin states and gene regulation.",
    "content": "<h1 class=\"heading-node\">\ud83e\uddec CUT&RUN: High-Resolution Histone Modification Mapping</h1><p class=\"text-node\"><strong>What is CUT&RUN?</strong></p><p class=\"text-node\">CUT&RUN (Cleavage Under Targets and Release Using Nuclease) is a revolutionary epigenetic profiling technique that maps histone modifications with exceptional signal-to-noise ratio. Unlike traditional ChIP-seq, CUT&RUN works in situ, producing cleaner data with less background noise and requiring far fewer cells.</p><img src=\"https://raw.githubusercontent.com/nf-core/cutandrun/3.2.2/docs/images/cutandrun_workflow.png\" alt=\"nf-core/cutandrun workflow\" title=\"CUT&RUN Pipeline Workflow\" width=\"800\" height=\"500\"><h2 class=\"heading-node\">\ud83d\udd2c Why CUT&RUN for Histone Modifications?</h2><p class=\"text-node\"><strong>Revolutionary Advantages Over ChIP-seq:</strong></p><ul><li><strong>\ud83d\udcc9 Ultra-Low Background:</strong> In situ cleavage eliminates non-specific DNA fragments, providing cleaner signal</li><li><strong>\ud83c\udfaf Higher Resolution:</strong> Direct chromatin cleavage enables base-pair resolution mapping of histone marks</li><li><strong>\ud83d\udca7 Less Material Required:</strong> Works with 100-1000x fewer cells than ChIP-seq (as few as 100 cells)</li><li><strong>\u26a1 Faster Protocol:</strong> Complete in one day vs. multi-day ChIP-seq protocols</li><li><strong>\ud83e\uddea Better Reproducibility:</strong> Reduced technical variability and batch effects</li></ul><h2 class=\"heading-node\">\ud83c\udfaf Ideal for Studying Histone Marks</h2><p class=\"text-node\"><strong>Common Histone Modifications Profiled:</strong></p><ul><li><strong>H3K4me3:</strong> Active promoters and transcription start sites - marks genes ready for expression</li><li><strong>H3K27me3:</strong> Repressive chromatin and Polycomb silencing - identifies silenced developmental genes</li><li><strong>H3K27ac:</strong> Active enhancers and regulatory elements - pinpoints cell-type specific gene control</li><li><strong>H3K9me3:</strong> Heterochromatin and repeat silencing - reveals constitutively repressed regions</li><li><strong>H3K36me3:</strong> Actively transcribed gene bodies - tracks elongating RNA polymerase</li><li><strong>H3K4me1:</strong> Poised and active enhancers - identifies distal regulatory elements</li></ul><h2 class=\"heading-node\">\ud83e\uddea How CUT&RUN Works</h2><p class=\"text-node\"><strong>The CUT&RUN Process:</strong></p><ol><li><strong>Cell Binding:</strong> Live cells are bound to magnetic beads and permeabilized</li><li><strong>Antibody Targeting:</strong> Specific antibody binds to target histone modification</li><li><strong>pA-MNase Recruitment:</strong> Protein A-Micrococcal Nuclease fusion protein binds antibody</li><li><strong>Controlled Cleavage:</strong> Calcium activation triggers local DNA cleavage at target sites</li><li><strong>Fragment Release:</strong> Small DNA fragments are released and isolated while bulk chromatin stays intact</li><li><strong>Library Preparation:</strong> Released fragments are sequenced to reveal histone modification locations</li></ol><h2 class=\"heading-node\">\ud83d\udccb Sample Sheet: Your Experiment Design</h2><p class=\"text-node\"><strong>What is the Sample Sheet?</strong></p><p class=\"text-node\">The sample sheet (CSV file) defines your experimental design, linking sequencing files to biological samples and specifying controls. Proper IgG controls are essential for accurate peak calling.</p><p class=\"text-node\"><strong>Example for Histone Mark Profiling:</strong></p><pre style=\"background-color: #f8f8f8; padding: 10px; border-radius: 5px; font-family: monospace;\">group,replicate,fastq_1,fastq_2,control\nh3k27me3,1,H3K27me3_rep1_R1.fastq.gz,H3K27me3_rep1_R2.fastq.gz,igg_ctrl\nh3k27me3,2,H3K27me3_rep2_R1.fastq.gz,H3K27me3_rep2_R2.fastq.gz,igg_ctrl\nh3k4me3,1,H3K4me3_rep1_R1.fastq.gz,H3K4me3_rep1_R2.fastq.gz,igg_ctrl\nh3k4me3,2,H3K4me3_rep2_R1.fastq.gz,H3K4me3_rep2_R2.fastq.gz,igg_ctrl\nigg_ctrl,1,IgG_rep1_R1.fastq.gz,IgG_rep1_R2.fastq.gz,\nigg_ctrl,2,IgG_rep2_R1.fastq.gz,IgG_rep2_R2.fastq.gz,</pre><p class=\"text-node\"><strong>Key Design Principles:</strong></p><ul><li><strong>Biological Replicates:</strong> 2-3 replicates per condition ensure statistical power and reproducibility</li><li><strong>IgG Controls:</strong> Non-specific antibody controls distinguish true signal from background binding</li><li><strong>Group Naming:</strong> Use clear histone mark names (h3k27me3, h3k4me3, h3k27ac, etc.)</li><li><strong>Consistent Controls:</strong> Share control samples across marks from same cell type/condition</li></ul><h2 class=\"heading-node\">\u2699\ufe0f Analysis Parameters</h2><ul><li><strong>\ud83d\udcc1 Output Directory:</strong> Organized results including peaks, bigWig tracks, QC reports, and annotations. The pipeline creates a comprehensive output structure with all analysis files for easy downstream analysis and data sharing.</li><li><strong>\ud83c\udfaf Peak Caller:</strong> <strong>SEACR</strong> (Sparse Enrichment Analysis for CUT&RUN) is optimized specifically for CUT&RUN data and recommended for histone modifications. <strong>MACS2</strong> can also be used with <strong>--macs2_narrow_peak</strong> for sharp marks (H3K4me3) or without for broad domains (H3K27me3).</li><li><strong>\ud83d\udd2c IgG Normalization:</strong> When enabled (<strong>--use_control true</strong>), peak calling uses IgG control samples to establish background levels and identify true enrichment. This is essential for accurate histone modification mapping and reduces false positives.</li><li><strong>\ud83d\udcca Minimum Alignment Rate:</strong> Quality control threshold for successful alignments. <strong>70%</strong> is recommended for mammalian genomes. Lower rates may indicate adapter contamination or wrong reference genome selection.</li><li><strong>\ud83e\uddec Spike-in Normalization:</strong> For quantitative comparisons, add spike-in genome (typically E.coli or Drosophila) to normalize for cell number and antibody efficiency differences between samples. Requires <strong>--spikein_fasta</strong> and <strong>--spikein_bowtie2</strong> parameters.</li><li><strong>\ud83c\udfa8 Consensus Peaks:</strong> Creates high-confidence peak sets by requiring peaks in multiple replicates. Choose <strong>by group</strong> for per-mark consensus or <strong>all samples</strong> for pan-experiment consensus peaks.</li><li><strong>\ud83d\uddfa\ufe0f Fragment Size:</strong> Expected DNA fragment size after MNase digestion. <strong>120bp</strong> is typical for nucleosome-bound fragments. Adjust based on your experimental fragment distribution from bioanalyzer/TapeStation QC.</li><li><strong>\ud83e\uddec Reference Genome:</strong> Choose your species and build. Human <strong>GRCh38</strong> and mouse <strong>GRCm39</strong> are recommended for most studies. Correct genome version is critical for accurate peak annotation and gene assignment.</li></ul><h2 class=\"heading-node\">\ud83d\udcca Your Results: Comprehensive Output</h2><h3 class=\"heading-node\">Peak Calls and Enrichment</h3><ul><li><strong>\ud83c\udfaf Peak BED Files:</strong> Genomic coordinates of histone modification enrichment for each mark and replicate</li><li><strong>\ud83d\udcc8 Consensus Peaks:</strong> High-confidence peaks reproducible across biological replicates</li><li><strong>\ud83d\udcca BigWig Tracks:</strong> Normalized coverage tracks for genome browser visualization in IGV or UCSC</li><li><strong>\ud83d\udd22 Peak Statistics:</strong> Peak counts, widths, and enrichment scores for each histone mark</li></ul><h3 class=\"heading-node\">Quality Control Reports</h3><ul><li><strong>\ud83d\udcc4 MultiQC Report:</strong> Comprehensive HTML dashboard with alignment rates, duplication levels, and fragment sizes</li><li><strong>\ud83d\udcc8 Alignment Metrics:</strong> Bowtie2 mapping statistics and filtering results per sample</li><li><strong>\ud83d\udd0d Fragment Analysis:</strong> Fragment size distributions confirming proper nucleosome positioning</li><li><strong>\ud83d\udcca Replicate Correlation:</strong> Pearson correlation heatmaps showing biological replicate reproducibility</li></ul><h3 class=\"heading-node\">Biological Annotations</h3><ul><li><strong>\ud83e\uddec Gene Annotations:</strong> Peaks annotated to nearest genes with promoter/enhancer classifications</li><li><strong>\ud83c\udfa8 Chromatin States:</strong> Integration with chromatin state models if provided</li><li><strong>\ud83d\udccd Genomic Feature Distribution:</strong> Peak overlap with promoters, exons, introns, and intergenic regions</li><li><strong>\ud83d\udd2c Motif Analysis:</strong> Enriched transcription factor binding motifs within peaks (optional)</li></ul><h3 class=\"heading-node\">Comparative Analysis</h3><ul><li><strong>\ud83d\udcca Differential Binding:</strong> Statistical comparisons between conditions or cell types (if specified)</li><li><strong>\ud83c\udfaf Overlap Analysis:</strong> Co-localization of different histone marks (bivalent domains, active vs repressive)</li><li><strong>\ud83d\uddfa\ufe0f IGV Sessions:</strong> Pre-configured genome browser sessions for immediate visualization</li></ul><h2 class=\"heading-node\">\ud83d\udd2c Scientific Applications</h2><p class=\"text-node\"><strong>Perfect for Research in:</strong></p><ul><li><strong>\ud83e\uddec Developmental Biology:</strong> Track chromatin changes during differentiation and cell fate decisions</li><li><strong>\ud83e\ude7a Cancer Epigenetics:</strong> Identify aberrant histone modifications in cancer cells vs normal tissue</li><li><strong>\ud83e\udde0 Neuroscience:</strong> Profile neuronal chromatin states and activity-dependent histone changes</li><li><strong>\ud83d\udd2c Stem Cell Biology:</strong> Map pluripotency-associated chromatin marks and reprogramming dynamics</li><li><strong>\ud83e\uddea Drug Discovery:</strong> Assess epigenetic drug effects on histone modification landscapes</li><li><strong>\ud83c\udf31 Plant Biology:</strong> Study chromatin regulation in plant development and stress responses</li></ul><h3 class=\"heading-node\">Technical Information</h3><p class=\"text-node\">Built with <a class=\"link\" href=\"https://www.nextflow.io/\">Nextflow</a> workflow management \u2022 Powered by <a class=\"link\" href=\"https://nf-co.re/cutandrun/3.2.2/\">nf-core/cutandrun v3.2.2</a> \u2022 Containerized with Docker/Singularity \u2022 Continuous integration tested</p><p class=\"text-node\">Pipeline developed by the <a class=\"link\" href=\"https://nf-co.re/\">nf-core community</a> \u2022 Documentation available at <a class=\"link\" href=\"https://nf-co.re/cutandrun/3.2.2/docs/usage/\">nf-co.re</a> \u2022 Licensed under MIT</p><p class=\"text-node\"><strong>Key References:</strong></p><ul><li>Skene & Henikoff (2017). <em>An efficient targeted nuclease strategy for high-resolution mapping of DNA binding sites.</em> eLife</li><li>Meers et al. (2019). <em>Peak calling by Sparse Enrichment Analysis for CUT&RUN chromatin profiling.</em> Epigenetics & Chromatin</li></ul>",
    "imageUrl": "https://raw.githubusercontent.com/nf-core/cutandrun/3.2.2/docs/images/nf-core-cutandrun_logo_light.png",
    "command": "mkdir -p ${outdir} && cd ${outdir} && rm -rf prod_apps && git clone https://github.com/CamberCloud-Inc/prod_apps.git && cp prod_apps/nextflow/cutandrun/histone-modifications/histone-cutandrun.config ./ && rm -rf prod_apps && export NXF_CACHE_DIR=/camber_work/temp/.nextflow; export NXF_LOG_FILE=/home/camber/jobs/${JOB_ID}/outputs/nextflow.log; PEAK_CALLER_FLAG=$([ \"${peakcaller}\" != \"seacr,macs2\" ] && echo \"--peakcaller ${peakcaller}\" || echo \"--peakcaller seacr,macs2\"); NARROW_PEAK_FLAG=$([ \"${macs2_narrow_peak_flag}\" = \"--macs2_narrow_peak\" ] && echo \"--macs2_narrow_peak\" || echo \"\"); CONTROL_FLAG=$([ \"${use_control_flag}\" = \"--use_control\" ] && echo \"--use_control\" || echo \"\"); nextflow run nf-core/cutandrun -r 3.2.2 --input ${samplesheet_location} --outdir results --genome ${genome} $PEAK_CALLER_FLAG $NARROW_PEAK_FLAG $CONTROL_FLAG --minimum_alignment_q_score ${min_alignment_q} --fragment_size ${fragment_size} --max_time 99.h -c /etc/mpi/nextflow.camber.config -c histone-cutandrun.config -ansi-log false -profile k8s",
    "engineType": "NEXTFLOW",
    "jobConfig": [
        {
            "type": "Select",
            "label": "System Size",
            "name": "system_size",
            "hidden": true,
            "description": "Select compute resources. Start with XSMALL for testing, scale up for production data.",
            "options": [
                {
                    "label": "XSMALL (4 CPUs, 15GB RAM) - Testing/nf-core test data",
                    "value": "xsmall",
                    "mapValue": {
                        "nodeSize": "XSMALL",
                        "numNodes": 1,
                        "withGpu": false
                    }
                },
                {
                    "label": "SMALL (8 CPUs, 30GB RAM) - Small datasets (1-3 samples)",
                    "value": "small",
                    "mapValue": {
                        "nodeSize": "SMALL",
                        "numNodes": 1,
                        "withGpu": false
                    }
                },
                {
                    "label": "MEDIUM (32 CPUs, 120GB RAM) - Standard datasets (5-20 samples)",
                    "value": "medium",
                    "mapValue": {
                        "nodeSize": "MEDIUM",
                        "numNodes": 1,
                        "withGpu": false
                    }
                },
                {
                    "label": "LARGE (64 CPUs, 360GB RAM) - Large datasets (20-50 samples)",
                    "value": "large",
                    "mapValue": {
                        "nodeSize": "LARGE",
                        "numNodes": 1,
                        "withGpu": false
                    }
                }
            ],
            "defaultValue": "xsmall"
        }
    ],
    "spec": [
        {
            "type": "Stash File",
            "label": "Sample Sheet",
            "name": "samplesheet_location",
            "description": "CSV file defining your experiment: columns group, replicate, fastq_1, fastq_2, control",
            "defaultValue": "https://raw.githubusercontent.com/nf-core/test-datasets/cutandrun/samplesheet/v3.0/samplesheet_test.csv",
            "hidden": false,
            "required": true,
            "disabled": false,
            "restrictions": {
                "allow_files": true,
                "allow_folders": false,
                "allowed_file_types": [
                    "csv"
                ]
            }
        },
        {
            "type": "Stash File",
            "label": "Output Directory",
            "name": "outdir",
            "description": "Directory for all analysis results, peaks, tracks, and reports",
            "defaultValue": "./results",
            "hidden": false,
            "required": false,
            "disabled": false,
            "restrictions": {
                "allow_files": false,
                "allow_folders": true,
                "allowed_file_types": []
            }
        },
        {
            "type": "Select",
            "label": "Peak Caller",
            "name": "peakcaller",
            "description": "Algorithm for identifying histone modification peaks. SEACR is optimized for CUT&RUN data.",
            "defaultValue": "seacr,macs2",
            "hidden": false,
            "required": false,
            "disabled": false,
            "options": [
                {
                    "label": "SEACR + MACS2 (Recommended - run both)",
                    "value": "seacr,macs2"
                },
                {
                    "label": "SEACR only (CUT&RUN optimized)",
                    "value": "seacr"
                },
                {
                    "label": "MACS2 only (ChIP-seq standard)",
                    "value": "macs2"
                }
            ]
        },
        {
            "type": "Select",
            "label": "MACS2 Peak Type",
            "name": "macs2_narrow_peak_flag",
            "description": "Peak calling mode for MACS2. Use narrow peaks for sharp marks (H3K4me3), broad for domains (H3K27me3).",
            "defaultValue": "broad_peaks",
            "hidden": false,
            "required": false,
            "disabled": false,
            "options": [
                {
                    "label": "Broad peaks (H3K27me3, H3K9me3, H3K36me3)",
                    "value": "broad_peaks"
                },
                {
                    "label": "Narrow peaks (H3K4me3, H3K27ac, H3K4me1)",
                    "value": "--macs2_narrow_peak"
                }
            ]
        },
        {
            "type": "Select",
            "label": "Use IgG Controls",
            "name": "use_control_flag",
            "description": "Enable IgG control normalization for background subtraction and improved peak calling accuracy.",
            "defaultValue": "--use_control",
            "hidden": false,
            "required": false,
            "disabled": false,
            "options": [
                {
                    "label": "Use IgG controls (Recommended)",
                    "value": "--use_control"
                },
                {
                    "label": "No control normalization",
                    "value": "no_control"
                }
            ]
        },
        {
            "type": "Input",
            "label": "Minimum Alignment Quality Score",
            "name": "min_alignment_q",
            "description": "Minimum mapping quality score for filtering alignments (0-40). Default 20 balances sensitivity and specificity.",
            "defaultValue": "20",
            "hidden": false,
            "required": false,
            "disabled": false,
            "validation": {
                "type": "number",
                "min": 0,
                "max": 40
            }
        },
        {
            "type": "Input",
            "label": "Fragment Size (bp)",
            "name": "fragment_size",
            "description": "Expected DNA fragment size for analysis. 120bp is typical for nucleosome-bound fragments.",
            "defaultValue": "120",
            "hidden": false,
            "required": false,
            "disabled": false,
            "validation": {
                "type": "number",
                "min": 50,
                "max": 500
            }
        },
        {
            "type": "Select",
            "label": "Reference Genome",
            "name": "genome",
            "description": "Reference genome assembly for alignment and peak annotation. Choose the appropriate build for your species.",
            "defaultValue": "GRCh38",
            "hidden": false,
            "required": true,
            "disabled": false,
            "options": [
                {
                    "label": "Human GRCh38 (NCBI) [Recommended]",
                    "value": "GRCh38"
                },
                {
                    "label": "Human GRCh37 (Ensembl)",
                    "value": "GRCh37"
                },
                {
                    "label": "Human hg38 (UCSC)",
                    "value": "hg38"
                },
                {
                    "label": "Human hg19 (UCSC)",
                    "value": "hg19"
                },
                {
                    "label": "Mouse GRCm38 (Ensembl)",
                    "value": "GRCm38"
                },
                {
                    "label": "Mouse GRCm39 (Ensembl)",
                    "value": "GRCm39"
                },
                {
                    "label": "Mouse mm10 (UCSC)",
                    "value": "mm10"
                },
                {
                    "label": "Mouse mm39 (UCSC)",
                    "value": "mm39"
                },
                {
                    "label": "Rat Rnor_6.0 (Ensembl)",
                    "value": "Rnor_6.0"
                },
                {
                    "label": "Zebrafish GRCz10 (Ensembl)",
                    "value": "GRCz10"
                },
                {
                    "label": "Zebrafish GRCz11 (Ensembl)",
                    "value": "GRCz11"
                },
                {
                    "label": "Fly BDGP6 (Ensembl)",
                    "value": "BDGP6"
                },
                {
                    "label": "C. elegans WBcel235 (Ensembl)",
                    "value": "WBcel235"
                },
                {
                    "label": "Arabidopsis TAIR10 (Ensembl)",
                    "value": "TAIR10"
                },
                {
                    "label": "Yeast R64-1-1 (Ensembl)",
                    "value": "R64-1-1"
                }
            ]
        }
    ],
    "tags": [
        {
            "id": "fb1ee42a-629a-4d99-9e7f-1da3c5f7a691",
            "name": "biology",
            "type": "field"
        },
        {
            "id": "6e4e74a4-560e-4674-95c3-60fe895b8c91",
            "name": "genomics",
            "type": "subfield"
        },
        {
            "id": "831477f4-f572-4e27-af83-037661489800",
            "name": "analysis",
            "type": "task"
        }
    ]
}