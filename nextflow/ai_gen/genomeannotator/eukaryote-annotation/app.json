{
  "name": "genomeannotator-eukaryote-annotation",
  "title": "Eukaryotic Gene Annotation",
  "description": "Comprehensive annotation pipeline for eukaryotic genomes with focus on metazoans. Integrates protein and transcript evidence, performs ab initio prediction with AUGUSTUS and PASA, and generates consensus gene models using EvidenceModeler. Essential for genome projects and comparative genomics. Samplesheet format: `counts,lengths,exon`",
  "version": "1.0.0",
  "engineType": "NEXTFLOW",
  "command": "nextflow run nf-core/genomeannotator --input ${input} --outdir ${outdir} -r dev ",
  "imageUrl": "https://raw.githubusercontent.com/nf-core/genomeannotator/master/docs/images/nf-core-genomeannotator_logo_light.png",
  "content": "<h2><strong>Genome Annotator - Eukaryotic Gene Annotation</strong></h2><p>A comprehensive bioinformatics pipeline for annotating eukaryotic genomes, with primary focus on metazoans (animals). Identifies gene structures, predicts coding sequences, and integrates multiple lines of evidence to produce high-quality consensus gene annotations.</p><h3><strong>What is Genome Annotation?</strong></h3><blockquote><p><strong>Genome annotation</strong> is the process of identifying functional elements in DNA sequences, including genes, regulatory regions, and non-coding RNAs. For protein-coding genes, annotation defines exon-intron boundaries, coding sequences, and UTRs - transforming raw genome assemblies into biologically meaningful information.</p></blockquote><h3><strong>Key Features</strong></h3><ul><li><strong>Multi-Evidence Integration</strong>: Combines protein homology, RNA-seq transcripts, and ab initio predictions</li><li><strong>AUGUSTUS Prediction</strong>: State-of-the-art ab initio gene prediction for eukaryotes</li><li><strong>PASA Pipeline</strong>: Transcript-based annotation from RNA-seq and ESTs</li><li><strong>EvidenceModeler Consensus</strong>: Weighted integration of all evidence sources</li><li><strong>Optional Trinity Assembly</strong>: De novo transcriptome assembly from RNA-seq</li><li><strong>Optional Annotation Transfer</strong>: Map annotations from related genomes using Satsuma2</li><li><strong>Quality Control</strong>: Comprehensive assessment and reporting</li></ul><h3><strong>Pipeline Workflow</strong></h3><ol><li><strong>Assembly Preprocessing</strong>: Filter and clean genome contigs, assess quality</li><li><strong>Evidence Alignment</strong>: Map proteins and transcripts to genome using BLAST/GMAP</li><li><strong>Ab Initio Prediction</strong>: Predict genes with AUGUSTUS using species-specific training</li><li><strong>Transcript Assembly (Optional)</strong>: Assemble full-length transcripts with PASA from RNA-seq</li><li><strong>Evidence Integration</strong>: Combine all evidence with weighted consensus in EvidenceModeler</li><li><strong>Annotation Transfer (Optional)</strong>: Map genes from closely related genomes</li><li><strong>Gene Model Construction</strong>: Generate final gene structures (exons, introns, UTRs)</li><li><strong>Quality Assessment</strong>: Evaluate completeness with BUSCO, generate reports</li></ol><h3><strong>Evidence Types</strong></h3><h4><strong>Protein Homology Evidence</strong></h4><ul><li>Protein sequences from related species</li><li>UniProt/RefSeq databases</li><li>Conserved protein domains</li><li>Provides evolutionary support for gene structures</li></ul><h4><strong>Transcript Evidence</strong></h4><ul><li>RNA-seq reads assembled into transcripts</li><li>ESTs (expressed sequence tags)</li><li>Full-length cDNAs</li><li>Direct experimental validation of gene expression</li></ul><h4><strong>Ab Initio Predictions</strong></h4><ul><li>AUGUSTUS gene predictions based on statistical models</li><li>Species-specific training for accuracy</li><li>Identifies genes without external evidence</li><li>Particularly important for species-specific or novel genes</li></ul><h3><strong>Scientific Applications</strong></h3><ul><li><strong>Genome Projects</strong>: Primary annotation for newly sequenced genomes</li><li><strong>Re-annotation</strong>: Improve existing annotations with new evidence</li><li><strong>Comparative Genomics</strong>: Consistent gene models across related species</li><li><strong>Transcriptomics</strong>: Integrate RNA-seq data for expression-informed annotation</li><li><strong>GenBank Submission</strong>: Generate submission-ready annotation files</li><li><strong>Non-Model Organisms</strong>: Annotate understudied species</li><li><strong>Evolutionary Studies</strong>: Track gene gain/loss and structural evolution</li></ul><h3><strong>Target Organisms</strong></h3><h4><strong>Primary Focus: Metazoans</strong></h4><ul><li>Mammals (humans, mice, livestock)</li><li>Insects (Drosophila, agricultural pests, vectors)</li><li>Fish and aquatic animals</li><li>Birds and reptiles</li><li>Invertebrates (nematodes, mollusks, crustaceans)</li></ul><h4><strong>Adaptable to Other Eukaryotes</strong></h4><ul><li>Fungi (yeasts, filamentous fungi)</li><li>Plants (with appropriate training data)</li><li>Protists (single-celled eukaryotes)</li><li>Note: Requires species-appropriate AUGUSTUS training parameters</li></ul><h3><strong>Input Requirements</strong></h3><p>Provide a CSV or TSV samplesheet with:</p><pre>sample,assembly,proteins,transcripts,rnaseq_reads\nspecies1,genome.fasta,proteins.fasta,transcripts.fasta,\nspecies2,genome.fasta,proteins.fasta,,rnaseq_R1.fq.gz;rnaseq_R2.fq.gz</pre><h4><strong>Required Inputs</strong></h4><ul><li><strong>Genome Assembly</strong>: FASTA file with scaffolds or chromosomes</li><li><strong>Sample Identifier</strong>: Unique name for the annotation project</li></ul><h4><strong>Optional Evidence (Highly Recommended)</strong></h4><ul><li><strong>Protein Sequences</strong>: FASTA of related species proteins (enhances accuracy)</li><li><strong>Transcript Sequences</strong>: FASTA of known transcripts/cDNAs</li><li><strong>RNA-seq Reads</strong>: FASTQ files for de novo transcript assembly</li><li><strong>Related Genome Annotations</strong>: GFF/GTF from close relatives for transfer</li></ul><h3><strong>Main Outputs</strong></h3><ul><li><strong>Gene Annotations</strong>: GFF3/GTF format with complete gene structures</li><li><strong>Protein Sequences</strong>: FASTA of predicted protein sequences</li><li><strong>Transcript Sequences</strong>: FASTA of mRNA sequences</li><li><strong>CDS Sequences</strong>: FASTA of coding sequences</li><li><strong>Evidence Alignments</strong>: BAM files of protein/transcript alignments</li><li><strong>BUSCO Assessment</strong>: Gene completeness metrics</li><li><strong>Statistics Tables</strong>: Gene counts, lengths, exon numbers</li><li><strong>MultiQC Report</strong>: Comprehensive quality control summary</li></ul><h3><strong>Annotation Quality Metrics</strong></h3><h4><strong>BUSCO Completeness</strong></h4><ul><li>Percentage of conserved single-copy orthologs identified</li><li>High-quality annotations: >90% complete BUSCOs</li><li>Indicates annotation coverage and accuracy</li></ul><h4><strong>Gene Model Statistics</strong></h4><ul><li>Number of genes (compare to related species)</li><li>Average gene and CDS lengths</li><li>Exon count distributions</li><li>Alternative splicing detection</li></ul><h4><strong>Evidence Support</strong></h4><ul><li>Percentage of genes with protein evidence</li><li>Percentage with transcript support</li><li>Genes supported by multiple evidence types</li><li>Ab initio-only genes requiring validation</li></ul><h3><strong>EvidenceModeler Integration</strong></h3><p>EvidenceModeler (EVM) combines predictions from multiple sources using configurable weights:</p><ul><li><strong>Protein Alignments</strong>: Typically highest weight (evolutionary conservation)</li><li><strong>Transcript Alignments</strong>: High weight (direct expression evidence)</li><li><strong>PASA Assemblies</strong>: Very high weight (experimentally validated)</li><li><strong>AUGUSTUS</strong>: Moderate weight (statistical predictions)</li><li><strong>Consensus Building</strong>: Resolves conflicts and creates unified gene set</li></ul><h3><strong>Optional Advanced Features</strong></h3><h4><strong>Trinity De Novo Assembly</strong></h4><ul><li>Assemble transcripts directly from RNA-seq without reference</li><li>Discover novel isoforms and alternative splicing</li><li>Identify transcripts from repetitive regions</li><li>Computationally intensive but comprehensive</li></ul><h4><strong>Annotation Transfer with Satsuma2</strong></h4><ul><li>Map annotations from closely related annotated genome</li><li>Useful when reference annotations are high-quality</li><li>Accelerates annotation of closely related species</li><li>Requires synteny between genomes</li></ul><h3><strong>Typical Annotation Workflow</strong></h3><h4><strong>Minimum Viable Annotation</strong></h4><ol><li>Genome assembly only</li><li>Ab initio prediction with AUGUSTUS</li><li>Basic gene models without evidence support</li><li>Time: Few hours</li></ol><h4><strong>Standard Annotation (Recommended)</strong></h4><ol><li>Genome assembly</li><li>Protein evidence from related species</li><li>AUGUSTUS prediction</li><li>EvidenceModeler integration</li><li>Time: 6-24 hours</li></ol><h4><strong>Gold Standard Annotation</strong></h4><ol><li>Genome assembly</li><li>Protein evidence</li><li>RNA-seq data</li><li>Trinity assembly</li><li>PASA transcript annotation</li><li>AUGUSTUS prediction</li><li>EvidenceModeler consensus</li><li>Time: 1-3 days</li></ol><h3><strong>Performance Expectations</strong></h3><ul><li><strong>Small genome (100-300 Mb, insect):</strong> 6-12 hours</li><li><strong>Medium genome (500 Mb - 1 Gb, fish):</strong> 12-24 hours</li><li><strong>Large genome (2-3 Gb, mammal):</strong> 1-3 days</li><li><strong>With Trinity assembly:</strong> Add 12-36 hours</li><li><em>Time depends on genome size, evidence amount, and RNA-seq depth</em></li></ul><h3><strong>Best Practices</strong></h3><ul><li><strong>Use Multiple Evidence Types</strong>: Combine proteins, transcripts, and ab initio for best results</li><li><strong>Select Appropriate AUGUSTUS Training</strong>: Use closely related species parameters</li><li><strong>Quality Genome Assembly</strong>: Better assemblies yield better annotations</li><li><strong>Adequate RNA-seq Coverage</strong>: 50-100M reads minimum for transcript assembly</li><li><strong>Validate Results</strong>: Check BUSCO scores and compare to related species</li></ul><blockquote><p><strong>Perfect for:</strong> Genome Projects \u2022 Re-annotation \u2022 Comparative Genomics \u2022 Non-Model Organisms \u2022 GenBank Submission \u2022 Evolutionary Studies</p></blockquote>",
  "spec": [
    {
      "type": "Stash File",
      "label": "Input Samplesheet",
      "name": "input",
      "description": "CSV/TSV with columns: sample, assembly (genome FASTA), proteins (optional), transcripts (optional), rnaseq_reads (optional). Multiple evidence types improve annotation quality.",
      "required": true,
      "restrictions": {
        "allow_files": true,
        "allowed_file_types": [
          ".csv",
          ".tsv"
        ]
      }
    },
    {
      "type": "Stash File",
      "label": "Output Directory",
      "name": "outdir",
      "description": "Directory for annotation results including GFF3/GTF gene models, protein/transcript sequences, and quality reports.",
      "defaultValue": "./genomeannotator-results",
      "required": true,
      "restrictions": {
        "allow_files": false,
        "allow_folders": true
      }
    }
  ],
  "jobConfig": [
    {
      "type": "Select",
      "label": "System Size",
      "name": "system_size",
      "description": "Select compute resources. LARGE recommended for most eukaryotic genomes. XLARGE for mammalian-sized genomes with RNA-seq.",
      "options": [
        {
          "label": "MEDIUM (32 CPUs, 120GB RAM) - Small genomes (<500 Mb)",
          "value": "medium",
          "mapValue": {
            "nodeSize": "MEDIUM",
            "numNodes": 1,
            "withGpu": false
          }
        },
        {
          "label": "LARGE (64 CPUs, 360GB RAM) - Recommended for most genomes",
          "value": "large",
          "mapValue": {
            "nodeSize": "LARGE",
            "numNodes": 1,
            "withGpu": false
          }
        },
        {
          "label": "XLARGE (96 CPUs, 540GB RAM) - Large genomes (>2 Gb) with RNA-seq",
          "value": "xlarge",
          "mapValue": {
            "nodeSize": "XLARGE",
            "numNodes": 1,
            "withGpu": false
          }
        }
      ],
      "defaultValue": "large"
    }
  ],
  "tags": [
    {
      "id": "fb1ee42a-629a-4d99-9e7f-1da3c5f7a691",
      "name": "biology",
      "type": "field"
    },
    {
      "id": "6e4e74a4-560e-4674-95c3-60fe895b8c91",
      "name": "genomics",
      "type": "subfield"
    },
    {
      "id": "831477f4-f572-4e27-af83-037661489800",
      "name": "analysis",
      "type": "task"
    }
  ]
}