{
    "name": "alleleexpression-ase-analysis",
    "title": "ASE Detection and Quantification",
    "description": "Comprehensive allele-specific expression (ASE) analysis using STAR-WASP alignment, UMI deduplication, and Beagle phasing with phaser. Detects and quantifies differential expression between maternal and paternal alleles for studying imprinting, cis-regulatory variation, and parent-of-origin effects. Samplesheet format: `name,FASTQ`",
    "version": "1.0.0",
    "engineType": "NEXTFLOW",
    "command": "nextflow run nf-core/alleleexpression --input ${input} --outdir ${outdir} --genome ${genome} --chromosome ${chromosome} --beagle_ref ${beagle_ref} --beagle_map ${beagle_map} -r dev -profile singularity",
    "imageUrl": "https://raw.githubusercontent.com/nf-core/alleleexpression/dev/docs/images/nf-core-alleleexpression_logo_light.png",
    "content": "<h2><strong>Allele-Specific Expression - ASE Detection and Quantification</strong></h2><p>Analyzes RNA sequencing data to detect and quantify differences in gene expression between maternal and paternal alleles. Uses WASP filtering to remove mapping bias, phaser for haplotype reconstruction, and UMI deduplication for accurate quantification of allele-specific transcription.</p><h3><strong>What is Allele-Specific Expression?</strong></h3><blockquote><p><strong>Allele-Specific Expression (ASE)</strong> occurs when the two copies of a gene (maternal and paternal alleles) are expressed at different levels. ASE can result from genomic imprinting, cis-regulatory variation, random monoallelic expression, or X-chromosome inactivation. Detecting ASE reveals how genetic variation affects gene regulation and contributes to phenotypic diversity.</p></blockquote><h3><strong>Key Features</strong></h3><ul><li><strong>STAR-WASP Alignment</strong>: Removes reference allele mapping bias for unbiased quantification</li><li><strong>UMI Deduplication</strong>: Eliminates PCR duplicates for accurate molecule counting</li><li><strong>Beagle Phasing</strong>: Statistical haplotype phasing using reference panels</li><li><strong>Phaser Analysis</strong>: Haplotype-level and gene-level ASE detection</li><li><strong>Chromosome-Specific Processing</strong>: Focused analysis on specific chromosomes</li></ul><h3><strong>Pipeline Workflow</strong></h3><ol><li><strong>Input Validation</strong>: Prepare VCF files and samplesheet</li><li><strong>Quality Control</strong>: FastQC assessment of raw sequencing reads</li><li><strong>STAR Alignment with WASP</strong>: Map reads while filtering mapping-biased reads</li><li><strong>WASP Filtering</strong>: Remove reads with allelic mapping bias</li><li><strong>UMI Deduplication</strong>: Collapse PCR duplicates using molecular barcodes</li><li><strong>BAM Processing</strong>: Sort and index alignment files</li><li><strong>Chromosome Extraction</strong>: Extract variants for target chromosome</li><li><strong>Beagle Phasing</strong>: Phase heterozygous variants into haplotypes</li><li><strong>Phaser Analysis</strong>: Quantify allele-specific expression at haplotype and gene levels</li><li><strong>ASE Gene Identification</strong>: Statistical testing for significant allelic imbalance</li><li><strong>Report Generation</strong>: MultiQC summary of quality metrics</li></ol><h3><strong>Scientific Applications</strong></h3><ul><li><strong>Genomic Imprinting</strong>: Identify parent-of-origin expression patterns</li><li><strong>eQTL Studies</strong>: Map cis-regulatory genetic variants affecting expression</li><li><strong>Cancer Genomics</strong>: Detect loss of imprinting in tumor samples</li><li><strong>Personalized Medicine</strong>: Understand individual variation in drug metabolism genes</li><li><strong>X-Inactivation Studies</strong>: Analyze X-chromosome silencing patterns</li><li><strong>Complex Trait Genetics</strong>: Link regulatory variation to phenotypes</li></ul><h3><strong>Input Requirements</strong></h3><ul><li><strong>Sample Sheet</strong>: CSV with sample name, FASTQ files (R1/R2), and VCF file paths</li><li><strong>Reference Genome</strong>: FASTA and GTF annotation (or iGenomes reference)</li><li><strong>STAR Index</strong>: Pre-built genome index for STAR aligner</li><li><strong>Beagle Reference Panel</strong>: Population VCF for accurate phasing</li><li><strong>Beagle Genetic Map</strong>: Recombination map for phasing accuracy</li><li><strong>Sample VCF</strong>: Individual genotypes with heterozygous SNPs</li></ul><h3><strong>Main Outputs</strong></h3><ul><li><strong>ASE Gene List</strong>: Genes with significant allelic imbalance and statistical support</li><li><strong>Phaser Haplotype Data</strong>: Allele-specific read counts per haplotype block</li><li><strong>Phased VCF</strong>: Beagle-phased genotypes with haplotype information</li><li><strong>WASP-Filtered BAM</strong>: Alignment files with mapping bias removed</li><li><strong>UMI-Deduplicated BAM</strong>: Molecular-count accurate alignments</li><li><strong>MultiQC Report</strong>: Comprehensive quality control summary</li></ul><blockquote><p><strong>Perfect for:</strong> Imprinting Studies \u2022 eQTL Mapping \u2022 Regulatory Variation \u2022 Parent-of-Origin Effects \u2022 X-Inactivation \u2022 Cancer ASE \u2022 Personalized Genomics</p></blockquote>",
    "spec": [
        {
            "type": "Stash File",
            "label": "Input Samplesheet",
            "name": "input",
            "required": true,
            "helpText": "CSV file containing sample information with columns for sample name, FASTQ files, and VCF file paths",
            "restrictions": {
                "allow_files": true,
                "allowed_file_types": [
                    ".csv",
                    ".tsv"
                ]
            }
        },
        {
            "type": "Stash File",
            "label": "Output Directory",
            "name": "outdir",
            "defaultValue": "./alleleexpression-results",
            "required": true,
            "helpText": "Directory where pipeline results will be saved",
            "restrictions": {
                "allow_files": false,
                "allow_folders": true
            }
        },
        {
            "type": "Input",
            "label": "Genome Reference",
            "name": "genome",
            "required": false,
            "description": "Name of iGenomes reference (e.g., GRCh38, GRCm39) or leave empty to specify custom genome files",
            "defaultValue": ""
        },
        {
            "type": "Input",
            "label": "Chromosome",
            "name": "chromosome",
            "required": false,
            "description": "Specific chromosome to analyze (e.g., chr1, chr2). Leave empty to analyze all chromosomes",
            "defaultValue": ""
        },
        {
            "type": "Stash File",
            "label": "Beagle Reference Panel",
            "name": "beagle_ref",
            "required": true,
            "helpText": "Beagle reference panel VCF file for haplotype phasing",
            "restrictions": {
                "allow_files": true,
                "allowed_file_types": [
                    ".vcf",
                    ".vcf.gz"
                ]
            }
        },
        {
            "type": "Stash File",
            "label": "Beagle Genetic Map",
            "name": "beagle_map",
            "required": true,
            "helpText": "Beagle genetic map file for phasing accuracy",
            "restrictions": {
                "allow_files": true,
                "allowed_file_types": [
                    ".map",
                    ".txt"
                ]
            }
        }
    ],
    "jobConfig": [
        {
            "type": "Select",
            "label": "Resources",
            "name": "system_size",
            "options": [
                {
                    "label": "MEDIUM",
                    "value": "medium",
                    "mapValue": {
                        "nodeSize": "MEDIUM",
                        "numNodes": 1,
                        "withGpu": false
                    }
                },
                {
                    "label": "LARGE",
                    "value": "large",
                    "mapValue": {
                        "nodeSize": "LARGE",
                        "numNodes": 1,
                        "withGpu": false
                    }
                },
                {
                    "label": "XLARGE",
                    "value": "xlarge",
                    "mapValue": {
                        "nodeSize": "XLARGE",
                        "numNodes": 1,
                        "withGpu": false
                    }
                }
            ],
            "defaultValue": "large"
        }
    ],
    "tags": [
        {
            "id": "fb1ee42a-629a-4d99-9e7f-1da3c5f7a691",
            "name": "biology",
            "type": "field"
        },
        {
            "id": "6e4e74a4-560e-4674-95c3-60fe895b8c91",
            "name": "genomics",
            "type": "subfield"
        },
        {
            "id": "831477f4-f572-4e27-af83-037661489800",
            "name": "analysis",
            "type": "task"
        }
    ]
}