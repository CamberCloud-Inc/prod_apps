{
  "name": "hgtseq-horizontal-gene-transfer",
  "title": "HGTSeq: Horizontal Gene Transfer Detection from NGS Data",
  "description": "Detect and analyze horizontal gene transfer events from whole genome or metagenomic sequencing data. Identifies non-host microbial sequences and infers potential genomic integration sites for studying bacterial gene transfer, pathogen integration, and mobile genetic elements.",
  "version": "1.1.0",
  "engineType": "NEXTFLOW",
  "command": "nextflow run nf-core/hgtseq --input ${input} --outdir ${outdir} --genome ${genome} --krakendb ${krakendb} --kronadb ${kronadb} -r 1.1.0",
  "imageUrl": "https://raw.githubusercontent.com/nf-core/hgtseq/master/docs/images/nf-core-hgtseq_logo_light.png",
  "content": "<h1 class=\"heading-node\">🧬 HGTSeq: Horizontal Gene Transfer Detection Pipeline</h1><p class=\"text-node\"><strong>Discover Mobile Genetic Elements and Bacterial Gene Transfer Events</strong></p><p class=\"text-node\">Horizontal gene transfer (HGT) is a key mechanism driving bacterial evolution, antibiotic resistance spread, and pathogen adaptation. This pipeline uses metagenomic classification of paired-read alignments to identify non-host microbial sequences within sequencing data and infer potential integration sites into host genomes.</p><img src=\"https://raw.githubusercontent.com/nf-core/hgtseq/dev/docs/images/nf-core-hgtseq_metro_map_grey.png\" alt=\"nf-core/hgtseq workflow\" width=\"600\" height=\"400\"><h2 class=\"heading-node\">🎯 Scientific Applications</h2><p class=\"text-node\">Perfect for investigating:</p><ul class=\"list-node\"><li><p class=\"text-node\"><strong>🦠 Bacterial Gene Transfer:</strong> Detect genes transferred between bacterial species via plasmids, transposons, or phages</p></li><li><p class=\"text-node\"><strong>🧫 Pathogen Integration:</strong> Identify viral or bacterial DNA integration into host genomes (e.g., HPV in cancer genomes)</p></li><li><p class=\"text-node\"><strong>💊 Antibiotic Resistance:</strong> Track mobile resistance genes spreading through microbial communities</p></li><li><p class=\"text-node\"><strong>🧬 Metagenome Analysis:</strong> Characterize microbial contamination or unexpected sequences in host genome projects</p></li><li><p class=\"text-node\"><strong>🔬 Evolutionary Studies:</strong> Study gene flow between organisms and identify ancient HGT events</p></li></ul><h2 class=\"heading-node\">📋 Input Requirements</h2><h3 class=\"heading-node\">Sample Sheet (CSV Format)</h3><p class=\"text-node\">Create a CSV file with your sequencing data:</p><pre class=\"block-node\"><code>sample,fastq_1,fastq_2\npatient_001,sample1_R1.fastq.gz,sample1_R2.fastq.gz\npatient_002,sample2_R1.fastq.gz,sample2_R2.fastq.gz\nisolate_A,isolateA_R1.fastq.gz,isolateA_R2.fastq.gz</code></pre><p class=\"text-node\"><strong>Column Details:</strong></p><ul class=\"list-node\"><li><p class=\"text-node\"><strong>sample:</strong> Unique sample identifier</p></li><li><p class=\"text-node\"><strong>fastq_1:</strong> Path to forward reads (R1) - local path or URL</p></li><li><p class=\"text-node\"><strong>fastq_2:</strong> Path to reverse reads (R2) - local path or URL</p></li></ul><h3 class=\"heading-node\">Reference Genome Selection</h3><p class=\"text-node\">Select the appropriate host genome to identify non-host sequences:</p><ul class=\"list-node\"><li><p class=\"text-node\"><strong>🧑 Human:</strong> GRCh37, GRCh38 - for human cancer genomes, clinical samples</p></li><li><p class=\"text-node\"><strong>🐭 Mouse:</strong> GRCm38, GRCm39 - for model organism studies</p></li><li><p class=\"text-node\"><strong>🦠 Bacteria:</strong> Specify your bacterial reference genome</p></li><li><p class=\"text-node\"><strong>📝 Custom:</strong> Provide your own reference genome via --fasta parameter</p></li></ul><h3 class=\"heading-node\">Required Databases</h3><p class=\"text-node\"><strong>Kraken2 Database:</strong></p><ul class=\"list-node\"><li><p class=\"text-node\">Taxonomic classification database for identifying microbial sequences</p></li><li><p class=\"text-node\">Standard DB (~50GB): archaea, bacteria, viruses, human</p></li><li><p class=\"text-node\">Custom DB: build specific databases for your organism set</p></li><li><p class=\"text-node\">Format: Path to Kraken2 database directory or compressed .tar.gz</p></li></ul><p class=\"text-node\"><strong>Krona Taxonomy Database:</strong></p><ul class=\"list-node\"><li><p class=\"text-node\">Required for generating interactive taxonomic visualizations</p></li><li><p class=\"text-node\">Path to taxonomy.tab file from Krona installation</p></li><li><p class=\"text-node\">Available at: NCBI taxonomy or Krona database</p></li></ul><h2 class=\"heading-node\">🔬 Pipeline Workflow</h2><p class=\"text-node\">The analysis follows these steps:</p><ol class=\"list-node\"><li><p class=\"text-node\"><strong>Quality Control (FastQC):</strong> Assess raw read quality and adapter content</p></li><li><p class=\"text-node\"><strong>Read Trimming (Trim Galore):</strong> Remove adapters and low-quality bases</p></li><li><p class=\"text-node\"><strong>Host Mapping (BWA-MEM):</strong> Align reads to reference genome to identify host sequences</p></li><li><p class=\"text-node\"><strong>Alignment Processing (SAMtools):</strong> Filter and sort alignments</p></li><li><p class=\"text-node\"><strong>Extract Unmapped/Discordant Reads:</strong> Identify potential HGT-containing read pairs</p></li><li><p class=\"text-node\"><strong>Taxonomic Classification (Kraken2):</strong> Classify non-host reads to identify microbial origin</p></li><li><p class=\"text-node\"><strong>Integration Site Inference:</strong> Analyze read pair positions to identify insertion sites</p></li><li><p class=\"text-node\"><strong>Visualization (Krona):</strong> Create interactive hierarchical charts of taxonomic composition</p></li><li><p class=\"text-node\"><strong>HTML Report (RMarkdown):</strong> Comprehensive analysis summary with HGT scoring</p></li><li><p class=\"text-node\"><strong>Quality Summary (MultiQC):</strong> Aggregate QC metrics across all samples</p></li></ol><h2 class=\"heading-node\">📊 Comprehensive Results</h2><h3 class=\"heading-node\">HGT Detection Results</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>📍 Integration Sites:</strong> Genomic coordinates of potential HGT insertion points</p></li><li><p class=\"text-node\"><strong>🦠 Microbial Sources:</strong> Taxonomic identification of transferred genetic material</p></li><li><p class=\"text-node\"><strong>📊 HGT Scores:</strong> Confidence scores based on k-mer analysis and read support</p></li><li><p class=\"text-node\"><strong>📈 Read Counts:</strong> Supporting evidence (number of discordant/unmapped read pairs)</p></li></ul><h3 class=\"heading-node\">Visualization & Reports</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>🎨 Krona Charts:</strong> Interactive hierarchical taxonomy plots showing microbial composition</p></li><li><p class=\"text-node\"><strong>📑 HTML Analysis Report:</strong> Detailed per-sample HGT analysis with scoring and statistics</p></li><li><p class=\"text-node\"><strong>📊 MultiQC Report:</strong> Comprehensive quality control across all pipeline steps</p></li><li><p class=\"text-node\"><strong>📁 Alignment Files:</strong> BAM files with host-mapped and unmapped reads for manual inspection</p></li></ul><h3 class=\"heading-node\">Quality Control Metrics</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Read Quality:</strong> Per-base quality scores and adapter content</p></li><li><p class=\"text-node\"><strong>Mapping Statistics:</strong> Host genome mapping rates and coverage</p></li><li><p class=\"text-node\"><strong>Classification Rates:</strong> Percentage of reads classified to different taxa</p></li><li><p class=\"text-node\"><strong>Taxonomic Distribution:</strong> Breakdown of detected microbial sequences</p></li></ul><h2 class=\"heading-node\">💡 Use Case Examples</h2><h3 class=\"heading-node\">Cancer Genomics</h3><p class=\"text-node\">Detect HPV or EBV integration sites in cancer genomes. Identify viral oncogene insertion points that may drive tumorigenesis.</p><h3 class=\"heading-node\">Bacterial Evolution</h3><p class=\"text-node\">Track antibiotic resistance genes moving between bacterial species via plasmids or transposons in clinical isolates.</p><h3 class=\"heading-node\">Microbiome Studies</h3><p class=\"text-node\">Identify microbial contamination in host genome sequencing projects or study gene transfer in complex microbial communities.</p><h3 class=\"heading-node\">Ancient DNA</h3><p class=\"text-node\">Detect historical HGT events in ancient genomes or identify microbial DNA in archaeological samples.</p><h2 class=\"heading-node\">⚙️ Technical Details</h2><p class=\"text-node\"><strong>Pipeline Features:</strong></p><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Containerized:</strong> Docker/Singularity containers ensure reproducibility</p></li><li><p class=\"text-node\"><strong>Scalable:</strong> Process single samples or large cohorts</p></li><li><p class=\"text-node\"><strong>Portable:</strong> Runs on local machines, HPC clusters, or cloud platforms</p></li><li><p class=\"text-node\"><strong>Automated:</strong> Fully automated from FASTQ to results</p></li><li><p class=\"text-node\"><strong>Best Practices:</strong> Follows nf-core community standards</p></li></ul><p class=\"text-node\"><strong>Resource Requirements:</strong></p><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Recommended:</strong> LARGE node (64 CPUs, 360GB RAM)</p></li><li><p class=\"text-node\"><strong>Storage:</strong> ~50GB for Kraken2 standard database + sample data</p></li><li><p class=\"text-node\"><strong>Runtime:</strong> 2-4 hours for typical WGS sample (30x coverage)</p></li></ul><h2 class=\"heading-node\">📚 Scientific Background</h2><p class=\"text-node\">Horizontal gene transfer is a major mechanism of bacterial evolution, enabling rapid adaptation through acquisition of new traits like antibiotic resistance, virulence factors, and metabolic capabilities. Unlike vertical inheritance, HGT allows organisms to acquire genes from distantly related species through transformation, transduction, or conjugation. This pipeline uses computational approaches to detect HGT signatures in sequencing data by identifying read pairs where one mate maps to the host genome while the other contains foreign microbial sequences, suggesting genomic integration events.</p><p class=\"text-node\"><strong>Citation:</strong> Anastasios et al. (2022). \"hgtseq: A Standard Pipeline to Study Horizontal Gene Transfer.\" <em>International Journal of Molecular Sciences</em> 23(23):14512. DOI: 10.3390/ijms232314512</p><p class=\"text-node\">Built with <a class=\"link\" href=\"https://www.nextflow.io/\" target=\"_blank\">Nextflow</a> • Powered by <a class=\"link\" href=\"https://nf-co.re/hgtseq/1.1.0/\" target=\"_blank\">nf-core/hgtseq v1.1.0</a> • Containerized execution • Continuous integration tested</p>",
  "spec": [
    {
      "type": "Stash File",
      "label": "Sample Sheet",
      "name": "input",
      "description": "CSV file with columns: sample, fastq_1, fastq_2. Each row represents one sample with paired-end sequencing data (local paths or URLs).",
      "required": true,
      "hidden": false,
      "disabled": false,
      "restrictions": {
        "allow_files": true,
        "allow_folders": false,
        "allowed_file_types": [".csv"]
      }
    },
    {
      "type": "Stash File",
      "label": "Output Directory",
      "name": "outdir",
      "description": "Output directory for HGT analysis results including integration sites, taxonomic classifications, and QC reports.",
      "defaultValue": "./hgtseq-results",
      "required": true,
      "hidden": false,
      "disabled": false,
      "restrictions": {
        "allow_files": false,
        "allow_folders": true
      }
    },
    {
      "type": "Select",
      "label": "Host Reference Genome",
      "name": "genome",
      "description": "Host organism reference genome for identifying non-host sequences. Select the appropriate host genome for your samples.",
      "defaultValue": "GRCh38",
      "required": true,
      "hidden": false,
      "disabled": false,
      "options": [
        {"label": "Human GRCh38 (NCBI) - Most recent human genome", "value": "GRCh38"},
        {"label": "Human GRCh37 (Ensembl) - Previous human reference", "value": "GRCh37"},
        {"label": "Human hg38 (UCSC)", "value": "hg38"},
        {"label": "Human hg19 (UCSC)", "value": "hg19"},
        {"label": "Mouse GRCm38 (Ensembl)", "value": "GRCm38"},
        {"label": "Mouse GRCm39 (Ensembl) - Latest mouse genome", "value": "GRCm39"},
        {"label": "Mouse mm10 (UCSC)", "value": "mm10"},
        {"label": "Mouse mm39 (UCSC)", "value": "mm39"}
      ]
    },
    {
      "type": "Stash File",
      "label": "Kraken2 Database",
      "name": "krakendb",
      "description": "Path to Kraken2 taxonomic database for microbial sequence classification. Standard DB includes bacteria, archaea, viruses. Can be directory or compressed .tar.gz file.",
      "required": true,
      "hidden": false,
      "disabled": false,
      "restrictions": {
        "allow_files": true,
        "allow_folders": true,
        "allowed_file_types": []
      }
    },
    {
      "type": "Stash File",
      "label": "Krona Taxonomy Database",
      "name": "kronadb",
      "description": "Path to Krona taxonomy database (taxonomy.tab file) for generating interactive taxonomic visualization charts.",
      "required": true,
      "hidden": false,
      "disabled": false,
      "restrictions": {
        "allow_files": true,
        "allow_folders": false,
        "allowed_file_types": [".tab", ".txt"]
      }
    }
  ],
  "jobConfig": [
    {
      "type": "Select",
      "label": "Compute Resources",
      "name": "system_size",
      "hidden": false,
      "description": "Select compute resources based on dataset size. LARGE recommended for whole genome sequencing data with comprehensive Kraken2 databases.",
      "options": [
        {
          "label": "MEDIUM (32 CPUs, 180GB RAM) - Small test datasets",
          "value": "medium",
          "mapValue": {
            "nodeSize": "MEDIUM",
            "numNodes": 1,
            "withGpu": false
          }
        },
        {
          "label": "LARGE (64 CPUs, 360GB RAM) - Recommended for WGS",
          "value": "large",
          "mapValue": {
            "nodeSize": "LARGE",
            "numNodes": 1,
            "withGpu": false
          }
        },
        {
          "label": "XLARGE (96 CPUs, 540GB RAM) - Large cohorts or deep sequencing",
          "value": "xlarge",
          "mapValue": {
            "nodeSize": "XLARGE",
            "numNodes": 1,
            "withGpu": false
          }
        }
      ],
      "defaultValue": "large"
    }
  ],
  "tags": [
    {"name": "horizontal-gene-transfer", "type": "task"},
    {"name": "metagenomics", "type": "subfield"},
    {"name": "genomics", "type": "field"},
    {"name": "bacterial-evolution", "type": "task"}
  ]
}
