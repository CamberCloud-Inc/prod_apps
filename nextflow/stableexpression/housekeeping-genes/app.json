{
  "name": "stableexpression-housekeeping-genes",
  "title": "Reference Gene Identification for RT-qPCR",
  "description": "Identify the most stable housekeeping genes across expression datasets for RT-qPCR normalization. Analyzes single or multiple RNA-seq datasets to find genes with minimal expression variation, essential for accurate quantitative PCR experiments and gene expression studies. Samplesheet format: `sample,condition,batch,tissue`",
  "version": "1.0dev",
  "engineType": "NEXTFLOW",
  "command": "nextflow run nf-core/stableexpression --species ${species} --datasets ${datasets} --outdir ${outdir} --normalisation_method ${normalisation_method} --nb_top_gene_candidates ${nb_top_gene_candidates} --fetch_eatlas_accessions ${fetch_eatlas_accessions} -r dev",
  "imageUrl": "https://raw.githubusercontent.com/nf-core/stableexpression/master/docs/images/nf-core-stableexpression_logo_light.png",
  "content": "<h1 class=\"heading-node\">Stable Expression: Reference Gene Identification for RT-qPCR</h1><img src=\"https://raw.githubusercontent.com/nf-core/stableexpression/master/docs/images/nf-core-stableexpression_logo_light.png\" alt=\"nf-core/stableexpression\" width=\"400\" height=\"200\"><p class=\"text-node\"><strong>Find the Most Stable Housekeeping Genes for Accurate RT-qPCR Normalization</strong></p><p class=\"text-node\">The nf-core/stableexpression pipeline identifies genes with the most consistent expression across experimental conditions, making them ideal reference genes for RT-qPCR normalization. By analyzing RNA-seq count data, the pipeline ranks genes by expression stability to help you choose the best internal controls for your quantitative PCR experiments.</p><h2 class=\"heading-node\">The Reference Gene Problem</h2><p class=\"text-node\"><strong>Why Housekeeping Genes Matter:</strong></p><p class=\"text-node\">RT-qPCR (Reverse Transcription quantitative PCR) requires normalization to internal reference genes to account for technical variation. Traditional housekeeping genes like GAPDH, ACTB, or 18S rRNA are often used by default, but their expression can vary significantly across:</p><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Different tissues and cell types</strong></p></li><li><p class=\"text-node\"><strong>Disease vs. healthy states</strong></p></li><li><p class=\"text-node\"><strong>Drug treatments and experimental conditions</strong></p></li><li><p class=\"text-node\"><strong>Developmental stages</strong></p></li><li><p class=\"text-node\"><strong>Environmental stresses</strong></p></li></ul><p class=\"text-node\"><strong>The Problem:</strong> Using unstable reference genes leads to misleading RT-qPCR results, incorrect normalization, and false biological conclusions.</p><p class=\"text-node\"><strong>The Solution:</strong> This pipeline analyzes your actual experimental RNA-seq data to identify genes with minimal expression variation specific to your experimental context, ensuring accurate normalization tailored to your study.</p><h2 class=\"heading-node\">Pipeline Workflow</h2><ol class=\"list-node\"><li><p class=\"text-node\"><strong>Data Retrieval (Optional):</strong> Automatically fetch datasets from Expression Atlas for your species</p></li><li><p class=\"text-node\"><strong>Normalization:</strong> Normalize raw count data using DESeq2 or EdgeR</p></li><li><p class=\"text-node\"><strong>Gene ID Mapping:</strong> Convert gene IDs to Ensembl format for standardization</p></li><li><p class=\"text-node\"><strong>Variation Analysis:</strong> Compute pairwise gene expression variation statistics</p></li><li><p class=\"text-node\"><strong>Stability Ranking:</strong> Identify and rank most stable gene candidates</p></li><li><p class=\"text-node\"><strong>Comprehensive Reporting:</strong> Generate MultiQC reports with candidate gene lists</p></li></ol><h2 class=\"heading-node\">Input Requirements</h2><h3 class=\"heading-node\">Datasets CSV Format</h3><p class=\"text-node\">Create a CSV file listing your expression datasets:</p><pre class=\"block-node\"><code>counts,design,normalised\n/path/to/study1_counts.csv,/path/to/study1_design.csv,false\n/path/to/study2_counts.csv,/path/to/study2_design.csv,false\n/path/to/normalized_counts.csv,/path/to/design.csv,true</code></pre><p class=\"text-node\"><strong>Column Details:</strong></p><ul class=\"list-node\"><li><p class=\"text-node\"><code class=\"inline\" spellcheck=\"false\">counts</code>: Path to count matrix CSV file (genes × samples)</p></li><li><p class=\"text-node\"><code class=\"inline\" spellcheck=\"false\">design</code>: Path to experimental design CSV file (sample metadata)</p></li><li><p class=\"text-node\"><code class=\"inline\" spellcheck=\"false\">normalised</code>: Boolean indicating if counts are already normalized (true/false)</p></li></ul><h3 class=\"heading-node\">Count Matrix Format (counts.csv)</h3><p class=\"text-node\">Gene expression matrix with genes as rows and samples as columns:</p><pre class=\"block-node\"><code>,sample_A,sample_B,sample_C,sample_D\ngene_1,152,189,201,175\ngene_2,2341,2198,2405,2287\ngene_3,89,102,95,88\nGAPDH,15234,14987,15632,15109\nACTB,8765,9102,8934,9234</code></pre><p class=\"text-node\"><strong>Format Requirements:</strong></p><ul class=\"list-node\"><li><p class=\"text-node\">First column: Gene identifiers (Ensembl IDs, gene symbols, or other IDs)</p></li><li><p class=\"text-node\">Remaining columns: Sample expression values (raw counts or normalized)</p></li><li><p class=\"text-node\">CSV format with comma separation</p></li><li><p class=\"text-node\">Header row with sample names</p></li></ul><h3 class=\"heading-node\">Experimental Design Format (design.csv)</h3><p class=\"text-node\">Sample metadata describing experimental conditions:</p><pre class=\"block-node\"><code>sample,condition,batch,tissue\nsample_A,control,batch1,liver\nsample_B,treatment,batch1,liver\nsample_C,control,batch2,liver\nsample_D,treatment,batch2,liver</code></pre><p class=\"text-node\"><strong>Format Requirements:</strong></p><ul class=\"list-node\"><li><p class=\"text-node\"><code class=\"inline\" spellcheck=\"false\">sample</code> column (required): Must match column names in count matrix</p></li><li><p class=\"text-node\">Additional columns: Experimental factors (condition, tissue, treatment, time point, etc.)</p></li><li><p class=\"text-node\">Used for proper normalization accounting for batch effects and covariates</p></li></ul><h3 class=\"heading-node\">Multiple Dataset Analysis</h3><p class=\"text-node\">Analyze multiple independent studies to find genes stable across diverse conditions:</p><pre class=\"block-node\"><code>counts,design,normalised\n/data/cancer_study/counts.csv,/data/cancer_study/design.csv,false\n/data/drug_treatment/counts.csv,/data/drug_treatment/design.csv,false\n/data/development/counts.csv,/data/development/design.csv,false</code></pre><p class=\"text-node\"><strong>Benefits of Multi-Dataset Analysis:</strong></p><ul class=\"list-node\"><li><p class=\"text-node\">Identify genes stable across multiple experimental contexts</p></li><li><p class=\"text-node\">More robust reference gene selection</p></li><li><p class=\"text-node\">Applicable to diverse downstream experiments</p></li></ul><h2 class=\"heading-node\">Key Features</h2><h3 class=\"heading-node\">1. Flexible Data Input</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Local Datasets:</strong> Analyze your own RNA-seq count data</p></li><li><p class=\"text-node\"><strong>Expression Atlas Integration:</strong> Automatically fetch public datasets</p></li><li><p class=\"text-node\"><strong>Mixed Sources:</strong> Combine local and public data</p></li><li><p class=\"text-node\"><strong>Pre-normalized Data:</strong> Support for already-normalized counts</p></li></ul><h3 class=\"heading-node\">2. Robust Normalization Options</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>DESeq2:</strong> Variance-stabilizing transformation (default, recommended)</p></li><li><p class=\"text-node\"><strong>EdgeR:</strong> Trimmed mean of M-values normalization</p></li><li><p class=\"text-node\"><strong>Batch Correction:</strong> Account for technical variation</p></li><li><p class=\"text-node\"><strong>Count Filtering:</strong> Remove low-expression genes</p></li></ul><h3 class=\"heading-node\">3. Comprehensive Gene ID Handling</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Automatic Mapping:</strong> Convert various ID types to Ensembl</p></li><li><p class=\"text-node\"><strong>Symbol Support:</strong> Work with gene symbols or IDs</p></li><li><p class=\"text-node\"><strong>Cross-Reference:</strong> Link to multiple annotation databases</p></li><li><p class=\"text-node\"><strong>Species-Specific:</strong> Support for major model organisms</p></li></ul><h3 class=\"heading-node\">4. Statistical Stability Analysis</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Pairwise Variation:</strong> Compute expression stability across conditions</p></li><li><p class=\"text-node\"><strong>Coefficient of Variation:</strong> Measure relative expression variability</p></li><li><p class=\"text-node\"><strong>Ranking Algorithm:</strong> Identify top stable genes</p></li><li><p class=\"text-node\"><strong>Candidate Selection:</strong> Configurable number of top candidates</p></li></ul><h2 class=\"heading-node\">Supported Species</h2><p class=\"text-node\">Choose from major model organisms:</p><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Human:</strong> homo_sapiens</p></li><li><p class=\"text-node\"><strong>Mouse:</strong> mus_musculus</p></li><li><p class=\"text-node\"><strong>Rat:</strong> rattus_norvegicus</p></li><li><p class=\"text-node\"><strong>Zebrafish:</strong> danio_rerio</p></li><li><p class=\"text-node\"><strong>Fruit Fly:</strong> drosophila_melanogaster</p></li><li><p class=\"text-node\"><strong>C. elegans:</strong> caenorhabditis_elegans</p></li><li><p class=\"text-node\"><strong>Yeast:</strong> saccharomyces_cerevisiae</p></li><li><p class=\"text-node\"><strong>Arabidopsis:</strong> arabidopsis_thaliana</p></li></ul><h2 class=\"heading-node\">Comprehensive Output Files</h2><h3 class=\"heading-node\">Primary Results</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Stable Gene List:</strong> Ranked list of most stable genes with stability scores</p></li><li><p class=\"text-node\"><strong>Top Candidates:</strong> Recommended reference genes for RT-qPCR</p></li><li><p class=\"text-node\"><strong>Gene Annotations:</strong> Full gene names and descriptions</p></li><li><p class=\"text-node\"><strong>Expression Statistics:</strong> Mean expression, CV, variation metrics</p></li></ul><h3 class=\"heading-node\">Statistical Analysis</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Normalized Counts:</strong> Processed expression matrices</p></li><li><p class=\"text-node\"><strong>Variation Tables:</strong> Per-gene stability statistics</p></li><li><p class=\"text-node\"><strong>Pairwise Comparisons:</strong> Expression variation across conditions</p></li><li><p class=\"text-node\"><strong>Gene ID Mappings:</strong> Ensembl to symbol conversions</p></li></ul><h3 class=\"heading-node\">Visualization and Reports</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>MultiQC Report:</strong> Interactive HTML summary</p></li><li><p class=\"text-node\"><strong>Stability Plots:</strong> Visualization of gene expression variation</p></li><li><p class=\"text-node\"><strong>Expression Heatmaps:</strong> Top stable genes across samples</p></li><li><p class=\"text-node\"><strong>Quality Metrics:</strong> Normalization and filtering statistics</p></li></ul><h3 class=\"heading-node\">Pipeline Metadata</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Software Versions:</strong> Complete tool version tracking</p></li><li><p class=\"text-node\"><strong>Execution Reports:</strong> Pipeline performance metrics</p></li><li><p class=\"text-node\"><strong>Parameters Used:</strong> Full configuration for reproducibility</p></li></ul><h2 class=\"heading-node\">Scientific Applications</h2><h3 class=\"heading-node\">RT-qPCR Experimental Design</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Select Optimal Reference Genes:</strong> Tailored to your specific experimental context</p></li><li><p class=\"text-node\"><strong>Validate Traditional Housekeepers:</strong> Test if GAPDH, ACTB are truly stable in your system</p></li><li><p class=\"text-node\"><strong>Multi-Gene Normalization:</strong> Identify panels of 2-3 stable references</p></li><li><p class=\"text-node\"><strong>Novel Reference Discovery:</strong> Find non-traditional stable genes</p></li></ul><h3 class=\"heading-node\">Gene Expression Studies</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Disease Research:</strong> Find stable genes in cancer, neurodegenerative diseases</p></li><li><p class=\"text-node\"><strong>Drug Response:</strong> Identify stable references for treatment studies</p></li><li><p class=\"text-node\"><strong>Development:</strong> Stage-specific stable gene identification</p></li><li><p class=\"text-node\"><strong>Tissue Comparison:</strong> Tissue-specific reference gene selection</p></li></ul><h3 class=\"heading-node\">Clinical Diagnostics</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Biomarker Validation:</strong> Proper normalization for diagnostic assays</p></li><li><p class=\"text-node\"><strong>Patient Stratification:</strong> Consistent expression measurement across cohorts</p></li><li><p class=\"text-node\"><strong>Quality Control:</strong> Standardize clinical qPCR workflows</p></li></ul><h3 class=\"heading-node\">Method Development</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Assay Optimization:</strong> Establish robust qPCR normalization strategies</p></li><li><p class=\"text-node\"><strong>Cross-Study Comparison:</strong> Enable meta-analysis with proper controls</p></li><li><p class=\"text-node\"><strong>Standardization:</strong> Develop field-specific reference gene recommendations</p></li></ul><h2 class=\"heading-node\">Best Practices</h2><h3 class=\"heading-node\">Data Selection</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Match Your Experimental Context:</strong> Use RNA-seq data from similar conditions</p></li><li><p class=\"text-node\"><strong>Include Diverse Samples:</strong> Capture full range of experimental variation</p></li><li><p class=\"text-node\"><strong>Sufficient Replicates:</strong> At least 3 biological replicates per condition</p></li><li><p class=\"text-node\"><strong>Quality Control:</strong> Use high-quality RNA-seq datasets</p></li></ul><h3 class=\"heading-node\">Analysis Strategy</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Start Broad:</strong> Analyze 1000+ candidate genes (default)</p></li><li><p class=\"text-node\"><strong>Multiple References:</strong> Use 2-3 stable genes for normalization</p></li><li><p class=\"text-node\"><strong>Validate:</strong> Test top candidates with RT-qPCR before final selection</p></li><li><p class=\"text-node\"><strong>Context-Specific:</strong> Re-analyze for different tissues or conditions</p></li></ul><h3 class=\"heading-node\">Expression Atlas Integration</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Public Data:</strong> Leverage thousands of curated RNA-seq experiments</p></li><li><p class=\"text-node\"><strong>Species Coverage:</strong> Access data for your organism of interest</p></li><li><p class=\"text-node\"><strong>Automatic Retrieval:</strong> Pipeline fetches and processes data automatically</p></li><li><p class=\"text-node\"><strong>Combine with Local Data:</strong> Augment your analysis with public datasets</p></li></ul><h2 class=\"heading-node\">Why Not Use Traditional Housekeeping Genes?</h2><p class=\"text-node\"><strong>Common assumptions that can fail:</strong></p><ul class=\"list-node\"><li><p class=\"text-node\"><strong>GAPDH (Glyceraldehyde-3-phosphate dehydrogenase):</strong> Varies in hypoxia, cancer, diabetes</p></li><li><p class=\"text-node\"><strong>ACTB (Beta-actin):</strong> Changes in muscle cells, development, some cancers</p></li><li><p class=\"text-node\"><strong>18S rRNA:</strong> Different degradation kinetics than mRNA, ratio varies</p></li><li><p class=\"text-node\"><strong>TUBB (Beta-tubulin):</strong> Varies in neuronal cells and certain treatments</p></li></ul><p class=\"text-node\"><strong>This pipeline helps you:</strong> Verify stability empirically rather than rely on assumptions, saving time and ensuring accurate results.</p><h2 class=\"heading-node\">Technical Implementation</h2><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Pipeline Framework:</strong> Built with Nextflow DSL2</p></li><li><p class=\"text-node\"><strong>Statistical Methods:</strong> DESeq2 and EdgeR for robust normalization</p></li><li><p class=\"text-node\"><strong>Gene Annotation:</strong> Ensembl BioMart integration</p></li><li><p class=\"text-node\"><strong>Containers:</strong> Docker/Singularity for reproducibility</p></li><li><p class=\"text-node\"><strong>Cloud Compatible:</strong> Run on HPC, cloud, or local systems</p></li></ul><p class=\"text-node\"><strong>Perfect for:</strong> RT-qPCR design • Reference gene selection • Gene expression studies • Biomarker validation • Clinical diagnostics • Method development • Housekeeping gene identification</p><p class=\"text-node\">Built with <a class=\"link\" href=\"https://www.nextflow.io/\" target=\"_blank\">Nextflow</a> • Powered by <a class=\"link\" href=\"https://nf-co.re/stableexpression\" target=\"_blank\">nf-core/stableexpression</a> • Containerized execution • Scientifically validated</p>",
  "spec": [
    {
      "type": "Input",
      "label": "Species",
      "name": "species",
      "required": true,
      "description": "Species for analysis (e.g., homo_sapiens, mus_musculus, rattus_norvegicus)",
      "defaultValue": "homo_sapiens"
    },
    {
      "type": "Stash File",
      "label": "Datasets CSV",
      "name": "datasets",
      "required": true,
      "description": "CSV file with columns: counts, design, normalised. Lists expression datasets with paths to count matrices and design files.",
      "restrictions": {
        "allow_files": true,
        "allowed_file_types": [
          ".csv"
        ]
      }
    },
    {
      "type": "Stash File",
      "label": "Output Directory",
      "name": "outdir",
      "defaultValue": "./stableexpression-results",
      "required": true,
      "description": "Directory where stable gene rankings and analysis results will be saved",
      "restrictions": {
        "allow_files": false,
        "allow_folders": true
      }
    },
    {
      "type": "Select",
      "label": "Normalization Method",
      "name": "normalisation_method",
      "options": [
        {
          "label": "DESeq2 (Recommended - variance stabilizing)",
          "value": "deseq2"
        },
        {
          "label": "EdgeR (TMM normalization)",
          "value": "edger"
        }
      ],
      "defaultValue": "deseq2",
      "description": "Statistical method for normalizing raw count data"
    },
    {
      "type": "Input",
      "label": "Number of Top Gene Candidates",
      "name": "nb_top_gene_candidates",
      "defaultValue": "1000",
      "description": "Number of top-expressed genes to retain for stability analysis (1000 recommended for comprehensive analysis)"
    },
    {
      "type": "Checkbox",
      "label": "Fetch Expression Atlas Datasets",
      "name": "fetch_eatlas_accessions",
      "defaultValue": false,
      "description": "Automatically fetch and include public datasets from Expression Atlas for your species (augments local data)"
    }
  ],
  "jobConfig": [
    {
      "type": "Select",
      "label": "Resources",
      "name": "system_size",
      "options": [
        {
          "label": "MEDIUM (32 CPUs, 180GB RAM) - Small datasets (<10 samples)",
          "value": "medium",
          "mapValue": {
            "nodeSize": "MEDIUM",
            "numNodes": 1,
            "withGpu": false
          }
        },
        {
          "label": "LARGE (64 CPUs, 360GB RAM) - Recommended for most analyses",
          "value": "large",
          "mapValue": {
            "nodeSize": "LARGE",
            "numNodes": 1,
            "withGpu": false
          }
        },
        {
          "label": "XLARGE (96 CPUs, 540GB RAM) - Large multi-dataset analyses",
          "value": "xlarge",
          "mapValue": {
            "nodeSize": "XLARGE",
            "numNodes": 1,
            "withGpu": false
          }
        }
      ],
      "defaultValue": "large"
    }
  ],
  "tags": [
    {
      "name": "stableexpression",
      "type": "pipeline"
    },
    {
      "name": "reference-genes",
      "type": "task"
    },
    {
      "name": "housekeeping-genes",
      "type": "task"
    },
    {
      "name": "gene-expression",
      "type": "category"
    },
    {
      "name": "rt-qpcr",
      "type": "method"
    }
  ]
}