{
  "name": "chipseq-histone-broad",
  "title": "ChIP-seq: Histone Modification Mapping with Broad Peak Calling",
  "description": "Map histone modifications (H3K27me3, H3K4me3, H3K9me3, H3K36me3) across the genome using broad peak calling optimized for diffuse chromatin marks. Discover chromatin states, regulatory regions, and epigenetic landscapes.",
  "content": "<h1 class=\"heading-node\">🧬 ChIP-seq: Histone Modification Mapping with Broad Peak Calling</h1><p class=\"text-node\"><strong>Uncover Chromatin States Through Epigenetic Modifications</strong></p><p class=\"text-node\">Chromatin Immunoprecipitation sequencing (ChIP-seq) for histone modifications reveals the epigenetic landscape of your genome. This specialized pipeline uses broad peak calling optimized for diffuse histone marks like H3K27me3, H3K36me3, and H3K9me3 that spread across chromatin domains.</p><img src=\"https://raw.githubusercontent.com/nf-core/chipseq/master/docs/images/nf-core-chipseq_logo_light.png\" alt=\"nf-core/chipseq workflow\" width=\"600\" height=\"300\"><h2 class=\"heading-node\">🎯 What Are Histone Modifications?</h2><p class=\"text-node\">Histones are proteins that package DNA into chromatin. Chemical modifications to histones act as 'epigenetic marks' that control gene expression without changing DNA sequence. These marks can:</p><ul class=\"list-node\"><li><p class=\"text-node\"><strong>🔓 Activate genes:</strong> H3K4me3 (promoters), H3K27ac (enhancers), H3K36me3 (gene bodies)</p></li><li><p class=\"text-node\"><strong>🔒 Silence genes:</strong> H3K27me3 (Polycomb repression), H3K9me3 (heterochromatin)</p></li><li><p class=\"text-node\"><strong>📊 Mark chromatin states:</strong> Combinatorial patterns define regulatory elements</p></li><li><p class=\"text-node\"><strong>🧬 Regulate development:</strong> Control cell differentiation and tissue specification</p></li></ul><h2 class=\"heading-node\">🎨 Common Histone Marks and Their Biological Roles</h2><h3 class=\"heading-node\">🔓 Active Chromatin Marks</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>H3K4me3:</strong> Active promoters, transcription start sites (TSS)</p></li><li><p class=\"text-node\"><strong>H3K27ac:</strong> Active enhancers, super-enhancers, regulatory elements</p></li><li><p class=\"text-node\"><strong>H3K4me1:</strong> Enhancers, primed/poised regulatory regions</p></li><li><p class=\"text-node\"><strong>H3K36me3:</strong> Active gene bodies, transcription elongation</p></li></ul><h3 class=\"heading-node\">🔒 Repressive Chromatin Marks</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>H3K27me3:</strong> Polycomb-mediated repression, developmentally silenced genes</p></li><li><p class=\"text-node\"><strong>H3K9me3:</strong> Constitutive heterochromatin, repetitive elements</p></li><li><p class=\"text-node\"><strong>H3K9me2:</strong> Facultative heterochromatin, tissue-specific silencing</p></li></ul><h2 class=\"heading-node\">⚙️ Broad vs Narrow Peak Calling</h2><p class=\"text-node\"><strong>This pipeline uses BROAD peak calling</strong> - essential for histone modifications:</p><ul class=\"list-node\"><li><p class=\"text-node\"><strong>🌊 Broad peaks:</strong> Detect diffuse signals across large chromatin domains (10-100kb)</p><ul class=\"list-node\"><li><p class=\"text-node\">Perfect for: H3K27me3, H3K36me3, H3K9me3, H3K79me2</p></li><li><p class=\"text-node\">Algorithm: MACS2/MACS3 with --broad flag (broad_cutoff = 0.1)</p></li><li><p class=\"text-node\">Captures: Extended enrichment regions, chromatin domains</p></li></ul></li><li><p class=\"text-node\"><strong>📍 Narrow peaks (not this pipeline):</strong> Sharp, focused signals (100-1000bp)</p><ul class=\"list-node\"><li><p class=\"text-node\">Better for: Transcription factors, H3K4me3, H3K27ac</p></li><li><p class=\"text-node\">Use: Separate narrow peak pipeline for TF ChIP-seq</p></li></ul></li></ul><h2 class=\"heading-node\">🧪 Experimental Design Requirements</h2><h3 class=\"heading-node\">Essential Components</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>🧫 ChIP samples:</strong> Immunoprecipitated DNA with histone-specific antibody</p></li><li><p class=\"text-node\"><strong>🎯 Input controls:</strong> Total chromatin without IP (critical for normalization)</p></li><li><p class=\"text-node\"><strong>🔬 Biological replicates:</strong> Minimum 2 replicates per condition (3+ recommended)</p></li><li><p class=\"text-node\"><strong>📊 Sequencing depth:</strong> 20-40 million reads per sample for mammalian genomes</p></li></ul><h3 class=\"heading-node\">Data Quality Metrics</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>✅ FRiP score:</strong> Fraction of Reads in Peaks &gt; 1-5% for histone marks</p></li><li><p class=\"text-node\"><strong>✅ Cross-correlation:</strong> NSC &gt; 1.05, RSC &gt; 0.8</p></li><li><p class=\"text-node\"><strong>✅ Library complexity:</strong> &gt; 80% non-duplicate reads</p></li></ul><h2 class=\"heading-node\">📋 Sample Sheet Format</h2><p class=\"text-node\">Your CSV samplesheet defines experimental structure:</p><pre class=\"block-node\"><code>sample,fastq_1,fastq_2,replicate,antibody,control,control_replicate\nH3K27me3_WT_R1,WT_H3K27me3_R1.fastq.gz,,1,H3K27me3,WT_INPUT,1\nH3K27me3_WT_R2,WT_H3K27me3_R2.fastq.gz,,2,H3K27me3,WT_INPUT,2\nH3K27me3_KO_R1,KO_H3K27me3_R1.fastq.gz,,1,H3K27me3,KO_INPUT,1\nH3K27me3_KO_R2,KO_H3K27me3_R2.fastq.gz,,2,H3K27me3,KO_INPUT,2\nWT_INPUT,WT_Input_R1.fastq.gz,,1,,,\nWT_INPUT,WT_Input_R2.fastq.gz,,2,,,\nKO_INPUT,KO_Input_R1.fastq.gz,,1,,,\nKO_INPUT,KO_Input_R2.fastq.gz,,2,,,</code></pre><p class=\"text-node\"><strong>Column Descriptions:</strong></p><ul class=\"list-node\"><li><p class=\"text-node\"><strong>sample:</strong> Unique sample name</p></li><li><p class=\"text-node\"><strong>fastq_1:</strong> Read 1 file (or single-end reads)</p></li><li><p class=\"text-node\"><strong>fastq_2:</strong> Read 2 file (leave empty for single-end)</p></li><li><p class=\"text-node\"><strong>replicate:</strong> Biological replicate number (1, 2, 3...)</p></li><li><p class=\"text-node\"><strong>antibody:</strong> Histone mark name (H3K27me3, H3K36me3, etc.)</p></li><li><p class=\"text-node\"><strong>control:</strong> Name of matching input control sample</p></li><li><p class=\"text-node\"><strong>control_replicate:</strong> Replicate number of control sample</p></li></ul><h2 class=\"heading-node\">🧬 Reference Genome Selection</h2><p class=\"text-node\">Choose appropriate genome for your organism:</p><ul class=\"list-node\"><li><p class=\"text-node\"><strong>🧑 Human:</strong> GRCh38/hg38 (latest) or GRCh37/hg19 (legacy studies)</p></li><li><p class=\"text-node\"><strong>🐭 Mouse:</strong> GRCm39/mm39 (latest) or GRCm38/mm10 (legacy)</p></li><li><p class=\"text-node\"><strong>🔬 Model organisms:</strong> Zebrafish, fly, C. elegans, yeast</p></li><li><p class=\"text-node\"><strong>🌱 Plants:</strong> Arabidopsis TAIR10, rice, maize</p></li></ul><h2 class=\"heading-node\">📊 Comprehensive Results</h2><h3 class=\"heading-node\">Peak Files</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>📍 BroadPeak files:</strong> Genomic coordinates of enriched regions (BED format)</p></li><li><p class=\"text-node\"><strong>🎯 Consensus peaks:</strong> Reproducible peaks across biological replicates</p></li><li><p class=\"text-node\"><strong>📊 Peak annotations:</strong> Gene assignments, genomic features, distances to TSS</p></li><li><p class=\"text-node\"><strong>🧮 Peak statistics:</strong> Signal enrichment, fold-change, FDR values</p></li></ul><h3 class=\"heading-node\">Visualization Tracks</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>🎨 BigWig files:</strong> Normalized signal tracks for genome browsers (IGV, UCSC)</p></li><li><p class=\"text-node\"><strong>📈 Coverage plots:</strong> Signal distribution around genes and features</p></li><li><p class=\"text-node\"><strong>🔥 Heatmaps:</strong> Signal intensity across regions of interest</p></li></ul><h3 class=\"heading-node\">Quality Control</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>📈 MultiQC Report:</strong> Comprehensive QC with interactive plots</p></li><li><p class=\"text-node\"><strong>🔍 Fragment analysis:</strong> Insert size distributions, read quality metrics</p></li><li><p class=\"text-node\"><strong>📊 Cross-correlation:</strong> Library quality scores (NSC, RSC)</p></li><li><p class=\"text-node\"><strong>✅ FRiP scores:</strong> Fraction of reads in peaks per sample</p></li><li><p class=\"text-node\"><strong>🎯 Replicate concordance:</strong> IDR analysis for reproducibility</p></li></ul><h3 class=\"heading-node\">Differential Analysis (Optional)</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>🔄 Differential binding:</strong> Changes between conditions (e.g., WT vs KO)</p></li><li><p class=\"text-node\"><strong>📊 Statistical testing:</strong> DESeq2 analysis for significant changes</p></li><li><p class=\"text-node\"><strong>🎨 Volcano plots:</strong> Visualization of differential peaks</p></li></ul><h2 class=\"heading-node\">🔬 Biological Applications</h2><ul class=\"list-node\"><li><p class=\"text-node\"><strong>🧬 Chromatin states:</strong> Map active/repressive domains across genome</p></li><li><p class=\"text-node\"><strong>🔬 Development:</strong> Track epigenetic changes during differentiation</p></li><li><p class=\"text-node\"><strong>🩺 Cancer research:</strong> Identify aberrant silencing in tumors</p></li><li><p class=\"text-node\"><strong>💊 Drug discovery:</strong> Assess epigenetic drug effects</p></li><li><p class=\"text-node\"><strong>🧫 Stem cells:</strong> Characterize pluripotency and lineage commitment</p></li><li><p class=\"text-node\"><strong>🌿 Plant biology:</strong> Study vernalization and stress responses</p></li></ul><h2 class=\"heading-node\">⚙️ Pipeline Specifications</h2><ul class=\"list-node\"><li><p class=\"text-node\"><strong>🔧 Aligner:</strong> BWA-MEM (default, robust and accurate)</p></li><li><p class=\"text-node\"><strong>📍 Peak caller:</strong> MACS2 with --broad flag (broad_cutoff = 0.1)</p></li><li><p class=\"text-node\"><strong>🎯 Duplicate handling:</strong> Marked and filtered (prevents PCR bias)</p></li><li><p class=\"text-node\"><strong>📊 Normalization:</strong> CPM (counts per million) for BigWig tracks</p></li><li><p class=\"text-node\"><strong>✅ Quality filters:</strong> MAPQ ≥ 20, properly paired reads</p></li></ul><p class=\"text-node\"><strong>Perfect for Research in:</strong> Epigenetics • Cancer biology • Developmental biology • Stem cell research • Chromatin biology • Gene regulation • Drug discovery • Plant epigenomics</p><p class=\"text-node\">Built with <a class=\"link\" href=\"https://www.nextflow.io/\" target=\"_blank\">Nextflow</a> • Powered by <a class=\"link\" href=\"https://nf-co.re/chipseq/2.1.0/\" target=\"_blank\">nf-core/chipseq v2.1.0</a> • Containerized execution • Continuous integration tested</p>",
  "imageUrl": "https://raw.githubusercontent.com/nf-core/chipseq/master/docs/images/nf-core-chipseq_logo_light.png",
  "command": "nextflow run nf-core/chipseq -r 2.1.0 --input ${input} --outdir ${output} --genome ${genome} --aligner bwa --macs_gsize ${macs_gsize} --broad_cutoff 0.1 -c /etc/mpi/nextflow.camber.config -c chipseq-histone-broad-config.config -profile singularity",
  "engineType": "NEXTFLOW",
  "jobConfig": [
    {
      "type": "Select",
      "label": "System Size",
      "name": "system_size",
      "hidden": true,
      "description": "Computational resources for your analysis",
      "options": [
        {
          "label": "Small (16 CPUs, 90GB RAM) - Test datasets only",
          "value": "small",
          "mapValue": {
            "nodeSize": "SMALL",
            "numNodes": 1,
            "withGpu": false
          }
        },
        {
          "label": "Medium (32 CPUs, 180GB RAM) - Small experiments (<5 samples)",
          "value": "medium",
          "mapValue": {
            "nodeSize": "MEDIUM",
            "numNodes": 1,
            "withGpu": false
          }
        },
        {
          "label": "Large (64 CPUs, 360GB RAM) - Standard experiments (Recommended)",
          "value": "large",
          "mapValue": {
            "nodeSize": "LARGE",
            "numNodes": 1,
            "withGpu": false
          }
        },
        {
          "label": "XLarge (96 CPUs, 540GB RAM) - Large cohorts (>20 samples)",
          "value": "xlarge",
          "mapValue": {
            "nodeSize": "XLARGE",
            "numNodes": 1,
            "withGpu": false
          }
        }
      ],
      "defaultValue": "large"
    }
  ],
  "spec": [
    {
      "type": "Stash File",
      "label": "Sample Information Sheet",
      "name": "input",
      "description": "CSV file with columns: sample, fastq_1, fastq_2, replicate, antibody, control, control_replicate. Each ChIP sample must have a matching input control.",
      "required": true
    },
    {
      "type": "Stash File",
      "label": "Output Directory",
      "name": "output",
      "description": "Where to save analysis results including peaks, BigWig tracks, and QC reports",
      "defaultValue": "./chipseq-histone-results",
      "required": true
    },
    {
      "type": "Select",
      "label": "Reference Genome",
      "name": "genome",
      "description": "Reference genome matching your organism (use GRCh38 for human, GRCm39 for mouse)",
      "defaultValue": "GRCh38",
      "required": true,
      "options": [
        {"label": "Human GRCh38/hg38 (latest)", "value": "GRCh38"},
        {"label": "Human GRCh37/hg19 (legacy)", "value": "GRCh37"},
        {"label": "Mouse GRCm39/mm39 (latest)", "value": "GRCm39"},
        {"label": "Mouse GRCm38/mm10 (legacy)", "value": "GRCm38"},
        {"label": "Rat Rnor_6.0", "value": "Rnor_6.0"},
        {"label": "Zebrafish GRCz11 (latest)", "value": "GRCz11"},
        {"label": "Zebrafish GRCz10", "value": "GRCz10"},
        {"label": "Fly BDGP6", "value": "BDGP6"},
        {"label": "C. elegans WBcel235", "value": "WBcel235"},
        {"label": "Yeast R64-1-1", "value": "R64-1-1"},
        {"label": "Arabidopsis TAIR10", "value": "TAIR10"}
      ]
    },
    {
      "type": "Select",
      "label": "Effective Genome Size",
      "name": "macs_gsize",
      "description": "MACS2 genome size parameter for peak calling. Choose based on your organism.",
      "defaultValue": "2.7e9",
      "required": true,
      "options": [
        {"label": "Human (2.7e9)", "value": "2.7e9"},
        {"label": "Mouse (1.87e9)", "value": "1.87e9"},
        {"label": "Rat (2.5e9)", "value": "2.5e9"},
        {"label": "Zebrafish (1.37e9)", "value": "1.37e9"},
        {"label": "Fly (1.2e8)", "value": "1.2e8"},
        {"label": "C. elegans (9e7)", "value": "9e7"},
        {"label": "Yeast (1.2e7)", "value": "1.2e7"},
        {"label": "Arabidopsis (1.2e8)", "value": "1.2e8"}
      ]
    }
  ],
  "tags": [
    {"name": "genomics", "type": "subfield"},
    {"name": "epigenetics", "type": "subfield"},
    {"name": "chip-seq", "type": "task"},
    {"name": "peak-calling", "type": "task"},
    {"name": "biology", "type": "field"}
  ]
}