{
  "name": "chipseq-tf-narrow",
  "title": "ChIP-seq: Transcription Factor Binding with Narrow Peaks",
  "description": "Identify transcription factor binding sites using ChIP-seq with narrow peak calling. Discover regulatory elements controlling gene expression with sharp, focused peaks characteristic of sequence-specific DNA binding proteins.",
  "content": "<h1 class=\"heading-node\">🧬 ChIP-seq: Transcription Factor Binding Site Discovery</h1><p class=\"text-node\"><strong>Uncover Where Transcription Factors Bind to Control Gene Expression</strong></p><p class=\"text-node\">Chromatin Immunoprecipitation sequencing (ChIP-seq) reveals the exact genomic locations where transcription factors bind DNA, providing crucial insights into gene regulation, cellular identity, and disease mechanisms. This pipeline uses narrow peak calling optimized for sharp, localized binding events characteristic of transcription factors.</p><img src=\"https://raw.githubusercontent.com/nf-core/chipseq/master/docs/images/nf-core-chipseq_logo_light.png\" alt=\"nf-core/chipseq workflow\" width=\"600\" height=\"300\"><h2 class=\"heading-node\">🎯 What is ChIP-seq?</h2><p class=\"text-node\">ChIP-seq combines chromatin immunoprecipitation (ChIP) with high-throughput sequencing to map protein-DNA interactions genome-wide. By using antibodies specific to your transcription factor of interest, you can:</p><ul class=\"list-node\"><li><p class=\"text-node\"><strong>📍 Identify binding sites:</strong> Discover where transcription factors bind across the entire genome</p></li><li><p class=\"text-node\"><strong>🎯 Find target genes:</strong> Determine which genes are directly regulated by your transcription factor</p></li><li><p class=\"text-node\"><strong>🔍 Discover motifs:</strong> Reveal DNA sequence motifs that recruit transcription factors</p></li><li><p class=\"text-node\"><strong>🧬 Map regulatory networks:</strong> Understand how transcription factors work together to control cell fate</p></li><li><p class=\"text-node\"><strong>🔬 Compare conditions:</strong> See how binding changes between cell types, treatments, or disease states</p></li></ul><h2 class=\"heading-node\">🧪 Narrow vs Broad Peak Calling</h2><p class=\"text-node\">This pipeline uses <strong>narrow peak calling</strong> which is specifically designed for:</p><ul class=\"list-node\"><li><p class=\"text-node\"><strong>✓ Transcription Factors:</strong> Sharp, localized binding events (typically 100-500 bp wide)</p></li><li><p class=\"text-node\"><strong>✓ Sequence-specific DNA binding proteins:</strong> Proteins that bind specific DNA motifs</p></li><li><p class=\"text-node\"><strong>✓ Examples:</strong> p53, STAT3, CTCF, NF-κB, Oct4, Sox2, Myc, estrogen receptor</p></li></ul><p class=\"text-node\"><em>Note: For histone modifications or chromatin remodelers with broader domains, use broad peak calling instead.</em></p><h2 class=\"heading-node\">📋 Sample Sheet Format</h2><p class=\"text-node\">Your CSV samplesheet defines ChIP samples and their matched input controls:</p><pre class=\"block-node\"><code>sample,fastq_1,fastq_2,replicate,antibody,control,control_replicate\nTreatmentA_ChIP,ChIP_rep1_R1.fastq.gz,ChIP_rep1_R2.fastq.gz,1,STAT3,Input,1\nTreatmentA_ChIP,ChIP_rep2_R1.fastq.gz,ChIP_rep2_R2.fastq.gz,2,STAT3,Input,2\nInput,Input_rep1_R1.fastq.gz,Input_rep1_R2.fastq.gz,1,,,\nInput,Input_rep2_R1.fastq.gz,Input_rep2_R2.fastq.gz,2,,,</code></pre><p class=\"text-node\"><strong>Column Descriptions:</strong></p><ul class=\"list-node\"><li><p class=\"text-node\"><strong>sample:</strong> Unique sample name (ChIP samples and input controls)</p></li><li><p class=\"text-node\"><strong>fastq_1:</strong> Path to forward reads (R1) FASTQ file</p></li><li><p class=\"text-node\"><strong>fastq_2:</strong> Path to reverse reads (R2) for paired-end data (optional for single-end)</p></li><li><p class=\"text-node\"><strong>replicate:</strong> Biological replicate number (1, 2, 3, etc.)</p></li><li><p class=\"text-node\"><strong>antibody:</strong> Antibody/target name for ChIP samples (leave empty for input controls)</p></li><li><p class=\"text-node\"><strong>control:</strong> Name of the input control sample to use (leave empty for input samples)</p></li><li><p class=\"text-node\"><strong>control_replicate:</strong> Which input replicate to pair with this ChIP replicate</p></li></ul><h2 class=\"heading-node\">🧬 Reference Genome Selection</h2><p class=\"text-node\">Choose the genome matching your experimental organism:</p><ul class=\"list-node\"><li><p class=\"text-node\"><strong>🧑 Human:</strong> GRCh38/hg38 (latest, recommended) or GRCh37/hg19 (legacy)</p></li><li><p class=\"text-node\"><strong>🐭 Mouse:</strong> GRCm39/mm39 (latest) or GRCm38/mm10 (widely used)</p></li><li><p class=\"text-node\"><strong>🔬 Other organisms:</strong> Rat, zebrafish, fly, worm, yeast available</p></li></ul><p class=\"text-node\">The genome is used for read alignment and peak annotation to identify which genes are near binding sites.</p><h2 class=\"heading-node\">📊 Analysis Workflow</h2><h3 class=\"heading-node\">1. Quality Control</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>FastQC:</strong> Assess raw read quality, adapter content, and sequencing metrics</p></li><li><p class=\"text-node\"><strong>Trim adapters:</strong> Remove Illumina adapters and low-quality bases</p></li></ul><h3 class=\"heading-node\">2. Alignment</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>BWA-MEM:</strong> Align reads to reference genome with optimized ChIP-seq settings</p></li><li><p class=\"text-node\"><strong>Remove duplicates:</strong> Mark and remove PCR duplicates to avoid bias</p></li><li><p class=\"text-node\"><strong>Filter alignments:</strong> Keep high-quality uniquely mapped reads</p></li></ul><h3 class=\"heading-node\">3. Peak Calling with MACS2</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Narrow peak mode:</strong> Identify sharp, localized transcription factor binding events</p></li><li><p class=\"text-node\"><strong>ChIP vs Input:</strong> Compare ChIP signal to input control to find true binding sites</p></li><li><p class=\"text-node\"><strong>Statistical significance:</strong> Use q-value thresholds (FDR < 0.05) to filter peaks</p></li><li><p class=\"text-node\"><strong>Consensus peaks:</strong> Merge peaks across replicates for robust binding sites</p></li></ul><h3 class=\"heading-node\">4. Peak Annotation</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Gene assignment:</strong> Identify nearest genes to each peak</p></li><li><p class=\"text-node\"><strong>Genomic distribution:</strong> Classify peaks as promoter, intron, exon, intergenic</p></li><li><p class=\"text-node\"><strong>Motif discovery:</strong> Find enriched DNA sequence motifs in peak regions</p></li></ul><h2 class=\"heading-node\">📊 Results and Outputs</h2><h3 class=\"heading-node\">Peak Files</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>📍 Peak coordinates:</strong> BED/narrowPeak files with genomic locations of binding sites</p></li><li><p class=\"text-node\"><strong>🎯 Consensus peaks:</strong> High-confidence peaks present across biological replicates</p></li><li><p class=\"text-node\"><strong>📊 Peak summits:</strong> Exact center position of each binding event</p></li><li><p class=\"text-node\"><strong>📈 Signal tracks:</strong> BigWig files for genome browser visualization</p></li></ul><h3 class=\"heading-node\">Quality Metrics</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>📈 MultiQC Report:</strong> Comprehensive quality control summary with interactive plots</p></li><li><p class=\"text-node\"><strong>🔍 Fragment size distribution:</strong> Verify expected DNA fragment sizes (~200 bp)</p></li><li><p class=\"text-node\"><strong>📊 Peak statistics:</strong> Number of peaks, peak widths, signal strength</p></li><li><p class=\"text-node\"><strong>🎯 Enrichment metrics:</strong> Fraction of reads in peaks (FRiP), signal-to-noise ratios</p></li></ul><h3 class=\"heading-node\">Biological Insights</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>🧬 Target gene lists:</strong> Genes likely regulated by your transcription factor</p></li><li><p class=\"text-node\"><strong>🔍 Binding motifs:</strong> DNA sequences recognized by the transcription factor</p></li><li><p class=\"text-node\"><strong>📍 Peak annotations:</strong> Functional context of binding sites (promoters, enhancers, etc.)</p></li><li><p class=\"text-node\"><strong>📊 Differential binding:</strong> Changes in binding between experimental conditions</p></li></ul><h2 class=\"heading-node\">🧪 Experimental Design Tips</h2><ul class=\"list-node\"><li><p class=\"text-node\"><strong>🔬 Use biological replicates:</strong> At least 2 replicates for robust peak calling</p></li><li><p class=\"text-node\"><strong>🎯 Include input controls:</strong> Matched input DNA controls essential for peak calling</p></li><li><p class=\"text-node\"><strong>📊 Sequencing depth:</strong> Aim for 20-40 million reads per sample</p></li><li><p class=\"text-node\"><strong>✓ Antibody validation:</strong> Use validated antibodies with proven ChIP-seq performance</p></li><li><p class=\"text-node\"><strong>🧬 Fragment size:</strong> Target 200-500 bp DNA fragments during library prep</p></li></ul><h2 class=\"heading-node\">🔬 Common Research Applications</h2><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Gene regulation:</strong> Understand how transcription factors control gene expression programs</p></li><li><p class=\"text-node\"><strong>Development:</strong> Map transcription factor binding during cell differentiation</p></li><li><p class=\"text-node\"><strong>Disease mechanisms:</strong> Identify aberrant transcription factor binding in cancer or disease</p></li><li><p class=\"text-node\"><strong>Drug discovery:</strong> Find genes regulated by drug-targeted transcription factors</p></li><li><p class=\"text-node\"><strong>Stem cell biology:</strong> Study pluripotency factors like Oct4, Sox2, Nanog</p></li><li><p class=\"text-node\"><strong>Immunology:</strong> Investigate immune transcription factors like NF-κB, STAT proteins</p></li><li><p class=\"text-node\"><strong>Cancer biology:</strong> Analyze oncogenic transcription factors like Myc, p53 mutations</p></li></ul><p class=\"text-node\"><strong>Perfect for researchers studying:</strong> Gene regulation • Epigenetics • Developmental biology • Cancer biology • Stem cells • Immunology • Chromatin biology • Transcriptional networks</p><p class=\"text-node\">Built with <a class=\"link\" href=\"https://www.nextflow.io/\" target=\"_blank\">Nextflow</a> • Powered by <a class=\"link\" href=\"https://nf-co.re/chipseq/2.0.0/\" target=\"_blank\">nf-core/chipseq v2.0.0</a> • Peak calling by <a class=\"link\" href=\"https://github.com/macs3-project/MACS\" target=\"_blank\">MACS3</a> • Containerized execution • Publication-ready results</p>",
  "imageUrl": "https://raw.githubusercontent.com/nf-core/chipseq/master/docs/images/nf-core-chipseq_logo_light.png",
  "command": "nextflow run nf-core/chipseq --input ${input} --outdir ${outdir} --genome ${genome} --macs_gsize 2.7e9 --narrow_peak true -r 2.0.0 ",
  "engineType": "NEXTFLOW",
  "jobConfig": [
    {
      "type": "Select",
      "label": "System Size",
      "name": "system_size",
      "hidden": true,
      "description": "Select compute resources. Start with XSMALL for testing, scale up for production data.",
      "options": [
        {
          "label": "XSMALL (4 CPUs, 15GB RAM) - Testing/nf-core test data",
          "value": "xsmall",
          "mapValue": {
            "nodeSize": "XSMALL",
            "numNodes": 1,
            "withGpu": false
          }
        },
        {
          "label": "SMALL (8 CPUs, 30GB RAM) - Small datasets (1-3 samples)",
          "value": "small",
          "mapValue": {
            "nodeSize": "SMALL",
            "numNodes": 1,
            "withGpu": false
          }
        },
        {
          "label": "MEDIUM (32 CPUs, 120GB RAM) - Standard datasets (5-20 samples)",
          "value": "medium",
          "mapValue": {
            "nodeSize": "MEDIUM",
            "numNodes": 1,
            "withGpu": false
          }
        },
        {
          "label": "LARGE (64 CPUs, 360GB RAM) - Large datasets (20-50 samples)",
          "value": "large",
          "mapValue": {
            "nodeSize": "LARGE",
            "numNodes": 1,
            "withGpu": false
          }
        }
      ],
      "defaultValue": "xsmall"
    }
  ],
  "spec": [
    {
      "type": "Stash File",
      "label": "Sample Sheet",
      "name": "input",
      "description": "CSV file with columns: sample, fastq_1, fastq_2, replicate, antibody, control, control_replicate. Each row represents a ChIP sample or input control.",
      "required": true,
      "restrictions": {
        "allow_files": true,
        "allow_folders": false,
        "allowed_file_types": [".csv"]
      }
    },
    {
      "type": "Stash File",
      "label": "Output Directory",
      "name": "outdir",
      "description": "Directory where analysis results, peak files, and reports will be saved",
      "defaultValue": "./chipseq-tf-narrow-results",
      "required": true,
      "restrictions": {
        "allow_files": false,
        "allow_folders": true,
        "allowed_file_types": []
      }
    },
    {
      "type": "Select",
      "label": "Reference Genome",
      "name": "genome",
      "description": "Reference genome matching your experimental organism. Use GRCh38 for human, GRCm39 for mouse.",
      "defaultValue": "GRCh38",
      "required": true,
      "options": [
        {"label": "Human GRCh38/hg38 (latest, recommended)", "value": "GRCh38"},
        {"label": "Human GRCh37/hg19 (legacy)", "value": "GRCh37"},
        {"label": "Mouse GRCm39/mm39 (latest)", "value": "GRCm39"},
        {"label": "Mouse GRCm38/mm10 (widely used)", "value": "GRCm38"},
        {"label": "Rat Rnor_6.0", "value": "Rnor_6.0"},
        {"label": "Zebrafish GRCz11", "value": "GRCz11"},
        {"label": "Fruit Fly BDGP6", "value": "BDGP6"},
        {"label": "C. elegans WBcel235", "value": "WBcel235"},
        {"label": "Yeast R64-1-1", "value": "R64-1-1"}
      ]
    }
  ],
  "tags": [
    {"name": "genomics", "type": "subfield"},
    {"name": "chipseq", "type": "task"},
    {"name": "epigenetics", "type": "task"},
    {"name": "biology", "type": "field"}
  ]
}