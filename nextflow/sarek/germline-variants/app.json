{
  "name": "sarek-germline-variants",
  "title": "Sarek Germline Variant Calling",
  "description": "Comprehensive germline variant calling from WGS/WES data. Detects SNVs and indels using GATK HaplotypeCaller, Strelka, or DeepVariant with best-practice preprocessing.",
  "version": "1.0.0",
  "engineType": "NEXTFLOW",
  "command": "nextflow run nf-core/sarek --input ${input} --outdir ${outdir} --genome ${genome} --tools ${tools} -r 3.5.1 ",
  "imageUrl": "https://raw.githubusercontent.com/nf-core/sarek/master/docs/images/nf-core-sarek_logo_light.png",
  "content": "<h2><strong>Sarek Germline Variant Calling</strong></h2><p><strong>Sarek</strong> is a comprehensive variant calling pipeline implementing GATK best practices for germline variant detection from whole genome or exome sequencing. Identifies inherited mutations for clinical diagnostics and population studies.</p><h3><strong>What is Germline Variant Calling?</strong></h3><blockquote><p><strong>Germline variants</strong> are inherited DNA changes present in every cell of the body (passed from parents or arising during early development). Unlike somatic mutations that occur only in specific tissues, germline variants can be passed to offspring.</p></blockquote><h3><strong>Why Germline Variant Calling?</strong></h3><ul><li><strong>Clinical Diagnostics</strong>: Identify disease-causing mutations (Mendelian disorders)</li><li><strong>Cancer Predisposition</strong>: BRCA1/2, Lynch syndrome, Li-Fraumeni</li><li><strong>Pharmacogenomics</strong>: Drug metabolism variants (CYP2D6, DPYD)</li><li><strong>Population Genetics</strong>: Study human diversity, evolution</li><li><strong>Family Studies</strong>: Trace inheritance patterns</li><li><strong>Research</strong>: Gene function, disease associations</li></ul><h3><strong>Pipeline Workflow</strong></h3><ol><li><strong>Quality Control</strong>: FastQC assesses read quality</li><li><strong>Trimming</strong>: Remove adapters, low-quality bases</li><li><strong>Alignment</strong>: BWA-MEM2 maps reads to reference genome</li><li><strong>Mark Duplicates</strong>: Identify PCR/optical duplicates (Picard/GATK)</li><li><strong>Base Quality Recalibration</strong>: GATK BQSR corrects systematic errors</li><li><strong>Variant Calling</strong>: HaplotypeCaller, Strelka, DeepVariant, or Freebayes</li><li><strong>Filtering</strong>: GATK VariantFiltration (VQSR for WGS)</li><li><strong>Annotation</strong>: VEP, SnpEff add functional consequences</li><li><strong>QC Report</strong>: MultiQC aggregates all metrics</li></ol><h3><strong>Variant Callers</strong></h3><p><strong>GATK HaplotypeCaller</strong> (default):</p><ul><li>Gold standard for germline calling</li><li>Local de novo assembly around variants</li><li>Handles complex regions (indels, MNPs)</li><li>Joint genotyping across cohorts</li></ul><p><strong>DeepVariant</strong>:</p><ul><li>Google's deep learning caller</li><li>Often higher accuracy than GATK</li><li>Pre-trained models for WGS, WES, PacBio</li><li>No training data required</li></ul><p><strong>Strelka2</strong>:</p><ul><li>Fast germline caller</li><li>Good for large cohorts</li><li>Lower resource usage</li></ul><p><strong>Freebayes</strong>:</p><ul><li>Haplotype-based caller</li><li>Good for pooled samples</li><li>Detects complex variants</li></ul><h3><strong>Scientific Applications</strong></h3><p><strong>Rare Disease Diagnosis</strong>:</p><ul><li>Identify causal variants in ~30% of rare disease cases</li><li>Trio analysis (parents + proband)</li><li>Filter by inheritance pattern, gene lists</li><li><strong>Examples</strong>: Cystic fibrosis (CFTR), DMD, BRCA1/2</li></ul><p><strong>Cancer Predisposition</strong>:</p><ul><li>Hereditary cancer syndromes</li><li><strong>BRCA1/2</strong>: Breast/ovarian cancer (10-20x risk)</li><li><strong>Lynch syndrome</strong>: Colorectal cancer (MLH1, MSH2)</li><li><strong>Li-Fraumeni</strong>: Multiple cancers (TP53)</li></ul><p><strong>Pharmacogenomics</strong>:</p><ul><li><strong>CYP2D6</strong>: Metabolizes 25% of drugs (codeine, tamoxifen)</li><li><strong>DPYD</strong>: 5-FU toxicity (cancer chemotherapy)</li><li><strong>HLA-B*57:01</strong>: Abacavir hypersensitivity</li><li><strong>TPMT</strong>: Thiopurine toxicity</li></ul><p><strong>Population Studies</strong>:</p><ul><li>1000 Genomes, gnomAD, UK Biobank</li><li>Allele frequency estimation</li><li>Evolutionary genetics</li></ul><h3><strong>Variant Types Detected</strong></h3><ul><li><strong>SNVs</strong>: Single nucleotide variants (e.g., A→G)</li><li><strong>Indels</strong>: Insertions/deletions (1-50bp)</li><li><strong>MNPs</strong>: Multi-nucleotide polymorphisms</li><li><strong>Complex variants</strong>: Multiple changes in vicinity</li></ul><p><em>Note: Structural variants (>50bp) require specialized callers (Manta, DELLY)</em></p><h3><strong>Sequencing Requirements</strong></h3><table><tr><th>Analysis Type</th><th>Coverage</th><th>Variant Detection</th></tr><tr><td><strong>WGS (Whole Genome)</strong></td><td>30-40X</td><td>~4-5M variants per individual</td></tr><tr><td><strong>WES (Exome)</strong></td><td>100-150X</td><td>~20-30K coding variants</td></tr><tr><td><strong>Targeted Panel</strong></td><td>500-1000X</td><td>Genes of interest</td></tr></table><h3><strong>Quality Metrics</strong></h3><ul><li><strong>Coverage</strong>: % of genome/exome with ≥20X depth</li><li><strong>Mapping Quality</strong>: >90% reads with MAPQ≥20</li><li><strong>Duplication Rate</strong>: <20% for WGS, <40% for exomes</li><li><strong>Ti/Tv Ratio</strong>: ~2.0-2.1 for WGS (quality indicator)</li><li><strong>Het/Hom Ratio</strong>: ~1.5-2.0 for outbred populations</li></ul><h3><strong>Variant Filtering</strong></h3><p><strong>Hard Filters</strong> (small datasets):</p><ul><li>Quality score (QUAL > 30)</li><li>Depth (DP > 10)</li><li>Mapping quality (MQ > 40)</li><li>Strand bias, base quality bias</li></ul><p><strong>VQSR</strong> (Variant Quality Score Recalibration):</p><ul><li>Machine learning approach</li><li>Requires ≥30 WGS samples</li><li>Uses known variants (dbSNP, HapMap)</li><li>Recommended for large cohorts</li></ul><h3><strong>Annotation</strong></h3><p>VEP (Variant Effect Predictor) / SnpEff annotate:</p><ul><li><strong>Gene/transcript</strong>: Which gene is affected</li><li><strong>Consequence</strong>: Missense, nonsense, splice site, etc.</li><li><strong>Population frequency</strong>: gnomAD, 1000 Genomes</li><li><strong>Pathogenicity</strong>: SIFT, PolyPhen, CADD scores</li><li><strong>Clinical significance</strong>: ClinVar, OMIM</li></ul><h3><strong>Clinical Interpretation</strong></h3><blockquote><p><strong>ACMG Guidelines</strong> for variant classification:</p><ul><li><strong>Pathogenic</strong>: Disease-causing</li><li><strong>Likely Pathogenic</strong>: High confidence</li><li><strong>VUS</strong>: Variant of Uncertain Significance</li><li><strong>Likely Benign</strong>: Probably not disease-causing</li><li><strong>Benign</strong>: Not disease-causing</li></ul><p>Criteria include: population frequency, functional predictions, segregation, experimental evidence</p></blockquote><h3><strong>Input Requirements</strong></h3><p>CSV samplesheet with columns:</p><ul><li><strong>patient</strong>: Patient ID</li><li><strong>sample</strong>: Sample ID</li><li><strong>fastq_1</strong>: Path to R1 FASTQ</li><li><strong>fastq_2</strong>: Path to R2 FASTQ</li><li><strong>status</strong>: 0 (normal) - for germline</li></ul><h3><strong>Key Outputs</strong></h3><ul><li><strong>VCF Files</strong>: Variant calls (per-sample and cohort)</li><li><strong>Annotated VCF</strong>: With VEP/SnpEff functional annotations</li><li><strong>BAM Files</strong>: Aligned, recalibrated reads</li><li><strong>QC Reports</strong>: Coverage, mapping, variant statistics</li><li><strong>MultiQC</strong>: Aggregated HTML report</li></ul><blockquote><p><strong>Perfect for:</strong> Rare disease diagnosis • Cancer predisposition • Pharmacogenomics • Clinical WGS/WES • Population genetics</p></blockquote>",
  "spec": [
    {
      "type": "Stash File",
      "label": "Sample Sheet",
      "name": "input",
      "description": "CSV with patient samples (WGS/WES data)",
      "required": true,
      "restrictions": {
        "allow_files": true,
        "allow_folders": false,
        "allowed_file_types": [".csv"]
      }
    },
    {
      "type": "Select",
      "label": "Reference Genome",
      "name": "genome",
      "description": "Reference genome",
      "defaultValue": "GRCh38",
      "required": true,
      "options": [
        {"label": "Human GRCh38", "value": "GRCh38"},
        {"label": "Human GRCh37", "value": "GRCh37"},
        {"label": "Mouse GRCm39", "value": "GRCm39"}
      ]
    },
    {
      "type": "Select",
      "label": "Variant Calling Tools",
      "name": "tools",
      "description": "Variant callers to use",
      "defaultValue": "haplotypecaller",
      "required": true,
      "options": [
        {"label": "GATK HaplotypeCaller", "value": "haplotypecaller"},
        {"label": "DeepVariant", "value": "deepvariant"},
        {"label": "Strelka2", "value": "strelka"},
        {"label": "Freebayes", "value": "freebayes"},
        {"label": "All Callers", "value": "haplotypecaller,deepvariant,strelka,freebayes"}
      ]
    },
    {
      "type": "Stash File",
      "label": "Output Directory",
      "name": "outdir",
      "description": "Output directory",
      "defaultValue": "./sarek-germline-results",
      "required": true,
      "restrictions": {
        "allow_files": false,
        "allow_folders": true
      }
    }
  ],
  "jobConfig": [
    {
      "type": "Select",
      "label": "Compute Resources",
      "name": "system_size",
      "hidden": false,
      "options": [
        {"label": "XLARGE (Recommended for WGS)", "value": "xlarge", "mapValue": {"nodeSize": "XLARGE", "numNodes": 1, "withGpu": false}},
        {"label": "LARGE (For WES/Panels)", "value": "large", "mapValue": {"nodeSize": "LARGE", "numNodes": 1, "withGpu": false}}
      ],
      "defaultValue": "xlarge"
    }
  ],
  "tags": [
    {"name": "variant-calling", "type": "field"},
    {"name": "germline", "type": "task"},
    {"name": "wgs-wes", "type": "task"}
  ]
}
