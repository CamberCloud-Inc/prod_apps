{
  "name": "scflow-cell-type-annotation",
  "title": "Automated Cell Type Annotation for Single-Cell RNA-seq",
  "description": "Complete single-cell RNA-seq analysis with automated cell type annotation using reference-based methods, dimensionality reduction, clustering, and differential expression analysis. Samplesheet format: `conditions,batch`",
  "content": "<h1 class=\"heading-node\">🔬 scFlow: Automated Cell Type Annotation Pipeline</h1><p class=\"text-node\"><strong>Comprehensive Single-Cell RNA-seq Analysis with Intelligent Cell Type Discovery</strong></p><p class=\"text-node\">scFlow delivers a complete, scalable, and reproducible workflow for single-cell and single-nucleus RNA sequencing data analysis. Built on best-practice algorithms and powered by Nextflow, it seamlessly orchestrates quality control, dataset integration, automated cell type annotation, and differential expression analysis—all from a single command.</p><img src=\"https://raw.githubusercontent.com/nf-core/scflow/dev/docs/images/scflow_workflow.png\" alt=\"scFlow workflow diagram\" width=\"700\" height=\"450\"><h2 class=\"heading-node\">🎯 What is it?</h2><p class=\"text-node\">scFlow is a bioinformatics pipeline designed for scalable, reproducible analysis of single-cell/nuclei RNA-sequencing data. It transforms raw gene-cell count matrices into publication-ready results including cell type annotations, differential gene expression, and pathway analysis. The pipeline integrates popular single-cell R packages including <strong>Seurat</strong>, <strong>Monocle</strong>, <strong>scater</strong>, <strong>LIGER</strong>, and <strong>MAST</strong> into an automated, enterprise-ready workflow.</p><h2 class=\"heading-node\">✨ Key Features</h2><h3 class=\"heading-node\">🧬 Automated Cell Type Annotation</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Reference-Based Methods:</strong> Leverages curated reference atlases for accurate cell type identification</p></li><li><p class=\"text-node\"><strong>Marker Gene Analysis:</strong> Comprehensive characterization of cell type-specific markers</p></li><li><p class=\"text-node\"><strong>Rich Metrics:</strong> Detailed cell type quality metrics and confidence scores</p></li><li><p class=\"text-node\"><strong>Multiple Approaches:</strong> Supports correlation-based and classifier-based annotation strategies</p></li></ul><h3 class=\"heading-node\">📊 Complete Quality Control</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Individual Sample QC:</strong> Per-sample quality assessment and filtering</p></li><li><p class=\"text-node\"><strong>Merged Dataset QC:</strong> Post-integration quality validation</p></li><li><p class=\"text-node\"><strong>Empty Droplet Detection:</strong> Integrated emptyDrops algorithm</p></li><li><p class=\"text-node\"><strong>Doublet Removal:</strong> Automatic doublet detection with DoubletFinder</p></li></ul><h3 class=\"heading-node\">🔄 Dataset Integration & Batch Correction</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Multi-Sample Integration:</strong> Seamlessly merge datasets from multiple samples</p></li><li><p class=\"text-node\"><strong>Batch Effect Correction:</strong> LIGER-based integration removes technical artifacts</p></li><li><p class=\"text-node\"><strong>Harmonized Analysis:</strong> Unified analysis across experimental conditions</p></li></ul><h3 class=\"heading-node\">🎨 Advanced Visualization</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>UMAP & t-SNE:</strong> Flexible dimensionality reduction for data exploration</p></li><li><p class=\"text-node\"><strong>Interactive Plots:</strong> Automated generation of publication-quality visualizations</p></li><li><p class=\"text-node\"><strong>HTML Reports:</strong> Comprehensive interactive reports for each analysis stage</p></li></ul><h3 class=\"heading-node\">🧪 Differential Expression & Pathways</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Flexible DE Analysis:</strong> Case/control comparisons with statistical rigor (MAST)</p></li><li><p class=\"text-node\"><strong>Pathway Enrichment:</strong> Impacted pathway analysis reveals biological mechanisms</p></li><li><p class=\"text-node\"><strong>Cluster-Based Analysis:</strong> Leiden/Louvain community detection for cell clustering</p></li></ul><h2 class=\"heading-node\">🔬 Pipeline Workflow</h2><ol class=\"list-node\"><li><p class=\"text-node\"><strong>Input Processing:</strong> Accepts post-demultiplexed sparse gene-cell count matrices</p></li><li><p class=\"text-node\"><strong>Sample-Level QC:</strong> Individual quality control and filtering per sample</p></li><li><p class=\"text-node\"><strong>Integration:</strong> Merge and batch-correct datasets using LIGER</p></li><li><p class=\"text-node\"><strong>Dimensionality Reduction:</strong> UMAP and/or t-SNE projection</p></li><li><p class=\"text-node\"><strong>Clustering:</strong> Leiden/Louvain community detection identifies cell populations</p></li><li><p class=\"text-node\"><strong>Cell Type Annotation:</strong> Automated annotation using reference-based methods</p></li><li><p class=\"text-node\"><strong>Differential Expression:</strong> Statistical testing between conditions</p></li><li><p class=\"text-node\"><strong>Pathway Analysis:</strong> Biological pathway enrichment and interpretation</p></li><li><p class=\"text-node\"><strong>Reporting:</strong> Comprehensive HTML reports and publication-ready outputs</p></li></ol><h2 class=\"heading-node\">🧪 Scientific Applications</h2><p class=\"text-node\">scFlow empowers cutting-edge research across diverse biological domains:</p><ul class=\"list-node\"><li><p class=\"text-node\"><strong>🧬 Immunology:</strong> Immune cell population characterization and response profiling</p></li><li><p class=\"text-node\"><strong>🧠 Neuroscience:</strong> Neuronal subtype identification and brain region mapping</p></li><li><p class=\"text-node\"><strong>🦠 Cancer Research:</strong> Tumor microenvironment analysis and cancer cell heterogeneity</p></li><li><p class=\"text-node\"><strong>🫀 Developmental Biology:</strong> Cell lineage tracing and differentiation trajectories</p></li><li><p class=\"text-node\"><strong>🧫 Stem Cell Research:</strong> Characterization of pluripotency and differentiation states</p></li><li><p class=\"text-node\"><strong>💊 Drug Discovery:</strong> Target identification and drug response profiling</p></li><li><p class=\"text-node\"><strong>🔬 Disease Modeling:</strong> Pathological cell state identification and mechanism discovery</p></li></ul><h2 class=\"heading-node\">📥 Inputs</h2><h3 class=\"heading-node\">Required Files</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Gene-Cell Count Matrices:</strong> Sparse matrices in H5, MTX, or CSV format</p></li><li><p class=\"text-node\"><strong>Sample Metadata:</strong> Experimental conditions, batch information, sample annotations</p></li><li><p class=\"text-node\"><strong>Reference Dataset:</strong> Curated reference atlas for cell type annotation (optional but recommended)</p></li></ul><h3 class=\"heading-node\">Supported Input Formats</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>10x Genomics:</strong> CellRanger output (HDF5, MEX)</p></li><li><p class=\"text-node\"><strong>Alevin/Salmon:</strong> Quantification matrices</p></li><li><p class=\"text-node\"><strong>STARsolo:</strong> Gene expression matrices</p></li><li><p class=\"text-node\"><strong>Custom Formats:</strong> Any sparse matrix format with gene and cell annotations</p></li></ul><h2 class=\"heading-node\">📤 Outputs</h2><h3 class=\"heading-node\">🔍 Cell Type Annotations</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Annotated Cell Data:</strong> Each cell labeled with predicted cell type</p></li><li><p class=\"text-node\"><strong>Confidence Scores:</strong> Annotation confidence metrics per cell</p></li><li><p class=\"text-node\"><strong>Marker Gene Lists:</strong> Top markers defining each cell type</p></li><li><p class=\"text-node\"><strong>Cell Type Composition:</strong> Proportions across samples and conditions</p></li></ul><h3 class=\"heading-node\">📊 Analysis Objects</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Seurat Objects:</strong> Complete analysis saved in Seurat format for R</p></li><li><p class=\"text-node\"><strong>AnnData Files:</strong> Python-compatible format for scanpy integration</p></li><li><p class=\"text-node\"><strong>Loom Files:</strong> Universal format for data sharing</p></li></ul><h3 class=\"heading-node\">📈 Visualizations & Reports</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>UMAP/t-SNE Plots:</strong> Cell type-colored dimensionality reduction plots</p></li><li><p class=\"text-node\"><strong>QC Metrics:</strong> Comprehensive quality control visualizations</p></li><li><p class=\"text-node\"><strong>Differential Expression:</strong> Volcano plots, heatmaps, MA plots</p></li><li><p class=\"text-node\"><strong>Pathway Enrichment:</strong> Enrichment plots and pathway networks</p></li><li><p class=\"text-node\"><strong>Interactive HTML Reports:</strong> Stage-specific analysis summaries</p></li></ul><h3 class=\"heading-node\">🔬 Statistical Results</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>DE Gene Tables:</strong> Differential expression results with statistics</p></li><li><p class=\"text-node\"><strong>Pathway Results:</strong> Enriched pathways with p-values and gene sets</p></li><li><p class=\"text-node\"><strong>Cluster Markers:</strong> Defining genes for each cluster/cell type</p></li><li><p class=\"text-node\"><strong>QC Metrics:</strong> Per-cell and per-gene quality statistics</p></li></ul><blockquote class=\"blockquote-node\"><p class=\"text-node\"><strong>Perfect for:</strong> Research teams conducting case-control single-cell studies who need automated, reproducible cell type identification combined with downstream differential expression and pathway analysis. Ideal for immunologists, neuroscientists, cancer researchers, and developmental biologists analyzing cellular heterogeneity across experimental conditions on local workstations, HPC clusters, or cloud platforms (AWS, GCP, Azure, Kubernetes).</p></blockquote><p class=\"text-node\"><strong>Deployment Flexibility:</strong> Run anywhere from local workstations to high-performance computing clusters and cloud platforms including Google Cloud, Amazon Web Services, Microsoft Azure, and Kubernetes—all with a single command.</p><p class=\"text-node\">Built with <a class=\"link\" href=\"https://www.nextflow.io/\" target=\"_blank\">Nextflow</a> • Powered by <a class=\"link\" href=\"https://nf-co.re/scflow/dev/\" target=\"_blank\">nf-core/scflow</a> • Containerized execution • Continuous integration tested</p><p class=\"text-node\"><em>Note: The nf-core/scflow pipeline is in development. For production use, consider nf-core/scdownstream as an alternative.</em></p>",
  "imageUrl": "https://raw.githubusercontent.com/nf-core/scflow/dev/docs/images/nf-core-scflow_logo_light.png",
  "command": "mkdir -p ${outputDir} && cd ${outputDir} && rm -rf prod_apps && git clone https://github.com/CamberCloud-Inc/prod_apps.git && cp prod_apps/nextflow/scflow/cell-type-annotation/platform-constrained-config.config ./ && rm -rf prod_apps && nextflow run nf-core/scflow -r 1.0.0 --input ${input} --outdir results --manifest ${manifest} --genome ${genome} --celltype_reference ${celltype_reference} -c /etc/mpi/nextflow.camber.config -c platform-constrained-config.config -profile k8s && echo \"Pipeline completed\"",
  "engineType": "NEXTFLOW",
  "jobConfig": [
    {
      "type": "Select",
      "label": "System Size",
      "name": "system_size",
      "hidden": true,
      "description": "Computational resources allocation for single-cell analysis",
      "options": [
        {
          "label": "Large (64 CPUs, 360GB RAM) - Standard datasets",
          "value": "large",
          "mapValue": {
            "nodeSize": "LARGE",
            "numNodes": 1,
            "withGpu": false
          }
        },
        {
          "label": "XLarge (96 CPUs, 540GB RAM) - Large cohorts (Recommended)",
          "value": "xlarge",
          "mapValue": {
            "nodeSize": "XLARGE",
            "numNodes": 1,
            "withGpu": false
          }
        },
        {
          "label": "XXLarge (128 CPUs, 720GB RAM) - Very large datasets",
          "value": "xxlarge",
          "mapValue": {
            "nodeSize": "XXLARGE",
            "numNodes": 1,
            "withGpu": false
          }
        }
      ],
      "defaultValue": "xlarge"
    }
  ],
  "spec": [
    {
      "type": "Stash File",
      "label": "Input Count Matrices",
      "name": "input",
      "description": "Directory containing gene-cell count matrices (H5, MTX, CSV formats from CellRanger, STARsolo, Alevin, etc.)",
      "defaultValue": "",
      "hidden": false,
      "required": true,
      "disabled": false,
      "restrictions": {
        "allow_files": true,
        "allow_folders": true,
        "allowed_file_types": []
      }
    },
    {
      "type": "Stash File",
      "label": "Sample Manifest",
      "name": "manifest",
      "description": "CSV manifest with sample metadata: sample_id, condition, batch, replicate, and other experimental annotations.",
      "defaultValue": "",
      "hidden": false,
      "required": true,
      "disabled": false,
      "restrictions": {
        "allow_files": true,
        "allow_folders": true,
        "allowed_file_types": [
          ".csv",
          ".tsv"
        ]
      }
    },
    {
      "type": "Stash File",
      "label": "Output Directory",
      "name": "outputDir",
      "description": "Output directory for all analysis results including annotated datasets, plots, and reports.",
      "defaultValue": "./",
      "hidden": false,
      "required": true,
      "disabled": false,
      "restrictions": {
        "allow_files": true,
        "allow_folders": true,
        "allowed_file_types": []
      }
    },
    {
      "type": "Select",
      "label": "Reference Genome",
      "name": "genome",
      "description": "Reference genome for gene annotation and feature mapping.",
      "defaultValue": "GRCh38",
      "hidden": false,
      "required": true,
      "disabled": false,
      "options": [
        {
          "label": "Human GRCh38 (NCBI) - Most Common",
          "value": "GRCh38"
        },
        {
          "label": "Human GRCh37 (Ensembl)",
          "value": "GRCh37"
        },
        {
          "label": "Human hg38 (UCSC)",
          "value": "hg38"
        },
        {
          "label": "Human hg19 (UCSC)",
          "value": "hg19"
        },
        {
          "label": "Mouse GRCm39 (Ensembl) - Latest",
          "value": "GRCm39"
        },
        {
          "label": "Mouse GRCm38 (Ensembl)",
          "value": "GRCm38"
        },
        {
          "label": "Mouse mm39 (UCSC)",
          "value": "mm39"
        },
        {
          "label": "Mouse mm10 (UCSC)",
          "value": "mm10"
        },
        {
          "label": "Rat Rnor_6.0 (Ensembl)",
          "value": "Rnor_6.0"
        },
        {
          "label": "Zebrafish GRCz11 (Ensembl)",
          "value": "GRCz11"
        },
        {
          "label": "Zebrafish GRCz10 (Ensembl)",
          "value": "GRCz10"
        },
        {
          "label": "Fly BDGP6 (Ensembl)",
          "value": "BDGP6"
        },
        {
          "label": "C. elegans WBcel235 (Ensembl)",
          "value": "WBcel235"
        },
        {
          "label": "Yeast R64-1-1 (Ensembl)",
          "value": "R64-1-1"
        }
      ]
    },
    {
      "type": "Select",
      "label": "Cell Type Reference Atlas",
      "name": "celltype_reference",
      "description": "Reference dataset for automated cell type annotation. Choose atlas matching your tissue type.",
      "defaultValue": "pbmc",
      "hidden": false,
      "required": true,
      "disabled": false,
      "options": [
        {
          "label": "PBMC (Peripheral Blood Mononuclear Cells) - Immune cells",
          "value": "pbmc"
        },
        {
          "label": "Human Motor Cortex - Brain tissue",
          "value": "motor_cortex"
        },
        {
          "label": "Human Fetal Development - Developmental stages",
          "value": "fetal_development"
        },
        {
          "label": "Bone Marrow - Hematopoietic cells",
          "value": "bone_marrow"
        },
        {
          "label": "Kidney - Renal cell types",
          "value": "kidney"
        },
        {
          "label": "Lung - Respiratory tissue",
          "value": "lung"
        },
        {
          "label": "Heart - Cardiac cells",
          "value": "heart"
        },
        {
          "label": "Pancreas - Endocrine/exocrine cells",
          "value": "pancreas"
        },
        {
          "label": "Custom Reference - Upload your own atlas",
          "value": "custom"
        },
        {
          "label": "None - Skip automated annotation",
          "value": "none"
        }
      ]
    },
    {
      "type": "Stash File",
      "label": "Custom Reference Atlas (Optional)",
      "name": "custom_reference",
      "description": "Custom reference dataset in Seurat RDS or H5AD format (only when 'Custom Reference' selected above).",
      "defaultValue": "",
      "hidden": false,
      "required": false,
      "disabled": false,
      "restrictions": {
        "allow_files": true,
        "allow_folders": false,
        "allowed_file_types": [
          ".rds",
          ".h5ad",
          ".h5"
        ]
      }
    },
    {
      "type": "Select",
      "label": "Integration Method",
      "name": "integration_method",
      "description": "Batch correction and dataset integration algorithm.",
      "defaultValue": "liger",
      "hidden": false,
      "required": false,
      "disabled": false,
      "options": [
        {
          "label": "LIGER - Recommended for multiple batches",
          "value": "liger"
        },
        {
          "label": "Harmony - Fast integration",
          "value": "harmony"
        },
        {
          "label": "Seurat CCA - Canonical correlation analysis",
          "value": "seurat_cca"
        },
        {
          "label": "None - Skip integration",
          "value": "none"
        }
      ]
    },
    {
      "type": "Select",
      "label": "Clustering Algorithm",
      "name": "clustering_algorithm",
      "description": "Community detection algorithm for cell clustering.",
      "defaultValue": "leiden",
      "hidden": false,
      "required": false,
      "disabled": false,
      "options": [
        {
          "label": "Leiden - Higher quality clustering (Recommended)",
          "value": "leiden"
        },
        {
          "label": "Louvain - Classic community detection",
          "value": "louvain"
        }
      ]
    },
    {
      "type": "Input",
      "label": "Clustering Resolution",
      "name": "clustering_resolution",
      "description": "Resolution parameter for clustering (0.1-2.0). Higher values produce more clusters.",
      "defaultValue": "0.8",
      "hidden": false,
      "required": false,
      "disabled": false
    },
    {
      "type": "Select",
      "label": "Dimensionality Reduction",
      "name": "reduction_method",
      "description": "Visualization method for cell populations.",
      "defaultValue": "umap",
      "hidden": false,
      "required": false,
      "disabled": false,
      "options": [
        {
          "label": "UMAP - Fast and preserves global structure (Recommended)",
          "value": "umap"
        },
        {
          "label": "t-SNE - Classic visualization",
          "value": "tsne"
        },
        {
          "label": "Both UMAP and t-SNE",
          "value": "both"
        }
      ]
    },
    {
      "type": "Input",
      "label": "Minimum Cells per Sample",
      "name": "min_cells",
      "description": "Minimum number of cells required per sample for inclusion in analysis.",
      "defaultValue": "100",
      "hidden": false,
      "required": false,
      "disabled": false
    },
    {
      "type": "Input",
      "label": "Minimum Genes per Cell",
      "name": "min_genes",
      "description": "Minimum number of genes detected per cell for quality filtering.",
      "defaultValue": "200",
      "hidden": false,
      "required": false,
      "disabled": false
    },
    {
      "type": "Input",
      "label": "Maximum Mitochondrial %",
      "name": "max_mito_pct",
      "description": "Maximum percentage of mitochondrial gene expression allowed per cell (QC filter).",
      "defaultValue": "20",
      "hidden": false,
      "required": false,
      "disabled": false
    },
    {
      "type": "Checkbox",
      "label": "Remove Doublets",
      "name": "remove_doublets",
      "description": "Automatically detect and remove doublets using DoubletFinder algorithm.",
      "defaultValue": true,
      "hidden": false,
      "required": false,
      "disabled": false
    },
    {
      "type": "Checkbox",
      "label": "Perform Differential Expression",
      "name": "run_de",
      "description": "Run differential gene expression analysis between conditions using MAST.",
      "defaultValue": true,
      "hidden": false,
      "required": false,
      "disabled": false
    },
    {
      "type": "Checkbox",
      "label": "Pathway Enrichment Analysis",
      "name": "run_pathway",
      "description": "Perform pathway enrichment analysis on differentially expressed genes.",
      "defaultValue": true,
      "hidden": false,
      "required": false,
      "disabled": false
    }
  ],
  "tags": [
    {
      "name": "genomics",
      "type": "subfield"
    },
    {
      "name": "single-cell",
      "type": "subfield"
    },
    {
      "name": "cell-type-annotation",
      "type": "task"
    },
    {
      "name": "analysis",
      "type": "task"
    },
    {
      "name": "biology",
      "type": "field"
    },
    {
      "name": "transcriptomics",
      "type": "subfield"
    }
  ]
}