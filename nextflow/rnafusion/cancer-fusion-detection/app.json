{
  "name": "rnafusion-cancer-detection",
  "title": "Gene Fusion Detection for Cancer RNA-seq",
  "description": "Detect oncogenic fusion genes in tumor RNA-seq data using multiple validated algorithms. Identify actionable therapeutic targets like ALK, ROS1, RET, and FGFR fusions for precision cancer medicine.",
  "content": "<h1 class=\"heading-node\">ğŸ§¬ Gene Fusion Detection for Cancer RNA-seq</h1><p class=\"text-node\"><strong>Discover Targetable Fusion Genes Driving Cancer Growth</strong></p><p class=\"text-node\">Gene fusions occur when two previously separate genes become joined together, creating hybrid oncogenes that can drive cancer development. This pipeline uses three complementary fusion detection algorithms (STAR-Fusion, arriba, FusionCatcher) to provide robust, consensus-based identification of fusion genes from tumor RNA sequencing data.</p><img src=\"https://raw.githubusercontent.com/nf-core/rnafusion/master/docs/images/nf-core-rnafusion_logo_light.png\" alt=\"nf-core/rnafusion workflow\" width=\"600\" height=\"300\"><h2 class=\"heading-node\">ğŸ¯ What Are Gene Fusions?</h2><p class=\"text-node\">Gene fusions result from chromosomal rearrangements (translocations, inversions, deletions) that join two genes together. In cancer, these fusions often create:</p><ul class=\"list-node\"><li><p class=\"text-node\"><strong>ğŸ”¥ Constitutively active kinases:</strong> Always \"on\" signaling proteins that drive uncontrolled growth</p></li><li><p class=\"text-node\"><strong>ğŸ§¬ Chimeric transcription factors:</strong> Aberrant gene regulators that reprogram cell identity</p></li><li><p class=\"text-node\"><strong>ğŸ¯ Targetable vulnerabilities:</strong> Dependencies that can be exploited with specific inhibitor drugs</p></li><li><p class=\"text-node\"><strong>ğŸ“Š Diagnostic markers:</strong> Unique signatures that define cancer subtypes</p></li></ul><h2 class=\"heading-node\">ğŸ©º Clinically Actionable Fusions in Cancer</h2><h3 class=\"heading-node\">ğŸ’Š FDA-Approved Targeted Therapies</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>ALK fusions</strong> (lung cancer, ALCL): Crizotinib, alectinib, brigatinib, lorlatinib</p></li><li><p class=\"text-node\"><strong>ROS1 fusions</strong> (lung cancer, glioblastoma): Crizotinib, entrectinib</p></li><li><p class=\"text-node\"><strong>RET fusions</strong> (lung cancer, thyroid): Selpercatinib, pralsetinib</p></li><li><p class=\"text-node\"><strong>NTRK fusions</strong> (pan-cancer): Larotrectinib, entrectinib</p></li><li><p class=\"text-node\"><strong>FGFR fusions</strong> (cholangiocarcinoma, bladder): Pemigatinib, erdafitinib</p></li><li><p class=\"text-node\"><strong>BCR-ABL1</strong> (CML, ALL): Imatinib, dasatinib, nilotinib, ponatinib</p></li></ul><h3 class=\"heading-node\">ğŸ”¬ Common Cancer-Specific Fusions</h3><h4 class=\"heading-node\">ğŸ« Lung Cancer (NSCLC)</h4><ul class=\"list-node\"><li><p class=\"text-node\"><strong>ALK fusions:</strong> 3-5% of NSCLC, younger patients, non-smokers</p></li><li><p class=\"text-node\"><strong>ROS1 fusions:</strong> 1-2% of NSCLC, excellent response to crizotinib</p></li><li><p class=\"text-node\"><strong>RET fusions:</strong> 1-2% of NSCLC, now targetable with selpercatinib</p></li><li><p class=\"text-node\"><strong>NTRK fusions:</strong> Rare but highly responsive to larotrectinib</p></li></ul><h4 class=\"heading-node\">ğŸ—ï¸ Breast Cancer</h4><ul class=\"list-node\"><li><p class=\"text-node\"><strong>FGFR2/3 fusions:</strong> Subset of ER+ breast cancer</p></li><li><p class=\"text-node\"><strong>NTRK fusions:</strong> Rare, secretory breast carcinoma</p></li><li><p class=\"text-node\"><strong>ESR1 fusions:</strong> Treatment resistance mechanism</p></li></ul><h4 class=\"heading-node\">ğŸ©¸ Prostate Cancer</h4><ul class=\"list-node\"><li><p class=\"text-node\"><strong>TMPRSS2-ERG:</strong> Most common, ~50% of prostate cancers</p></li><li><p class=\"text-node\"><strong>TMPRSS2-ETV1/4:</strong> Alternative ETS fusions</p></li><li><p class=\"text-node\"><strong>SLC45A3-ERG:</strong> Subset of ERG-positive cancers</p></li></ul><h4 class=\"heading-node\">ğŸ¦´ Sarcomas</h4><ul class=\"list-node\"><li><p class=\"text-node\"><strong>EWS-FLI1:</strong> Ewing sarcoma (85%), diagnostic fusion</p></li><li><p class=\"text-node\"><strong>SS18-SSX:</strong> Synovial sarcoma (>95%), diagnostic</p></li><li><p class=\"text-node\"><strong>PAX3/7-FOXO1:</strong> Alveolar rhabdomyosarcoma, prognostic</p></li><li><p class=\"text-node\"><strong>COL1A1-PDGFB:</strong> Dermatofibrosarcoma protuberans</p></li></ul><h4 class=\"heading-node\">ğŸ§  Gliomas</h4><ul class=\"list-node\"><li><p class=\"text-node\"><strong>FGFR-TACC:</strong> Pediatric and adult gliomas, potentially targetable</p></li><li><p class=\"text-node\"><strong>BRAF fusions:</strong> Pilocytic astrocytoma, alternative to BRAF V600E</p></li><li><p class=\"text-node\"><strong>NTRK fusions:</strong> Rare but highly responsive</p></li></ul><h4 class=\"heading-node\">ğŸ¦‹ Thyroid Cancer</h4><ul class=\"list-node\"><li><p class=\"text-node\"><strong>RET/PTC fusions:</strong> Papillary thyroid cancer (20-40%)</p></li><li><p class=\"text-node\"><strong>PAX8-PPARG:</strong> Follicular thyroid carcinoma</p></li><li><p class=\"text-node\"><strong>NTRK fusions:</strong> Subset of papillary thyroid cancer</p></li></ul><h2 class=\"heading-node\">ğŸ” Why Use Multiple Fusion Detection Algorithms?</h2><p class=\"text-node\">This pipeline integrates three complementary fusion callers for maximum sensitivity and specificity:</p><ul class=\"list-node\"><li><p class=\"text-node\"><strong>ğŸŒŸ STAR-Fusion:</strong> Fast, splice-aware, excellent for common fusions</p><ul class=\"list-node\"><li><p class=\"text-node\">Leverages STAR aligner's chimeric read detection</p></li><li><p class=\"text-node\">Optimized for speed and accuracy</p></li><li><p class=\"text-node\">Good at filtering false positives</p></li></ul></li><li><p class=\"text-node\"><strong>ğŸ¨ arriba:</strong> High sensitivity, excellent visualization</p><ul class=\"list-node\"><li><p class=\"text-node\">Detects fusions missed by other callers</p></li><li><p class=\"text-node\">Provides fusion gene diagrams and breakpoint plots</p></li><li><p class=\"text-node\">Good for novel/rare fusions</p></li></ul></li><li><p class=\"text-node\"><strong>ğŸ”¬ FusionCatcher:</strong> Comprehensive, well-established</p><ul class=\"list-node\"><li><p class=\"text-node\">Extensive filtering against false positives</p></li><li><p class=\"text-node\">Large database of known fusions</p></li><li><p class=\"text-node\">Good for clinical-grade detection</p></li></ul></li></ul><p class=\"text-node\"><strong>Consensus approach benefits:</strong></p><ul class=\"list-node\"><li><p class=\"text-node\">âœ… Higher confidence: Fusions detected by multiple callers are more reliable</p></li><li><p class=\"text-node\">âœ… Better sensitivity: Different algorithms catch different fusion types</p></li><li><p class=\"text-node\">âœ… Reduced false positives: Consensus filtering removes artifacts</p></li><li><p class=\"text-node\">âœ… Comprehensive coverage: Rare and common fusions both detected</p></li></ul><h2 class=\"heading-node\">ğŸ§ª Experimental Design Requirements</h2><h3 class=\"heading-node\">Sample Types</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>ğŸ§¬ Fresh frozen tumor RNA:</strong> Optimal quality, highest sensitivity</p></li><li><p class=\"text-node\"><strong>ğŸ“¦ FFPE tumor RNA:</strong> Acceptable but may reduce sensitivity</p></li><li><p class=\"text-node\"><strong>ğŸ©¸ Liquid biopsy (ctRNA):</strong> Possible but requires very deep sequencing</p></li><li><p class=\"text-node\"><strong>ğŸ§« Cell line RNA:</strong> Ideal for validation and positive controls</p></li></ul><h3 class=\"heading-node\">Sequencing Specifications</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>ğŸ“Š Read type:</strong> Paired-end (required for optimal fusion detection)</p></li><li><p class=\"text-node\"><strong>ğŸ“ Read length:</strong> 100bp or 150bp (longer is better for spanning breakpoints)</p></li><li><p class=\"text-node\"><strong>ğŸ¯ Depth:</strong> 50-100 million paired reads minimum (100-200M for comprehensive detection)</p></li><li><p class=\"text-node\"><strong>âœ… Quality:</strong> RIN â‰¥ 7 recommended, â‰¥ 5 acceptable for FFPE</p></li><li><p class=\"text-node\"><strong>ğŸ§¬ Library:</strong> Standard mRNA-seq (poly-A selection or rRNA depletion)</p></li></ul><h3 class=\"heading-node\">Controls and Validation</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>âœ… Positive controls:</strong> Cell lines with known fusions (e.g., K562 = BCR-ABL1)</p></li><li><p class=\"text-node\"><strong>âš–ï¸ Negative controls:</strong> Matched normal tissue RNA (optional but useful)</p></li><li><p class=\"text-node\"><strong>ğŸ” Technical replicates:</strong> For validation studies</p></li><li><p class=\"text-node\"><strong>ğŸ“Š Biological replicates:</strong> Multiple tumors for discovery studies</p></li></ul><h2 class=\"heading-node\">ğŸ“‹ Sample Sheet Format</h2><p class=\"text-node\">Your CSV samplesheet defines samples and their properties:</p><pre class=\"block-node\"><code>sample,fastq_1,fastq_2,strandedness\nTumor_Patient1,Patient1_tumor_R1.fastq.gz,Patient1_tumor_R2.fastq.gz,forward\nTumor_Patient2,Patient2_tumor_R1.fastq.gz,Patient2_tumor_R2.fastq.gz,forward\nControl_K562,K562_R1.fastq.gz,K562_R2.fastq.gz,forward</code></pre><p class=\"text-node\"><strong>Column Descriptions:</strong></p><ul class=\"list-node\"><li><p class=\"text-node\"><strong>sample:</strong> Unique sample name (no spaces, letters/numbers/underscores only)</p></li><li><p class=\"text-node\"><strong>fastq_1:</strong> Path to Read 1 FASTQ file (must be .fastq.gz or .fq.gz)</p></li><li><p class=\"text-node\"><strong>fastq_2:</strong> Path to Read 2 FASTQ file (leave empty for single-end, but paired-end recommended)</p></li><li><p class=\"text-node\"><strong>strandedness:</strong> Library strandedness - \"forward\", \"reverse\", or \"unstranded\"</p><ul class=\"list-node\"><li><p class=\"text-node\">\"forward\" = dUTP/NSR/NNSR method (most common)</p></li><li><p class=\"text-node\">\"reverse\" = Ligation method (TruSeq stranded)</p></li><li><p class=\"text-node\">\"unstranded\" = Standard RNA-seq without strand information</p></li><li><p class=\"text-node\">If unsure, use \"unstranded\" (works but slightly less accurate)</p></li></ul></li></ul><h2 class=\"heading-node\">ğŸ§¬ Reference Genome (GRCh38 Only)</h2><p class=\"text-node\"><strong>Important:</strong> nf-core/rnafusion only supports human genome GRCh38/hg38.</p><ul class=\"list-node\"><li><p class=\"text-node\">âœ… <strong>GRCh38/hg38:</strong> Latest human reference, required by this pipeline</p></li><li><p class=\"text-node\">âŒ <strong>GRCh37/hg19:</strong> NOT supported (legacy reference)</p></li><li><p class=\"text-node\">âŒ <strong>Other organisms:</strong> NOT supported (human-specific fusion databases)</p></li></ul><p class=\"text-node\">The pipeline uses pre-built fusion gene references optimized for GRCh38.</p><h2 class=\"heading-node\">ğŸ“Š Comprehensive Output Files</h2><h3 class=\"heading-node\">Fusion Gene Results</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>ğŸ¯ VCF file:</strong> Standardized variant call format with all detected fusions</p></li><li><p class=\"text-node\"><strong>ğŸ“„ TSV reports:</strong> Tab-separated tables with fusion details</p><ul class=\"list-node\"><li><p class=\"text-node\">Fusion gene names (5' and 3' partners)</p></li><li><p class=\"text-node\">Breakpoint coordinates</p></li><li><p class=\"text-node\">Supporting read counts</p></li><li><p class=\"text-node\">In-frame vs out-of-frame prediction</p></li><li><p class=\"text-node\">Known oncogenic fusion annotations</p></li></ul></li><li><p class=\"text-node\"><strong>ğŸ“Š HTML report:</strong> Interactive visualizations and quality metrics</p></li><li><p class=\"text-node\"><strong>ğŸ“ˆ PDF report:</strong> Publication-ready fusion diagrams and breakpoint plots</p></li></ul><h3 class=\"heading-node\">Per-Caller Results</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>STAR-Fusion output:</strong> Fast detection results</p></li><li><p class=\"text-node\"><strong>arriba output:</strong> High-sensitivity results with visualization</p></li><li><p class=\"text-node\"><strong>FusionCatcher output:</strong> Comprehensive filtered results</p></li><li><p class=\"text-node\"><strong>Consensus fusions:</strong> Aggregated results from multiple callers</p></li></ul><h3 class=\"heading-node\">Additional Analysis</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>ğŸ§¬ StringTie transcripts:</strong> Full transcript assembly for expression context</p></li><li><p class=\"text-node\"><strong>âœ‚ï¸ CTAT-Splicing:</strong> Aberrant splicing events near fusion breakpoints</p></li><li><p class=\"text-node\"><strong>ğŸ“Š MultiQC report:</strong> Comprehensive quality control metrics</p><ul class=\"list-node\"><li><p class=\"text-node\">Read quality and alignment statistics</p></li><li><p class=\"text-node\">Detection sensitivity estimates</p></li><li><p class=\"text-node\">Sample-level QC metrics</p></li></ul></li></ul><h3 class=\"heading-node\">Visualization Files</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>ğŸ¨ Fusion gene diagrams:</strong> Visual representation of gene structure and breakpoints</p></li><li><p class=\"text-node\"><strong>ğŸ“ˆ Breakpoint plots:</strong> Read coverage around fusion junctions</p></li><li><p class=\"text-node\"><strong>ğŸ§¬ Transcript illustrations:</strong> Predicted fusion protein domains</p></li></ul><h2 class=\"heading-node\">ğŸ”¬ Interpreting Results</h2><h3 class=\"heading-node\">High Confidence Fusions (Priority for Follow-up)</h3><ul class=\"list-node\"><li><p class=\"text-node\">âœ… Detected by 2+ callers (consensus increases confidence)</p></li><li><p class=\"text-node\">âœ… â‰¥10 supporting reads (well-supported)</p></li><li><p class=\"text-node\">âœ… In-frame fusion (likely produces functional protein)</p></li><li><p class=\"text-node\">âœ… Known oncogenic fusion (in COSMIC/FusionGDB databases)</p></li><li><p class=\"text-node\">âœ… Involves cancer-related genes (kinases, transcription factors)</p></li></ul><h3 class=\"heading-node\">Lower Confidence Fusions (Require Validation)</h3><ul class=\"list-node\"><li><p class=\"text-node\">âš ï¸ Detected by single caller only</p></li><li><p class=\"text-node\">âš ï¸ <5 supporting reads (may be artifact)</p></li><li><p class=\"text-node\">âš ï¸ Out-of-frame (unlikely to be functional)</p></li><li><p class=\"text-node\">âš ï¸ Novel fusion not in databases (could be real or artifact)</p></li><li><p class=\"text-node\">âš ï¸ Involves read-through transcription (adjacent genes, often not pathogenic)</p></li></ul><h3 class=\"heading-node\">Validation Methods</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>ğŸ”¬ RT-PCR:</strong> Confirm fusion transcript by targeted amplification</p></li><li><p class=\"text-node\"><strong>ğŸ§¬ Sanger sequencing:</strong> Validate exact breakpoint sequence</p></li><li><p class=\"text-node\"><strong>ğŸ¯ FISH:</strong> Confirm chromosomal rearrangement at DNA level</p></li><li><p class=\"text-node\"><strong>ğŸ§« Functional assays:</strong> Test if fusion has oncogenic properties</p></li></ul><h2 class=\"heading-node\">ğŸ©º Clinical Applications</h2><ul class=\"list-node\"><li><p class=\"text-node\"><strong>ğŸ’Š Precision therapy selection:</strong> Match patients to targeted therapies (ALK/ROS1/RET inhibitors)</p></li><li><p class=\"text-node\"><strong>ğŸ§¬ Molecular diagnosis:</strong> Confirm cancer subtype by diagnostic fusion (e.g., EWS-FLI1 in Ewing sarcoma)</p></li><li><p class=\"text-node\"><strong>ğŸ“Š Prognostic stratification:</strong> Identify high-risk vs favorable fusions</p></li><li><p class=\"text-node\"><strong>ğŸ”¬ Clinical trial enrollment:</strong> Identify patients eligible for fusion-targeted trials</p></li><li><p class=\"text-node\"><strong>ğŸ©¸ Minimal residual disease:</strong> Monitor fusion-positive cells during treatment</p></li><li><p class=\"text-node\"><strong>ğŸ”„ Resistance mechanisms:</strong> Detect resistance fusions after targeted therapy</p></li></ul><h2 class=\"heading-node\">âš™ï¸ Pipeline Technical Details</h2><ul class=\"list-node\"><li><p class=\"text-node\"><strong>ğŸ”§ Alignment:</strong> STAR 2-pass mode for optimal fusion detection</p></li><li><p class=\"text-node\"><strong>ğŸ¯ Fusion callers:</strong> STAR-Fusion, arriba, FusionCatcher (all three enabled)</p></li><li><p class=\"text-node\"><strong>ğŸ“Š Quality control:</strong> FastQC, MultiQC with fusion-specific metrics</p></li><li><p class=\"text-node\"><strong>âœ… Filtering:</strong> Stringent default filters to minimize false positives</p></li><li><p class=\"text-node\"><strong>ğŸ§¬ Annotation:</strong> Known fusion databases (COSMIC, FusionGDB, ChimerDB)</p></li><li><p class=\"text-node\"><strong>ğŸ“ˆ Visualization:</strong> Automated PDF and HTML reports</p></li><li><p class=\"text-node\"><strong>ğŸ”¬ Additional analysis:</strong> StringTie transcript assembly, CTAT-Splicing</p></li></ul><h2 class=\"heading-node\">ğŸ¯ Expected Runtime and Resources</h2><ul class=\"list-node\"><li><p class=\"text-node\"><strong>â±ï¸ Runtime:</strong> 4-8 hours for typical samples (50-100M reads)</p></li><li><p class=\"text-node\"><strong>ğŸ’¾ Storage:</strong> ~20-50 GB per sample for intermediate and final files</p></li><li><p class=\"text-node\"><strong>ğŸ–¥ï¸ Resources:</strong> Automatically managed, scales with data size</p></li><li><p class=\"text-node\"><strong>âœ… Node size:</strong> XSMALL for test data, MEDIUM for typical samples, LARGE for deep sequencing</p></li></ul><p class=\"text-node\"><strong>Perfect for Research in:</strong> Cancer genomics â€¢ Precision oncology â€¢ Translational research â€¢ Clinical diagnostics â€¢ Drug target discovery â€¢ Biomarker identification â€¢ Sarcoma research â€¢ Leukemia profiling</p><p class=\"text-node\">Built with <a class=\"link\" href=\"https://www.nextflow.io/\" target=\"_blank\">Nextflow</a> â€¢ Powered by <a class=\"link\" href=\"https://nf-co.re/rnafusion\" target=\"_blank\">nf-core/rnafusion v4.0.0</a> â€¢ Containerized execution â€¢ Clinically validated algorithms</p>",
  "imageUrl": "https://raw.githubusercontent.com/nf-core/rnafusion/master/docs/images/nf-core-rnafusion_logo_light.png",
  "command": "nextflow run nf-core/rnafusion --input ${input} --outdir ${outdir} --genomes_base s3://ngi-igenomes/igenomes/Homo_sapiens/NCBI/GRCh38/ --starfusion --arriba --fusioncatcher -r 4.0.0 -profile singularity",
  "engineType": "NEXTFLOW",
  "jobConfig": [
    {
      "type": "Select",
      "label": "System Size",
      "name": "system_size",
      "hidden": true,
      "description": "Select compute resources. Start with XSMALL for testing, scale up for production data.",
      "options": [
        {
          "label": "XSMALL (4 CPUs, 15GB RAM) - Testing/nf-core test data",
          "value": "xsmall",
          "mapValue": {
            "nodeSize": "XSMALL",
            "numNodes": 1,
            "withGpu": false
          }
        },
        {
          "label": "SMALL (8 CPUs, 30GB RAM) - Small datasets (1-2 samples)",
          "value": "small",
          "mapValue": {
            "nodeSize": "SMALL",
            "numNodes": 1,
            "withGpu": false
          }
        },
        {
          "label": "MEDIUM (32 CPUs, 120GB RAM) - Standard datasets (3-10 samples)",
          "value": "medium",
          "mapValue": {
            "nodeSize": "MEDIUM",
            "numNodes": 1,
            "withGpu": false
          }
        },
        {
          "label": "LARGE (64 CPUs, 360GB RAM) - Large datasets (10-50 samples)",
          "value": "large",
          "mapValue": {
            "nodeSize": "LARGE",
            "numNodes": 1,
            "withGpu": false
          }
        }
      ],
      "defaultValue": "xsmall"
    }
  ],
  "spec": [
    {
      "type": "Stash File",
      "label": "Sample Sheet",
      "name": "input",
      "description": "CSV file with columns: sample, fastq_1, fastq_2, strandedness. Each row represents a tumor RNA-seq sample for fusion detection. Strandedness values: 'forward', 'reverse', or 'unstranded'.",
      "required": true,
      "restrictions": {
        "allow_files": true,
        "allow_folders": false,
        "allowed_file_types": [".csv"]
      }
    },
    {
      "type": "Stash File",
      "label": "Output Directory",
      "name": "outdir",
      "description": "Directory where fusion detection results, reports, and visualizations will be saved",
      "defaultValue": "./rnafusion-results",
      "required": true,
      "restrictions": {
        "allow_files": false,
        "allow_folders": true,
        "allowed_file_types": []
      }
    }
  ],
  "tags": [
    {"name": "genomics", "type": "subfield"},
    {"name": "cancer", "type": "subfield"},
    {"name": "fusion-detection", "type": "task"},
    {"name": "rna-seq", "type": "task"},
    {"name": "biology", "type": "field"}
  ]
}