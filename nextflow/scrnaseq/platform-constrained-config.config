// PLATFORM-CONSTRAINED CONFIGURATION
// Works within actual Camber platform limits: 2 CPUs, ~4GB memory

process {
    // Set ALL processes to use only available resources
    cpus = 1  // Use 1 CPU for most processes
    memory = '2.GB'  // Conservative memory allocation
    time = '4.h'
    
    // Override ALL specific processes to fit constraints
    withName:FASTQC {
        cpus = 1  // Down from 4 to 1
        memory = '2.GB'
        time = '2.h'
    }
    
    withName:MULTIQC {
        cpus = 1
        memory = '1.GB'
        time = '1.h'
    }
    
    withName:'.*:TRIMGALORE.*' {
        cpus = 1
        memory = '2.GB'
        time = '4.h'
    }
    
    // Alignment processes - most resource intensive
    withName:'.*:STARSOLO:.*' {
        cpus = 2  // Use maximum available CPUs
        memory = '3.GB'  // Use most available memory
        time = '8.h'
    }
    
    withName:'.*:ALEVIN:.*' {
        cpus = 2
        memory = '3.GB'
        time = '6.h'
    }
    
    // Methylseq processes
    withName:'.*:BISMARK_ALIGN.*' {
        cpus = 2
        memory = '3.GB'
        time = '8.h'
    }
    
    withName:'.*:BISMARK_GENOMEPREPARATION.*' {
        cpus = 2
        memory = '3.GB'
        time = '6.h'
    }
    
    withName:'.*:BISMARK_METHYLATIONEXTRACTOR.*' {
        cpus = 1
        memory = '2.GB'
        time = '6.h'
    }
    
    // Apply global limits to all process labels
    withLabel:process_single { cpus = 1; memory = '1.GB' }
    withLabel:process_low { cpus = 1; memory = '2.GB' }
    withLabel:process_medium { cpus = 1; memory = '2.GB' }
    withLabel:process_high { cpus = 2; memory = '3.GB' }
    withLabel:process_long { cpus = 1; memory = '2.GB' }
    withLabel:process_high_memory { cpus = 1; memory = '3.GB' }
    
    // Error handling
    errorStrategy = 'retry'
    maxRetries = 2
}

// NO max_cpus, max_memory, max_time parameters - platform doesn't support them
// NO container overrides - let platform handle
// NO executor overrides - let platform handle