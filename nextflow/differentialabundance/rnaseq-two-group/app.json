{
  "name": "differentialabundance-rnaseq-twogroup",
  "title": "RNA-seq: Two-Group Differential Expression Analysis",
  "description": "Statistical comparison of gene expression between two experimental conditions using DESeq2. Identify which genes are up- or down-regulated in treatment vs control, disease vs healthy, or any two-group comparison.",
  "content": "<h1 class=\"heading-node\">📊 RNA-seq: Two-Group Differential Expression Analysis</h1><p class=\"text-node\"><strong>Discover Which Genes Change Between Conditions</strong></p><p class=\"text-node\">This pipeline performs rigorous statistical analysis to identify differentially expressed genes between two experimental groups. Using the gold-standard DESeq2 method, it provides comprehensive results including significance testing, fold change calculations, and rich visualizations.</p><img src=\"https://raw.githubusercontent.com/nf-core/differentialabundance/master/docs/images/nf-core-differentialabundance_logo_light.png\" alt=\"nf-core/differentialabundance\" width=\"600\" height=\"300\"><h2 class=\"heading-node\">🎯 What This Analysis Does</h2><p class=\"text-node\">Starting with gene count data from RNA-seq experiments, this pipeline:</p><ul class=\"list-node\"><li><p class=\"text-node\"><strong>📈 Statistical Testing</strong>: Uses DESeq2's rigorous Wald test for two-group comparisons</p></li><li><p class=\"text-node\"><strong>🎨 Rich Visualizations</strong>: Creates volcano plots, MA plots, heatmaps, and PCA plots</p></li><li><p class=\"text-node\"><strong>🔍 Quality Control</strong>: Validates data quality and identifies potential batch effects</p></li><li><p class=\"text-node\"><strong>📋 Annotated Results</strong>: Links genes to biological functions and pathways</p></li><li><p class=\"text-node\"><strong>🌐 Interactive Reports</strong>: Generates browsable HTML reports with all results</p></li></ul><h2 class=\"heading-node\">🧬 Perfect For These Research Questions</h2><h3 class=\"heading-node\">Cancer Biology</h3><p class=\"text-node\">Compare tumor vs normal tissue to discover oncogenes and tumor suppressors driving cancer progression.</p><h3 class=\"heading-node\">Drug Discovery</h3><p class=\"text-node\">Identify genes affected by drug treatment vs vehicle control to understand mechanism of action and potential side effects.</p><h3 class=\"heading-node\">Genetics & Model Organisms</h3><p class=\"text-node\">Characterize knockout vs wild-type phenotypes to reveal gene function and downstream regulatory networks.</p><h3 class=\"heading-node\">Immunology</h3><p class=\"text-node\">Compare activated vs resting immune cells to map immune response pathways and identify therapeutic targets.</p><h3 class=\"heading-node\">Developmental Biology</h3><p class=\"text-node\">Contrast different developmental stages or cell states to understand differentiation programs.</p><h2 class=\"heading-node\">📋 Input Requirements</h2><h3 class=\"heading-node\">1. Gene Count Matrix (required)</h3><p class=\"text-node\">A TSV file with genes as rows and samples as columns, containing raw or normalized counts from your RNA-seq experiment.</p><pre class=\"block-node\"><code># Example matrix format (tab-separated):\ngene_id       sample1  sample2  sample3  sample4\nENSG00000000003  100     95      450     425\nENSG00000000005  5       3       2       4\nENSG00000000419  2500    2300    2600    2450</code></pre><p class=\"text-node\"><strong>Source</strong>: Output from nf-core/rnaseq pipeline (gene_counts.tsv) or similar RNA-seq quantification tool.</p><h3 class=\"heading-node\">2. Sample Information Sheet (required)</h3><p class=\"text-node\">A CSV file describing your samples and experimental design:</p><pre class=\"block-node\"><code>sample,condition,replicate,batch\nsample1,control,rep1,batch1\nsample2,control,rep2,batch1\nsample3,control,rep3,batch2\nsample4,treated,rep1,batch1\nsample5,treated,rep2,batch1\nsample6,treated,rep3,batch2</code></pre><p class=\"text-node\"><strong>Required columns</strong>:</p><ul class=\"list-node\"><li><p class=\"text-node\"><code class=\"inline\" spellcheck=\"false\">sample</code>: Must exactly match column names in count matrix</p></li><li><p class=\"text-node\"><code class=\"inline\" spellcheck=\"false\">condition</code>: Your two experimental groups (e.g., \"control\" and \"treated\")</p></li></ul><p class=\"text-node\"><strong>Optional columns</strong>:</p><ul class=\"list-node\"><li><p class=\"text-node\"><code class=\"inline\" spellcheck=\"false\">replicate</code>: Biological replicate number</p></li><li><p class=\"text-node\"><code class=\"inline\" spellcheck=\"false\">batch</code>: Batch information for correction of technical variation</p></li></ul><h3 class=\"heading-node\">3. Contrasts File (required)</h3><p class=\"text-node\">A CSV file defining which groups to compare:</p><pre class=\"block-node\"><code>id,variable,reference,target,blocking\ntreated_vs_control,condition,control,treated,</code></pre><p class=\"text-node\"><strong>Columns explained</strong>:</p><ul class=\"list-node\"><li><p class=\"text-node\"><code class=\"inline\" spellcheck=\"false\">id</code>: Name for this comparison (used in output files)</p></li><li><p class=\"text-node\"><code class=\"inline\" spellcheck=\"false\">variable</code>: Column name from samplesheet (usually \"condition\")</p></li><li><p class=\"text-node\"><code class=\"inline\" spellcheck=\"false\">reference</code>: Control/baseline group</p></li><li><p class=\"text-node\"><code class=\"inline\" spellcheck=\"false\">target</code>: Treatment/experimental group</p></li><li><p class=\"text-node\"><code class=\"inline\" spellcheck=\"false\">blocking</code>: Optional blocking variable (e.g., \"batch\")</p></li></ul><p class=\"text-node\"><strong>Result interpretation</strong>: Positive fold changes indicate genes higher in target (treated) vs reference (control).</p><h3 class=\"heading-node\">4. GTF Gene Annotations (optional but recommended)</h3><p class=\"text-node\">Gene annotation file matching your reference genome. If provided, results will include gene symbols, biotypes, and genomic locations. The pipeline can download standard annotations automatically if you specify the genome parameter.</p><h2 class=\"heading-node\">📊 Comprehensive Results</h2><h3 class=\"heading-node\">Differential Expression Tables</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>📉 Log2 Fold Changes</strong>: How much each gene changes (e.g., log2FC=2 means 4-fold increase)</p></li><li><p class=\"text-node\"><strong>📊 P-values & FDR</strong>: Statistical significance with multiple testing correction</p></li><li><p class=\"text-node\"><strong>🏷️ Gene Annotations</strong>: Gene symbols, descriptions, and biotypes</p></li><li><p class=\"text-node\"><strong>📈 Base Mean Expression</strong>: Average expression level across samples</p></li></ul><h3 class=\"heading-node\">Visualization Suite</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>🌋 Volcano Plot</strong>: Shows fold change vs significance - quickly identify top genes</p></li><li><p class=\"text-node\"><strong>📈 MA Plot</strong>: Expression level vs fold change - assess analysis quality</p></li><li><p class=\"text-node\"><strong>🔥 Heatmap</strong>: Hierarchical clustering of top differentially expressed genes</p></li><li><p class=\"text-node\"><strong>🎯 PCA Plot</strong>: Sample relationships and batch effects visualization</p></li><li><p class=\"text-node\"><strong>📊 Sample Correlation Matrix</strong>: Quality check for replicate similarity</p></li></ul><h3 class=\"heading-node\">Quality Control Reports</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>📋 MultiQC Report</strong>: Comprehensive quality metrics</p></li><li><p class=\"text-node\"><strong>🔍 Dispersion Plots</strong>: DESeq2 model fit quality</p></li><li><p class=\"text-node\"><strong>📊 Count Distributions</strong>: Library size normalization check</p></li></ul><h3 class=\"heading-node\">Interactive Exploration</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>🌐 HTML Report</strong>: All results in browsable format</p></li><li><p class=\"text-node\"><strong>✨ Interactive Tables</strong>: Sortable, filterable gene lists</p></li><li><p class=\"text-node\"><strong>🔬 R Markdown Template</strong>: Reproducible analysis document</p></li></ul><h2 class=\"heading-node\">🔬 Statistical Methods</h2><h3 class=\"heading-node\">DESeq2 (Default)</h3><p class=\"text-node\">The gold-standard method for RNA-seq differential expression:</p><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Negative binomial model</strong>: Properly handles RNA-seq count data</p></li><li><p class=\"text-node\"><strong>Size factor normalization</strong>: Accounts for library size differences</p></li><li><p class=\"text-node\"><strong>Empirical Bayes shrinkage</strong>: Improves fold change estimates</p></li><li><p class=\"text-node\"><strong>Wald test</strong>: Optimal for two-group comparisons</p></li><li><p class=\"text-node\"><strong>Benjamini-Hochberg FDR</strong>: Controls false discovery rate</p></li></ul><h2 class=\"heading-node\">⚙️ Analysis Configuration</h2><p class=\"text-node\">This app is pre-configured for standard two-group RNA-seq comparisons:</p><ul class=\"list-node\"><li><p class=\"text-node\"><strong>Features analyzed</strong>: Genes (not transcripts)</p></li><li><p class=\"text-node\"><strong>Statistical test</strong>: DESeq2 Wald test</p></li><li><p class=\"text-node\"><strong>Significance threshold</strong>: FDR &lt; 0.05</p></li><li><p class=\"text-node\"><strong>Fold change display</strong>: Log2 scale</p></li><li><p class=\"text-node\"><strong>Clustering method</strong>: Ward's hierarchical clustering</p></li><li><p class=\"text-node\"><strong>Correlation method</strong>: Spearman rank correlation</p></li></ul><h2 class=\"heading-node\">📈 Expected Runtime & Resources</h2><ul class=\"list-node\"><li><p class=\"text-node\"><strong>⏱️ Test Data</strong>: 10-15 minutes (1000 genes, 6 samples)</p></li><li><p class=\"text-node\"><strong>⏱️ Typical Dataset</strong>: 20-45 minutes (20,000 genes, 6-20 samples)</p></li><li><p class=\"text-node\"><strong>💾 Memory</strong>: 8-15GB sufficient for most experiments</p></li><li><p class=\"text-node\"><strong>💻 Node Size</strong>: XSMALL for testing, SMALL for production</p></li></ul><h2 class=\"heading-node\">🎓 Interpretation Guide</h2><h3 class=\"heading-node\">Understanding Your Results</h3><ul class=\"list-node\"><li><p class=\"text-node\"><strong>log2FoldChange &gt; 1</strong>: Gene is at least 2-fold higher in treatment</p></li><li><p class=\"text-node\"><strong>log2FoldChange &lt; -1</strong>: Gene is at least 2-fold lower in treatment</p></li><li><p class=\"text-node\"><strong>padj &lt; 0.05</strong>: Statistically significant after multiple testing correction</p></li><li><p class=\"text-node\"><strong>baseMean &gt; 10</strong>: Gene is reasonably well-expressed (not low-count)</p></li></ul><h3 class=\"heading-node\">What to Look For</h3><ol class=\"list-node\"><li><p class=\"text-node\"><strong>Known markers</strong>: Do expected genes show up as significant?</p></li><li><p class=\"text-node\"><strong>Biological coherence</strong>: Do top genes relate to your experimental system?</p></li><li><p class=\"text-node\"><strong>Sample clustering</strong>: Do replicates cluster together in PCA?</p></li><li><p class=\"text-node\"><strong>Effect sizes</strong>: Are fold changes biologically meaningful (&gt;1.5-2 fold)?</p></li></ol><h2 class=\"heading-node\">📚 Next Steps After Analysis</h2><ol class=\"list-node\"><li><p class=\"text-node\"><strong>Pathway Enrichment</strong>: Submit gene lists to DAVID, Enrichr, or g:Profiler</p></li><li><p class=\"text-node\"><strong>Gene Ontology</strong>: Understand biological processes affected</p></li><li><p class=\"text-node\"><strong>Literature Review</strong>: Research top candidates in PubMed</p></li><li><p class=\"text-node\"><strong>Validation</strong>: Plan qPCR or Western blots for key findings</p></li><li><p class=\"text-node\"><strong>Integration</strong>: Combine with proteomics, ChIP-seq, or ATAC-seq data</p></li></ol><p class=\"text-node\"><strong>Ideal for</strong>: Molecular biology • Cancer research • Drug discovery • Immunology • Genetics • Developmental biology • Systems biology • Translational research</p><p class=\"text-node\">Built with <a class=\"link\" href=\"https://www.nextflow.io/\" target=\"_blank\">Nextflow</a> • Powered by <a class=\"link\" href=\"https://nf-co.re/differentialabundance/1.5.0/\" target=\"_blank\">nf-core/differentialabundance v1.5.0</a> • Statistical analysis by <a class=\"link\" href=\"https://bioconductor.org/packages/DESeq2/\" target=\"_blank\">DESeq2</a></p>",
  "imageUrl": "https://raw.githubusercontent.com/nf-core/differentialabundance/master/docs/images/nf-core-differentialabundance_logo_light.png",
  "command": "nextflow run nf-core/differentialabundance -r 1.5.0 --input ${input} --contrasts ${contrasts} --matrix ${matrix} --outdir ${outdir} --features_id_col gene_id --features_name_col gene_name --features_type gene --deseq2_test Wald --exploratory_clustering_method ward.D2 --exploratory_cor_method spearman -c /etc/mpi/nextflow.camber.config",
  "engineType": "NEXTFLOW",
  "jobConfig": [
    {
      "type": "Select",
      "label": "System Size",
      "name": "system_size",
      "hidden": true,
      "description": "Select compute resources. Start with XSMALL for testing with nf-core test data, scale up for production datasets.",
      "options": [
        {
          "label": "XSMALL (4 CPUs, 15GB RAM) - Testing/nf-core test data",
          "value": "xsmall",
          "mapValue": {"nodeSize": "XSMALL", "numNodes": 1, "withGpu": false}
        },
        {
          "label": "SMALL (8 CPUs, 30GB RAM) - Small datasets (5-10 samples)",
          "value": "small",
          "mapValue": {"nodeSize": "SMALL", "numNodes": 1, "withGpu": false}
        },
        {
          "label": "MEDIUM (32 CPUs, 120GB RAM) - Standard datasets (10-30 samples)",
          "value": "medium",
          "mapValue": {"nodeSize": "MEDIUM", "numNodes": 1, "withGpu": false}
        }
      ],
      "defaultValue": "xsmall"
    }
  ],
  "spec": [
    {
      "type": "Stash File",
      "label": "Sample Information Sheet",
      "name": "input",
      "description": "CSV file with columns: sample (matching matrix columns), condition (your two groups), and optional replicate/batch information. Example: sample,condition,replicate\\nsample1,control,1\\nsample2,treated,1",
      "defaultValue": "https://raw.githubusercontent.com/nf-core/test-datasets/modules/data/genomics/mus_musculus/rnaseq_expression/SRP254919.samplesheet.csv",
      "required": true
    },
    {
      "type": "Stash File",
      "label": "Contrasts Definition",
      "name": "contrasts",
      "description": "CSV file defining comparison(s). Columns: id, variable, reference, target, blocking. Example: treated_vs_control,condition,control,treated,",
      "defaultValue": "https://raw.githubusercontent.com/nf-core/test-datasets/modules/data/genomics/mus_musculus/rnaseq_expression/SRP254919.contrasts.csv",
      "required": true
    },
    {
      "type": "Stash File",
      "label": "Gene Count Matrix",
      "name": "matrix",
      "description": "TSV file with genes as rows (gene_id in first column) and samples as columns. Use output from nf-core/rnaseq or similar RNA-seq quantification pipeline.",
      "defaultValue": "https://raw.githubusercontent.com/nf-core/test-datasets/modules/data/genomics/mus_musculus/rnaseq_expression/SRP254919.salmon.merged.gene_counts.top1000cov.tsv",
      "required": true
    },
    {
      "type": "Stash File",
      "label": "Output Directory",
      "name": "outdir",
      "description": "Where to save differential expression results, visualizations, and reports.",
      "defaultValue": "./differentialabundance-results",
      "required": true
    }
  ],
  "tags": [
    {"name": "genomics", "type": "subfield"},
    {"name": "differential-expression", "type": "task"},
    {"name": "biology", "type": "field"}
  ]
}