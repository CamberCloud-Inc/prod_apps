{
  "name": "biomni-generate-gene-embeddings",
  "title": "Biomni: Generate Gene Embeddings",
  "description": "Generate protein embeddings for Ensembl gene IDs using ESM language models",
  "content": "<h3>Overview</h3><p>Generates protein embeddings for Ensembl gene IDs using ESM (Evolutionary Scale Modeling) protein language models. This tool creates dense vector representations that capture protein structure and function learned from millions of protein sequences, enabling downstream machine learning tasks like function prediction, variant effect analysis, and protein classification.</p><h3>Input Parameters</h3><ul><li><strong>gene_ids_file</strong> (string): Path to JSON file containing array of ENSEMBL gene IDs from stash</li><li><strong>model_name</strong> (string, optional): ESM model variant - esm2_t6_8M_UR50D, esm2_t12_35M_UR50D, esm2_t30_150M_UR50D, etc. (default: esm2_t6_8M_UR50D)</li><li><strong>layer</strong> (integer, optional): Transformer layer to extract embeddings from (default: 6)</li><li><strong>batch_size</strong> (integer, optional): Number of sequences to process simultaneously (default: 1)</li><li><strong>max_length</strong> (integer, optional): Maximum protein sequence length in amino acids (default: 1024)</li><li><strong>output</strong> (string): Output directory path</li></ul><h3>Input Format</h3><p>Provide a JSON file with the following structure:</p><pre>{\n  \"gene_ids_file\": \"/path/to/gene_ids.json\",\n  \"model_name\": \"esm2_t12_35M_UR50D\",\n  \"layer\": 12,\n  \"batch_size\": 4,\n  \"max_length\": 2048,\n  \"output\": \"/output/directory\"\n}</pre><p>Where gene_ids.json contains:</p><pre>[\"ENSG00000141510\", \"ENSG00000157764\", \"ENSG00000139618\"]</pre><h3>Biological Use Case</h3><p>Enables machine learning on protein sequences for functional genomics. Used to predict protein function, assess variant pathogenicity, cluster proteins by structural similarity, build protein-protein interaction predictors, and create features for downstream genomic ML models.</p><h3>Output</h3><p>Generates embeddings_log.txt with processing details and gene_embeddings.pt (PyTorch tensor file) containing high-dimensional embeddings for each protein.</p><h3>Category</h3><p>genomics</p>",
  "command": "rm -rf prod_apps 2>/dev/null || true && git clone --depth 1 https://github.com/CamberCloud-Inc/prod_apps.git prod_apps && python3 prod_apps/biomni/genomics/generate_gene_embeddings.py \"${inputFile}\" -o \"${outputDir}\"",
  "engineType": "MPI",
  "jobConfig": [
    {
      "type": "Select",
      "label": "System Size",
      "name": "system_size",
      "hidden": true,
      "description": "Select the configuration for the job",
      "options": [
        {
          "label": "Extra Extra Small CPU",
          "value": "xxsmall_cpu",
          "mapValue": {
            "nodeSize": "XXSMALL",
            "numNodes": 1,
            "withGpu": false
          }
        }
      ],
      "defaultValue": "xxsmall_cpu"
    }
  ],
  "spec": [
    {
      "type": "Stash File",
      "name": "inputFile",
      "label": "Input File",
      "description": "Input file from stash (JSON format)",
      "defaultValue": ""
    },
    {
      "type": "Stash File",
      "name": "outputDir",
      "label": "Output Directory",
      "description": "Output directory in stash",
      "defaultValue": "./"
    }
  ]
}