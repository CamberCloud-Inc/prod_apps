{
  "name": "biomni-analyze-atac-seq-differential-accessibility",
  "title": "Biomni: Analyze Atac Seq Differential Accessibility",
  "description": "Perform ATAC-seq peak calling and differential accessibility analysis using MACS2",
  "content": "<h3>Overview</h3><p>Perform comprehensive ATAC-seq (Assay for Transposase-Accessible Chromatin using sequencing) peak calling and differential accessibility analysis using MACS2. This tool identifies open chromatin regions and compares chromatin accessibility between treatment and control conditions, revealing transcriptional regulatory changes in immune cells.</p><h3>Input Parameters</h3><ul><li><strong>treatment_bam</strong> (string, required): Path to the BAM file containing aligned ATAC-seq reads from the treatment condition</li><li><strong>control_bam</strong> (string, required): Path to the BAM file containing aligned ATAC-seq reads from the control condition</li><li><strong>genome_size</strong> (string, optional): Effective genome size for peak calling. Options include 'hs' (human), 'mm' (mouse), 'ce' (C. elegans), 'dm' (Drosophila). Default: 'hs'</li><li><strong>q_value</strong> (float, optional): Q-value (minimum FDR) cutoff for peak detection. Default: 0.05</li><li><strong>name_prefix</strong> (string, optional): Prefix for output file names. Default: 'atac'</li></ul><h3>Biological Use Case</h3><p>Essential for studying epigenetic regulation in immune cell activation, differentiation, and disease states. Applications include: (1) Identifying regulatory elements activated during T cell stimulation, (2) Mapping chromatin remodeling in inflammatory macrophages vs. homeostatic macrophages, (3) Discovering accessible enhancers in autoimmune disease models, (4) Characterizing transcription factor binding sites in activated B cells, and (5) Investigating chromatin changes during immune cell development in the thymus or bone marrow.</p><h3>Output</h3><p>Generates peak calling results including: narrowPeak files with genomic coordinates of accessible chromatin regions, differential accessibility scores comparing treatment vs. control, statistical significance values (p-values and q-values), summit positions for each peak, and fold enrichment calculations. Results are saved to 'atac_results.txt' in the specified output directory.</p><h3>Category</h3><p>immunology</p>",
  "command": "rm -rf prod_apps 2>/dev/null || true && git clone --depth 1 https://github.com/CamberCloud-Inc/prod_apps.git prod_apps && python3 prod_apps/biomni/immunology/analyze_atac_seq_differential_accessibility.py --treatment_bam \"${treatment_bam}\" --control_bam \"${control_bam}\" --genome_size \"${genome_size}\" --q_value \"${q_value}\" --name_prefix \"${name_prefix}\" -o \"${outputDir}\"",
  "engineType": "MPI",
  "jobConfig": [
    {
      "type": "Select",
      "label": "System Size",
      "name": "system_size",
      "hidden": true,
      "description": "Select the configuration for the job",
      "options": [
        {
          "label": "Extra Extra Small CPU",
          "value": "xxsmall_cpu",
          "mapValue": {
            "nodeSize": "XXSMALL",
            "numNodes": 1,
            "withGpu": false
          }
        }
      ],
      "defaultValue": "xxsmall_cpu"
    }
  ],
  "spec": [
    {
      "type": "Stash File",
      "name": "treatment_bam",
      "label": "Treatment BAM",
      "description": "Path to treatment BAM file with aligned ATAC-seq reads",
      "defaultValue": ""
    },
    {
      "type": "Stash File",
      "name": "control_bam",
      "label": "Control BAM",
      "description": "Path to control BAM file with aligned ATAC-seq reads",
      "defaultValue": ""
    },
    {
      "type": "Input",
      "name": "genome_size",
      "label": "Genome Size",
      "description": "Effective genome size: hs (human), mm (mouse), ce, dm (default: hs)",
      "defaultValue": "hs"
    },
    {
      "type": "Input",
      "name": "q_value",
      "label": "Q-value",
      "description": "Q-value cutoff for peak detection (default: 0.05)",
      "defaultValue": "0.05"
    },
    {
      "type": "Input",
      "name": "name_prefix",
      "label": "Name Prefix",
      "description": "Prefix for output file names (default: atac)",
      "defaultValue": "atac"
    },
    {
      "type": "Stash File",
      "name": "outputDir",
      "label": "Output Directory",
      "description": "Output directory in stash",
      "defaultValue": "./"
    }
  ]
}